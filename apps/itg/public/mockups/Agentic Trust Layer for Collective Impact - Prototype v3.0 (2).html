<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agentic Trust Layer | ETHDenver 2026</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2B5797;
            --secondary: #0D7377;
            --accent: #7B1FA2;
            --success: #28A745;
            --warning: #F57C00;
            --danger: #DC3545;
            --bg: #f5f5f5;
            --card: #ffffff;
            --text: #333333;
            --muted: #666666;
            --border: #e0e0e0;
            --sidebar: #1A3A5C;
            --observer: #9E9E9E;
            --advisor: #F57C00;
            --coordinator-tier: #2B5797;
            --steward: #7B1FA2;
            --transition: 0.25s ease;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.5;
            overflow: hidden;
        }

        /* Layout */
        .layout {
            display: grid;
            grid-template-columns: 260px 1fr;
            grid-template-rows: 64px 1fr;
            height: 100vh;
            width: 100vw;
        }

        .sidebar {
            grid-column: 1;
            grid-row: 1 / -1;
            background-color: var(--sidebar);
            color: white;
            padding: 20px 0;
            overflow-y: auto;
            border-right: 1px solid rgba(255,255,255,0.1);
        }

        .header {
            grid-column: 2;
            grid-row: 1;
            background-color: var(--card);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 32px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .main-content {
            grid-column: 2;
            grid-row: 2;
            overflow-y: auto;
            padding: 32px;
            background-color: var(--bg);
        }

        /* Sidebar Navigation */
        .sidebar-logo {
            padding: 0 20px 24px;
            border-bottom: 1px solid rgba(255,255,255,0.15);
            margin-bottom: 24px;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .sidebar-section {
            margin-bottom: 28px;
        }

        .sidebar-section-title {
            padding: 0 20px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            color: rgba(255,255,255,0.5);
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        .sidebar-item {
            padding: 10px 20px;
            margin: 0 8px;
            cursor: pointer;
            border-radius: 6px;
            font-size: 14px;
            transition: var(--transition);
            color: rgba(255,255,255,0.7);
            border-left: 3px solid transparent;
        }

        .sidebar-item:hover {
            background-color: rgba(255,255,255,0.1);
            color: white;
        }

        .sidebar-item.active {
            background-color: rgba(255,255,255,0.15);
            color: white;
            border-left-color: white;
        }

        /* Header */
        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .breadcrumb {
            font-size: 14px;
            color: var(--muted);
        }

        .breadcrumb strong {
            color: var(--text);
            font-weight: 600;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .web3-badge {
            font-size: 12px;
            padding: 6px 12px;
            background-color: #f0f0f0;
            border-radius: 20px;
            color: var(--secondary);
            font-weight: 500;
        }

        .role-switcher {
            position: relative;
        }

        .role-button {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 14px;
            background-color: var(--bg);
            border: 1px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: var(--transition);
        }

        .role-button:hover {
            background-color: white;
            border-color: var(--primary);
        }

        .role-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }

        .role-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-top: 8px;
            min-width: 240px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: none;
            z-index: 1000;
        }

        .role-dropdown.open {
            display: block;
        }

        .role-option {
            padding: 12px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 13px;
            transition: var(--transition);
            border-bottom: 1px solid var(--border);
        }

        .role-option:last-child {
            border-bottom: none;
        }

        .role-option:hover {
            background-color: var(--bg);
        }

        .role-option.active {
            background-color: #e8f4fd;
            color: var(--primary);
            font-weight: 600;
        }

        .role-option-checkmark {
            margin-left: auto;
            font-weight: 700;
            color: var(--success);
        }

        .role-option-role {
            font-size: 12px;
            color: var(--muted);
            margin-top: 2px;
        }

        /* Views */
        .view {
            display: none;
        }

        .view.active {
            display: block;
            animation: fadeIn 0.25s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Cards and Layouts */
        .card {
            background-color: var(--card);
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .card-header h3 {
            font-size: 16px;
            font-weight: 600;
            margin: 0;
        }

        .card-header-actions {
            display: flex;
            gap: 8px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background-color: var(--card);
            border-radius: 10px;
            padding: 16px;
            border: 1px solid var(--border);
        }

        .stat-label {
            font-size: 12px;
            color: var(--muted);
            font-weight: 500;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--text);
        }

        .stat-subtext {
            font-size: 12px;
            color: var(--muted);
            margin-top: 6px;
        }

        /* Buttons */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: var(--transition);
            font-family: 'Inter', sans-serif;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: #1e3f5a;
        }

        .btn-secondary {
            background-color: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .btn-secondary:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-success:hover {
            background-color: #218838;
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background-color: #c82333;
        }

        .btn-warning {
            background-color: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background-color: #e06b00;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }

        .btn-icon {
            padding: 8px 12px;
            background-color: transparent;
            border: 1px solid var(--border);
            color: var(--text);
        }

        .btn-icon:hover {
            background-color: var(--bg);
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .badge-observer {
            background-color: #e8e8e8;
            color: #555;
        }

        .badge-advisor {
            background-color: #fff3e0;
            color: #e65100;
        }

        .badge-coordinator {
            background-color: #e3f2fd;
            color: #1565c0;
        }

        .badge-steward {
            background-color: #f3e5f5;
            color: #6a1b9a;
        }

        .badge-status {
            background-color: #e8f5e9;
            color: #2e7d32;
        }

        .badge-pending {
            background-color: #fff3e0;
            color: #e65100;
        }

        .badge-active {
            background-color: #e8f5e9;
            color: #2e7d32;
        }

        .badge-base { background-color: #0052ff; color: white; font-size: 10px; }
        .badge-eth { background-color: #627eea; color: white; font-size: 10px; }
        .badge-linea { background-color: #121212; color: white; font-size: 10px; }

        /* Tables */
        .table-responsive {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        th {
            text-align: left;
            padding: 12px;
            background-color: var(--bg);
            border-bottom: 2px solid var(--border);
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            color: var(--muted);
        }

        td {
            padding: 12px;
            border-bottom: 1px solid var(--border);
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background-color: var(--bg);
        }

        /* Modals */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.5);
            z-index: 1100;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.open {
            display: flex;
        }

        .modal {
            background-color: var(--card);
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-header h2 {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--muted);
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--text);
        }

        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 24px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-family: 'Inter', sans-serif;
            font-size: 13px;
            transition: var(--transition);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(43, 87, 151, 0.1);
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 32px;
            right: 32px;
            z-index: 2000;
        }

        .toast {
            background-color: var(--card);
            border-left: 4px solid var(--success);
            padding: 14px 20px;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            margin-bottom: 12px;
            font-size: 13px;
            animation: slideInRight 0.3s ease;
            min-width: 300px;
        }

        .toast.success { border-left-color: var(--success); }
        .toast.warning { border-left-color: var(--warning); }
        .toast.error { border-left-color: var(--danger); }
        .toast.info { border-left-color: var(--secondary); }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Scrollbars */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background-color: #d0d0d0;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background-color: #b0b0b0;
        }

        /* Utility Classes */
        .flex {
            display: flex;
        }

        .flex-between {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .flex-center {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .gap-8 { gap: 8px; }
        .gap-12 { gap: 12px; }
        .gap-16 { gap: 16px; }

        .mt-12 { margin-top: 12px; }
        .mt-16 { margin-top: 16px; }
        .mb-12 { margin-bottom: 12px; }
        .mb-16 { margin-bottom: 16px; }

        .text-muted { color: var(--muted); }
        .text-success { color: var(--success); }
        .text-danger { color: var(--danger); }
        .text-warning { color: var(--warning); }

        .text-sm { font-size: 12px; }
        .text-lg { font-size: 16px; }

        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }

        /* Agent Cards */
        .agent-card {
            background-color: var(--card);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: var(--transition);
        }

        .agent-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }

        .agent-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .agent-avatar {
            width: 44px;
            height: 44px;
            border-radius: 8px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
        }

        .agent-info h4 {
            font-size: 14px;
            font-weight: 600;
            margin: 0 0 4px 0;
        }

        .agent-info p {
            font-size: 12px;
            color: var(--muted);
            margin: 0;
        }

        .agent-card-badges {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        /* Opportunity Cards */
        .opportunity-card {
            background-color: var(--card);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: var(--transition);
        }

        .opportunity-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }

        .opportunity-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }

        .opportunity-header h4 {
            font-size: 14px;
            font-weight: 600;
            margin: 0;
            flex: 1;
        }

        .match-indicator {
            background-color: var(--success);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
        }

        .opportunity-details {
            display: flex;
            gap: 16px;
            font-size: 13px;
            color: var(--muted);
            margin-bottom: 12px;
        }

        .opportunity-detail-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: var(--border);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--success);
            transition: width 0.3s ease;
        }

        /* ETHDenver Watermark */
        .ethdenver-badge {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: linear-gradient(135deg, #7B1FA2, #2B5797);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            z-index: 999;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding: 20px 0;
        }

        .timeline-item {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
        }

        .timeline-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--primary);
            margin-top: 4px;
            flex-shrink: 0;
        }

        .timeline-content {
            flex: 1;
        }

        .timeline-content h5 {
            font-size: 13px;
            font-weight: 600;
            margin: 0 0 4px 0;
        }

        .timeline-content p {
            font-size: 12px;
            color: var(--muted);
            margin: 0;
        }

        /* Divider */
        .divider {
            height: 1px;
            background-color: var(--border);
            margin: 20px 0;
        }

        /* Status workflow */
        .status-workflow {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 20px 0;
        }

        .workflow-step {
            flex: 1;
            height: 4px;
            background-color: var(--border);
            border-radius: 2px;
            position: relative;
        }

        .workflow-step.completed {
            background-color: var(--success);
        }

        .workflow-step.active {
            background-color: var(--primary);
        }

        /* Alert Box */
        .alert {
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 16px;
            font-size: 13px;
        }

        .alert-info {
            background-color: #e3f2fd;
            color: #1565c0;
            border-left: 3px solid #1565c0;
        }

        .alert-warning {
            background-color: #fff3e0;
            color: #e65100;
            border-left: 3px solid #e65100;
        }

        .alert-success {
            background-color: #e8f5e9;
            color: #2e7d32;
            border-left: 3px solid #2e7d32;
        }

        /* Grid Layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        @media (max-width: 1200px) {
            .grid-3 { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 768px) {
            .grid-2 { grid-template-columns: 1fr; }
            .grid-3 { grid-template-columns: 1fr; }
        }

/* ============================================================================
   MODE TOGGLE + GUIDED TOUR + ONBOARDING SYSTEM
   ============================================================================ */

.mode-toggle {
  display: flex;
  background: #f1f5f9;
  border-radius: 8px;
  padding: 3px;
  gap: 2px;
}
.mode-btn {
  border: none;
  background: transparent;
  padding: 6px 14px;
  border-radius: 6px;
  font-size: 0.8rem;
  cursor: pointer;
  color: #64748b;
  font-weight: 500;
  transition: all 0.2s;
  white-space: nowrap;
}
.mode-btn:hover { background: #e2e8f0; color: #334155; }
.mode-btn.active { background: white; color: #1e293b; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }

/* Tour Overlay */
.tour-overlay {
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  z-index: 10000;
  pointer-events: none;
}
.tour-overlay.active { display: block; }
.tour-overlay.active::before {
  content: '';
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.5);
  pointer-events: auto;
}

.tour-spotlight {
  position: absolute;
  border: 3px solid #3b82f6;
  border-radius: 8px;
  box-shadow: 0 0 0 9999px rgba(0,0,0,0.5);
  background: transparent;
  z-index: 10001;
  transition: all 0.4s ease;
  pointer-events: none;
}

.tour-tooltip {
  position: absolute;
  background: white;
  border-radius: 12px;
  padding: 20px 24px;
  max-width: 380px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  z-index: 10002;
  pointer-events: auto;
  animation: slideUp 0.3s ease-out;
}
.tour-tooltip-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}
.tour-tooltip-header h3 { margin: 0; font-size: 1rem; color: #1e293b; }
.tour-step-badge {
  background: #3b82f6;
  color: white;
  padding: 2px 10px;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
  white-space: nowrap;
}
.tour-tooltip p { margin: 0 0 16px 0; font-size: 0.875rem; color: #64748b; line-height: 1.5; }
.tour-tooltip-actions { display: flex; gap: 8px; justify-content: flex-end; }

/* Onboarding overlay additions */
.onboarding-overlay { display: none; }
.onboarding-overlay.active { display: flex; }

        /* V3.0 CSS ADDITIONS */
/* ============================================================================
   AGENTIC TRUST LAYER v3.0 - CSS ADDITIONS
   Production-quality styles for new v3.0 features
   ============================================================================ */

/* ============================================================================
   1. ONBOARDING WIZARD
   ============================================================================ */

.onboarding-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.6);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  animation: fadeIn var(--transition) ease-in-out;
}

.onboarding-wizard {
  background: var(--card);
  border-radius: 12px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  max-width: 600px;
  width: 90%;
  padding: 40px;
  position: relative;
  animation: slideUp var(--transition) ease-out;
}

.onboarding-progress {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-bottom: 40px;
}

.onboarding-progress-step {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: var(--border);
  cursor: pointer;
  transition: all var(--transition) ease-out;
  position: relative;
}

.onboarding-progress-step:hover {
  transform: scale(1.2);
}

.onboarding-progress-step.active {
  background: var(--primary);
  box-shadow: 0 0 0 6px rgba(66, 103, 178, 0.1);
}

.onboarding-progress-step.completed {
  background: var(--success);
}

.onboarding-content {
  text-align: center;
  margin-bottom: 40px;
  min-height: 200px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.onboarding-content h2 {
  color: var(--text);
  margin-bottom: 16px;
  font-size: 24px;
  font-weight: 600;
}

.onboarding-content p {
  color: var(--muted);
  line-height: 1.6;
  margin-bottom: 12px;
}

.onboarding-actions {
  display: flex;
  gap: 12px;
  justify-content: center;
  flex-wrap: wrap;
}

.onboarding-actions button {
  min-width: 120px;
}

/* ============================================================================
   2. INITIATIVE CARDS (Enhanced from opportunity cards)
   ============================================================================ */

.initiative-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 24px;
  transition: all var(--transition) ease-out;
  position: relative;
  overflow: hidden;
}

.initiative-card:hover {
  border-color: var(--primary);
  box-shadow: 0 8px 24px rgba(66, 103, 178, 0.12);
  transform: translateY(-4px);
}

.initiative-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
  gap: 12px;
}

.initiative-header h3 {
  color: var(--text);
  margin: 0;
  font-size: 18px;
  font-weight: 600;
  flex: 1;
}

.initiative-meta {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 12px;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.initiative-meta-item {
  font-size: 12px;
}

.initiative-meta-label {
  color: var(--muted);
  text-transform: uppercase;
  font-weight: 600;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.initiative-meta-value {
  color: var(--text);
  font-weight: 500;
}

.initiative-progress {
  margin-bottom: 20px;
}

.initiative-progress-label {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  font-size: 13px;
}

.initiative-progress-label span:first-child {
  color: var(--text);
  font-weight: 500;
}

.initiative-progress-label span:last-child {
  color: var(--primary);
  font-weight: 600;
}

.progress-bar {
  width: 100%;
  height: 8px;
  background: var(--border);
  border-radius: 4px;
  overflow: hidden;
}

.progress-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--primary), var(--accent));
  transition: width 0.6s ease-out;
  border-radius: 4px;
}

.initiative-milestones {
  display: flex;
  gap: 8px;
  margin-top: 16px;
}

.initiative-milestone {
  flex: 1;
  height: 4px;
  background: var(--border);
  border-radius: 2px;
  transition: all var(--transition) ease-out;
  position: relative;
  cursor: pointer;
}

.initiative-milestone:hover {
  height: 6px;
}

.initiative-milestone.complete {
  background: var(--success);
}

.initiative-milestone.active {
  background: var(--primary);
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

.initiative-milestone.pending {
  background: var(--border);
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.6;
  }
}

/* ============================================================================
   3. ECOSYSTEM MAP VISUALIZATION (CSS-based)
   ============================================================================ */

.ecosystem-map-container {
  position: relative;
  min-height: 400px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
  overflow: hidden;
}

.ecosystem-map-canvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.ecosystem-node {
  position: absolute;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  font-weight: 600;
  cursor: pointer;
  transition: all var(--transition) ease-out;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  border: 2px solid rgba(255, 255, 255, 0.8);
}

.ecosystem-node:hover {
  transform: scale(1.15);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
  z-index: 10;
}

.ecosystem-node::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: -30px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--text);
  color: var(--bg);
  padding: 6px 12px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 500;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--transition) ease-out;
}

.ecosystem-node:hover::after {
  opacity: 1;
}

.ecosystem-node.org {
  background: linear-gradient(135deg, #42678b, #5a88b3);
  color: white;
}

.ecosystem-node.contributor {
  background: linear-gradient(135deg, #28a745, #34ce57);
  color: white;
}

.ecosystem-node.agent {
  background: linear-gradient(135deg, #7b1fa2, #9c27b0);
  color: white;
}

.ecosystem-node.funder {
  background: linear-gradient(135deg, #f57c00, #fb8500);
  color: white;
}

.ecosystem-node-label {
  position: absolute;
  bottom: -45px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
  color: var(--text);
  font-weight: 500;
  text-align: center;
  white-space: nowrap;
  pointer-events: none;
}

.ecosystem-connection {
  position: absolute;
  height: 2px;
  background: linear-gradient(90deg, var(--border), transparent);
  transform-origin: left center;
  pointer-events: none;
}

.ecosystem-connection.strong {
  background: linear-gradient(90deg, var(--primary), transparent);
  height: 3px;
}

.ecosystem-legend {
  position: absolute;
  bottom: 16px;
  left: 20px;
  right: 20px;
  display: flex;
  gap: 24px;
  flex-wrap: wrap;
  background: rgba(255, 255, 255, 0.95);
  padding: 12px 16px;
  border-radius: 6px;
  border: 1px solid var(--border);
}

.ecosystem-legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: var(--text);
  font-weight: 500;
}

.ecosystem-legend-dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
}

.ecosystem-legend-dot.org {
  background: #5a88b3;
}

.ecosystem-legend-dot.contributor {
  background: #34ce57;
}

.ecosystem-legend-dot.agent {
  background: #9c27b0;
}

.ecosystem-legend-dot.funder {
  background: #fb8500;
}

/* ============================================================================
   4. TRUST TIER LADDER (Visual progression)
   ============================================================================ */

.tier-ladder {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.tier-ladder.horizontal {
  flex-direction: row;
  gap: 12px;
}

.tier-step {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 16px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 8px;
  transition: all var(--transition) ease-out;
  position: relative;
}

.tier-ladder.horizontal .tier-step {
  flex: 1;
  flex-direction: column;
  text-align: center;
  gap: 12px;
}

.tier-step.current {
  background: linear-gradient(135deg, rgba(66, 103, 178, 0.1), rgba(124, 102, 209, 0.1));
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(66, 103, 178, 0.1);
}

.tier-step.achieved {
  background: linear-gradient(135deg, rgba(40, 167, 69, 0.1), rgba(52, 206, 87, 0.1));
  border-color: var(--success);
}

.tier-step.locked {
  opacity: 0.6;
  background: var(--bg);
  border-color: var(--border);
}

.tier-step-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  font-weight: 600;
  flex-shrink: 0;
  background: var(--border);
  color: var(--text);
}

.tier-step.current .tier-step-icon {
  background: var(--primary);
  color: white;
  box-shadow: 0 0 0 4px rgba(66, 103, 178, 0.2);
}

.tier-step.achieved .tier-step-icon {
  background: var(--success);
  color: white;
}

.tier-step.locked .tier-step-icon {
  background: var(--muted);
  color: var(--bg);
}

.tier-step-label {
  flex: 1;
}

.tier-ladder.horizontal .tier-step-label {
  flex: none;
}

.tier-step-label h4 {
  margin: 0 0 4px 0;
  color: var(--text);
  font-size: 14px;
  font-weight: 600;
}

.tier-step-label p {
  margin: 0;
  color: var(--muted);
  font-size: 12px;
  line-height: 1.4;
}

.tier-step-connector {
  height: 24px;
  margin: -2px 0;
  border-left: 2px solid var(--border);
  position: relative;
  margin-left: 19px;
}

.tier-step.achieved ~ .tier-step-connector {
  border-color: var(--success);
}

.tier-ladder.horizontal .tier-step-connector {
  display: none;
}

/* ============================================================================
   5. MULTI-STEP FORM
   ============================================================================ */

.form-wizard {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.form-wizard-steps {
  display: flex;
  justify-content: space-between;
  position: relative;
  margin-bottom: 8px;
}

.form-wizard-steps::before {
  content: '';
  position: absolute;
  top: 20px;
  left: 0;
  right: 0;
  height: 2px;
  background: var(--border);
  z-index: 0;
}

.form-wizard-step {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  position: relative;
  z-index: 1;
}

.form-wizard-step::before {
  content: attr(data-step);
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: var(--card);
  border: 2px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  color: var(--muted);
  font-size: 14px;
  transition: all var(--transition) ease-out;
}

.form-wizard-step.active::before {
  background: var(--primary);
  border-color: var(--primary);
  color: white;
  box-shadow: 0 0 0 4px rgba(66, 103, 178, 0.2);
}

.form-wizard-step.completed::before {
  content: '✓';
  background: var(--success);
  border-color: var(--success);
  color: white;
}

.form-wizard-step-label {
  font-size: 12px;
  font-weight: 500;
  color: var(--muted);
  text-align: center;
  transition: color var(--transition) ease-out;
}

.form-wizard-step.active .form-wizard-step-label {
  color: var(--text);
  font-weight: 600;
}

.form-wizard-content {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 32px;
  min-height: 300px;
}

.form-wizard-actions {
  display: flex;
  justify-content: space-between;
  gap: 12px;
  padding-top: 24px;
  border-top: 1px solid var(--border);
}

.form-wizard-actions button {
  min-width: 120px;
}

/* ============================================================================
   6. TAB NAVIGATION
   ============================================================================ */

.tab-nav {
  display: flex;
  border-bottom: 2px solid var(--border);
  gap: 0;
  background: var(--card);
  border-radius: 8px 8px 0 0;
  padding: 0 16px;
}

.tab-nav-item {
  padding: 12px 16px;
  font-size: 14px;
  font-weight: 500;
  color: var(--muted);
  cursor: pointer;
  border-bottom: 3px solid transparent;
  transition: all var(--transition) ease-out;
  position: relative;
  background: transparent;
  border: none;
  white-space: nowrap;
  margin-bottom: -2px;
}

.tab-nav-item:hover {
  color: var(--text);
  border-bottom-color: var(--border);
}

.tab-nav-item.active {
  color: var(--primary);
  border-bottom-color: var(--primary);
}

.tab-content {
  background: var(--card);
  border: 1px solid var(--border);
  border-top: none;
  border-radius: 0 0 8px 8px;
}

.tab-pane {
  padding: 24px;
  display: none;
  animation: fadeIn var(--transition) ease-in-out;
}

.tab-pane.active {
  display: block;
}

/* ============================================================================
   7. STATUS INDICATORS
   ============================================================================ */

.status-dot {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-right: 6px;
}

.status-dot.online {
  background: var(--success);
  box-shadow: 0 0 0 2px rgba(40, 167, 69, 0.2);
}

.status-dot.offline {
  background: var(--muted);
}

.status-dot.busy {
  background: var(--warning);
  box-shadow: 0 0 0 2px rgba(255, 193, 7, 0.2);
}

.status-dot.away {
  background: #ffc107;
}

.status-indicator {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  font-weight: 500;
  padding: 4px 8px;
  background: var(--bg);
  border-radius: 4px;
}

/* ============================================================================
   8. FEATURE TOGGLE SWITCHES
   ============================================================================ */

.toggle-switch {
  position: relative;
  display: inline-block;
  width: 44px;
  height: 24px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-switch-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--border);
  transition: all var(--transition) ease-out;
  border-radius: 24px;
}

.toggle-switch-slider::before {
  content: '';
  position: absolute;
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: all var(--transition) ease-out;
  border-radius: 50%;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.toggle-switch input:checked + .toggle-switch-slider {
  background-color: var(--primary);
}

.toggle-switch input:checked + .toggle-switch-slider::before {
  transform: translateX(20px);
}

.toggle-switch input:disabled + .toggle-switch-slider {
  opacity: 0.5;
  cursor: not-allowed;
}

/* ============================================================================
   9. ACCESS MATRIX GRID
   ============================================================================ */

.access-matrix {
  overflow-x: auto;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: var(--card);
}

.access-matrix-table {
  width: 100%;
  border-collapse: collapse;
}

.access-matrix-header {
  background: var(--bg);
  border-bottom: 2px solid var(--border);
}

.access-matrix-header th {
  padding: 12px 16px;
  text-align: left;
  font-size: 12px;
  font-weight: 600;
  color: var(--text);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-right: 1px solid var(--border);
}

.access-matrix-header th:last-child {
  border-right: none;
}

.access-matrix-row {
  border-bottom: 1px solid var(--border);
  transition: background-color var(--transition) ease-out;
}

.access-matrix-row:hover {
  background: var(--bg);
}

.access-matrix-row:last-child {
  border-bottom: none;
}

.access-matrix-cell {
  padding: 12px 16px;
  font-size: 13px;
  color: var(--text);
  border-right: 1px solid var(--border);
}

.access-matrix-cell:last-child {
  border-right: none;
}

.access-matrix-check {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  border-radius: 4px;
  background: var(--bg);
  border: 1px solid var(--border);
  margin: 0 auto;
  font-size: 12px;
  font-weight: 600;
  color: var(--primary);
  cursor: pointer;
  transition: all var(--transition) ease-out;
}

.access-matrix-check:hover {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

.access-matrix-check.checked {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

/* ============================================================================
   10. MISCELLANEOUS ENHANCEMENTS
   ============================================================================ */

/* Copy Button */
.copy-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  padding: 0;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  cursor: pointer;
  color: var(--muted);
  font-size: 12px;
  transition: all var(--transition) ease-out;
  margin-left: 8px;
}

.copy-btn:hover {
  background: var(--primary);
  border-color: var(--primary);
  color: white;
}

.copy-btn.copied {
  animation: copyPulse 0.4s ease-out;
}

@keyframes copyPulse {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.2);
  }
  100% {
    transform: scale(1);
  }
}

/* Severity Indicators */
.severity-info {
  color: var(--primary);
}

.severity-success {
  color: var(--success);
}

.severity-warning {
  color: var(--warning);
}

.severity-danger {
  color: var(--danger);
}

/* Card with Tabs */
.card-tabs {
  display: flex;
  border-bottom: 2px solid var(--border);
  gap: 0;
  padding: 0 16px;
  margin: -24px -24px 16px -24px;
}

.card-tabs-item {
  padding: 12px 16px;
  font-size: 13px;
  font-weight: 500;
  color: var(--muted);
  cursor: pointer;
  border-bottom: 3px solid transparent;
  transition: all var(--transition) ease-out;
  background: transparent;
  border: none;
  margin-bottom: -2px;
}

.card-tabs-item:hover {
  color: var(--text);
}

.card-tabs-item.active {
  color: var(--primary);
  border-bottom-color: var(--primary);
}

/* Sector Tags/Chips */
.sector-tag {
  display: inline-block;
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
  background: var(--bg);
  border: 1px solid var(--border);
  color: var(--text);
  transition: all var(--transition) ease-out;
  cursor: pointer;
}

.sector-tag:hover {
  background: var(--border);
}

.sector-tag.workforce {
  background: rgba(43, 87, 151, 0.1);
  border-color: #2B5797;
  color: #2B5797;
}

.sector-tag.housing {
  background: rgba(245, 124, 0, 0.1);
  border-color: #F57C00;
  color: #F57C00;
}

.sector-tag.youth {
  background: rgba(123, 31, 162, 0.1);
  border-color: #7B1FA2;
  color: #7B1FA2;
}

.sector-tag.health {
  background: rgba(40, 167, 69, 0.1);
  border-color: #28A745;
  color: #28A745;
}

.sector-tag.food {
  background: rgba(220, 53, 69, 0.1);
  border-color: #DC3545;
  color: #DC3545;
}

/* Coordinator Card */
.coordinator-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  transition: all var(--transition) ease-out;
}

.coordinator-card:hover {
  border-color: var(--primary);
  box-shadow: 0 4px 12px rgba(66, 103, 178, 0.1);
}

.coordinator-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary), var(--accent));
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 14px;
  flex-shrink: 0;
}

.coordinator-info {
  flex: 1;
  min-width: 0;
}

.coordinator-name {
  color: var(--text);
  font-size: 14px;
  font-weight: 600;
  margin: 0 0 4px 0;
}

.coordinator-role {
  color: var(--muted);
  font-size: 12px;
  margin: 0;
}

/* Overlap Warning */
.overlap-warning {
  background: linear-gradient(135deg, rgba(220, 53, 69, 0.1), rgba(255, 107, 107, 0.1));
  border: 1px solid rgba(220, 53, 69, 0.3);
  border-radius: 8px;
  padding: 16px;
  border-left: 4px solid #DC3545;
  margin-bottom: 16px;
}

.overlap-warning-title {
  color: #DC3545;
  font-size: 14px;
  font-weight: 600;
  margin: 0 0 8px 0;
}

.overlap-warning-description {
  color: var(--text);
  font-size: 13px;
  line-height: 1.5;
  margin: 0;
}

.overlap-warning-items {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid rgba(220, 53, 69, 0.2);
}

.overlap-warning-item {
  font-size: 12px;
  color: var(--text);
  margin: 6px 0;
  padding-left: 20px;
  position: relative;
}

.overlap-warning-item::before {
  content: '⚠';
  position: absolute;
  left: 0;
  color: #DC3545;
  font-weight: 600;
}

/* Initiative Sector Border Colors */
.initiative-card.sector-workforce {
  border-left: 4px solid #2B5797;
}

.initiative-card.sector-housing {
  border-left: 4px solid #F57C00;
}

.initiative-card.sector-youth {
  border-left: 4px solid #7B1FA2;
}

.initiative-card.sector-health {
  border-left: 4px solid #28A745;
}

.initiative-card.sector-food {
  border-left: 4px solid #DC3545;
}

/* ============================================================================
   RESPONSIVE ADJUSTMENTS
   ============================================================================ */

@media (max-width: 768px) {
  .onboarding-wizard {
    max-width: 95%;
    padding: 24px;
  }

  .onboarding-content {
    min-height: 150px;
  }

  .onboarding-content h2 {
    font-size: 20px;
  }

  .onboarding-actions {
    flex-direction: column;
  }

  .onboarding-actions button {
    width: 100%;
  }

  .initiative-meta {
    grid-template-columns: 1fr 1fr;
  }

  .ecosystem-map-container {
    min-height: 300px;
  }

  .tier-ladder.horizontal {
    flex-direction: column;
    gap: 2px;
  }

  .tier-ladder.horizontal .tier-step {
    flex-direction: row;
    text-align: left;
    gap: 16px;
  }

  .form-wizard-content {
    padding: 24px 16px;
    min-height: 250px;
  }

  .form-wizard-actions {
    flex-direction: column;
  }

  .form-wizard-actions button {
    width: 100%;
  }

  .tab-nav {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  .access-matrix {
    font-size: 12px;
  }

  .access-matrix-cell {
    padding: 8px 12px;
  }

  .coordinator-card {
    flex-direction: column;
    text-align: center;
  }

  .coordinator-name {
    margin: 8px 0 4px 0;
  }

  .card-tabs {
    margin-left: -16px;
    margin-right: -16px;
    padding: 0 16px;
  }

  .card-tabs-item {
    padding: 12px 12px;
  }
}

@media (max-width: 480px) {
  .onboarding-overlay {
    padding: 16px;
  }

  .onboarding-wizard {
    max-width: 100%;
    padding: 20px;
  }

  .form-wizard-steps {
    gap: 4px;
  }

  .form-wizard-step::before {
    width: 32px;
    height: 32px;
    font-size: 12px;
  }

  .form-wizard-step-label {
    font-size: 10px;
  }

  .ecosystem-map-container {
    min-height: 250px;
    padding: 16px;
  }

  .ecosystem-legend {
    bottom: 12px;
    left: 12px;
    right: 12px;
    gap: 12px;
    padding: 8px 12px;
    font-size: 11px;
  }

  .access-matrix-table {
    font-size: 11px;
  }

  .tier-step {
    padding: 12px;
  }

  .tier-step-label h4 {
    font-size: 13px;
  }

  .tier-step-label p {
    font-size: 11px;
  }
}

/* ============================================================================
   DARK MODE SUPPORT (if applicable)
   ============================================================================ */

@media (prefers-color-scheme: dark) {
  .onboarding-overlay {
    background: rgba(0, 0, 0, 0.8);
  }

  .ecosystem-legend {
    background: rgba(30, 30, 30, 0.95);
  }

  .coordinator-avatar {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  }

  .toggle-switch-slider::before {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
  }

  .copy-btn {
    background: var(--bg);
  }

  .copy-btn:hover {
    background: var(--primary);
  }
}

/* ============================================================================
   PRINT STYLES
   ============================================================================ */

@media print {
  .onboarding-overlay,
  .onboarding-wizard,
  .form-wizard-actions,
  .tab-nav,
  .copy-btn {
    display: none;
  }

  .initiative-card,
  .tier-step,
  .coordinator-card {
    page-break-inside: avoid;
    box-shadow: none;
    border: 1px solid #ccc;
  }

  .ecosystem-map-container {
    page-break-inside: avoid;
  }
}

/* ============================================================================
   ONBOARDING FORM STYLES
   ============================================================================ */

.ob-form { text-align: left; }
.ob-field { margin-bottom: 16px; }
.ob-field label { display: block; font-size: 0.8rem; font-weight: 600; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 6px; }
.ob-field input, .ob-field select, .ob-field textarea {
    width: 100%; padding: 10px 12px; border: 1px solid var(--border); border-radius: 8px;
    font-size: 0.95rem; background: var(--card); color: var(--foreground);
    font-family: inherit; box-sizing: border-box;
}
.ob-field input:focus, .ob-field select:focus, .ob-field textarea:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 3px rgba(37,99,235,0.1); }
.ob-field textarea { resize: vertical; min-height: 60px; }
.ob-field .ob-hint { font-size: 0.8rem; color: var(--muted); margin-top: 4px; }
.ob-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.ob-tags { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
.ob-tag { padding: 6px 14px; border-radius: 16px; font-size: 0.85rem; cursor: pointer; border: 1px solid var(--border); background: var(--card); transition: var(--transition); }
.ob-tag.selected { background: #dbeafe; color: #1d4ed8; border-color: #93c5fd; font-weight: 500; }
.ob-tag:hover { border-color: var(--primary); }
.ob-agent-preview {
    margin-top: 16px; padding: 16px; background: linear-gradient(135deg, #eff6ff, #f0fdf4);
    border-radius: 10px; border: 1px solid #d1e5f7; display: flex; align-items: center; gap: 14px;
}
.ob-agent-preview .ob-agent-icon {
    width: 48px; height: 48px; border-radius: 10px;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white; display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0;
}
.ob-agent-preview .ob-agent-meta h4 { margin: 0 0 2px 0; font-size: 0.95rem; }
.ob-agent-preview .ob-agent-meta p { margin: 0; font-size: 0.8rem; color: var(--muted); }
.ob-summary { text-align: left; }
.ob-summary-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--border); font-size: 0.9rem; }
.ob-summary-item:last-child { border-bottom: none; }
.ob-summary-item .ob-label { color: var(--muted); }
.ob-summary-item .ob-value { font-weight: 600; }
.ob-wallet-card {
    margin-top: 16px; padding: 20px; background: linear-gradient(135deg, #1e293b, #334155);
    border-radius: 12px; color: white; text-align: left;
}
.ob-wallet-card .ob-wallet-label { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; opacity: 0.7; }
.ob-wallet-card .ob-wallet-addr { font-family: monospace; font-size: 0.85rem; margin-top: 4px; word-break: break-all; }
.ob-wallet-card .ob-wallet-chain { margin-top: 12px; display: flex; align-items: center; gap: 8px; }
.ob-wallet-card .ob-wallet-chain span { background: rgba(255,255,255,0.15); padding: 4px 10px; border-radius: 6px; font-size: 0.8rem; }
.ob-check { display: flex; align-items: center; gap: 10px; padding: 8px 0; font-size: 0.9rem; text-align: left; }
.ob-check input[type="checkbox"] { width: 18px; height: 18px; accent-color: var(--primary); flex-shrink: 0; }

/* ============================================================================
   AGL v3 VISUAL COMPONENTS
   ============================================================================ */

/* Agent Cards */
.agent-card { background-color: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: var(--transition); }
.agent-card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-color: var(--primary); }
.agent-card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
.agent-avatar { width: 44px; height: 44px; border-radius: 8px; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 16px; }
.agent-info h4 { font-size: 14px; font-weight: 600; margin: 0 0 4px 0; }
.agent-info p { font-size: 12px; color: var(--muted); margin: 0; }
.agent-card-badges { display: flex; gap: 6px; flex-wrap: wrap; }

/* Opportunity Cards */
.opportunity-card { background-color: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: var(--transition); }
.opportunity-card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-color: var(--primary); }
.opportunity-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px; }
.match-indicator { background-color: var(--success); color: white; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; }
.opportunity-details { display: flex; gap: 16px; font-size: 13px; color: var(--muted); margin-bottom: 12px; }
.opportunity-detail-item { display: inline-flex; align-items: center; gap: 4px; }

/* Timeline */
.timeline { position: relative; padding: 20px 0; }
.timeline-item { display: flex; gap: 16px; margin-bottom: 20px; }
.timeline-dot { width: 12px; height: 12px; border-radius: 50%; background-color: var(--primary); margin-top: 4px; flex-shrink: 0; }
.timeline-content { flex: 1; }
.timeline-content h5 { font-size: 13px; font-weight: 600; margin: 0 0 4px 0; }
.timeline-content p { font-size: 12px; color: var(--muted); margin: 0; }

/* Alerts */
.alert { padding: 12px 16px; border-radius: 6px; margin-bottom: 16px; font-size: 13px; }
.alert-info { background-color: #e3f2fd; color: #1565c0; border-left: 3px solid #1565c0; }
.alert-warning { background-color: #fff3e0; color: #e65100; border-left: 3px solid #e65100; }
.alert-success { background-color: #e8f5e9; color: #2e7d32; border-left: 3px solid #2e7d32; }

/* Trust Tier Badges */
.badge-observer { background-color: #e8e8e8; color: #555; }
.badge-advisor { background-color: #fff3e0; color: #e65100; }
.badge-coordinator { background-color: #e3f2fd; color: #1565c0; }
.badge-steward { background-color: #f3e5f5; color: #6a1b9a; }

/* Chain Badges */
.badge-base { background-color: #0052ff; color: white; font-size: 10px; }
.badge-eth { background-color: #627eea; color: white; font-size: 10px; }
.badge-linea { background-color: #121212; color: white; font-size: 10px; }

/* Stat Grid & Status */
.stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px; }
.stat-subtext { font-size: 12px; color: var(--muted); margin-top: 6px; }
.badge-status { background-color: var(--success); color: white; }

    </style>
</head>
<body>

<div class="layout">
    <!-- SIDEBAR -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-logo">🔐 AGENTIC TRUST</div>
        <div class="sidebar-section" id="sidebar-main">
            <div class="sidebar-section-title">Main</div>
        </div>
        <div class="sidebar-section" id="sidebar-tools">
            <div class="sidebar-section-title">Admin Tools</div>
        </div>
    </div>

    <!-- HEADER -->
    <div class="header">
        <div class="header-left">
            <div class="breadcrumb">
                <strong id="header-title">Dashboard</strong>
            </div>
        </div>
        <div class="header-right">
            <!-- Mode Toggle -->
            <div class="mode-toggle" id="mode-toggle">
                <button class="mode-btn active" data-mode="explore" onclick="setAppMode('explore')" title="Free Exploration">🧭 Explore</button>
                <button class="mode-btn" data-mode="tour" onclick="setAppMode('tour')" title="Guided Tour of Features">🎯 Tour</button>
                <button class="mode-btn" data-mode="onboard" onclick="setAppMode('onboard')" title="Onboarding Flow">🚀 Onboard</button>
            </div>
            <div class="web3-badge">🔗 Connected via Web3Auth</div>
            <div class="role-switcher">
                <button class="role-button" id="role-button">
                    <span class="role-dot" id="role-dot"></span>
                    <span id="role-name">Admin</span>
                </button>
                <div class="role-dropdown" id="role-dropdown"></div>
            </div>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main-content" id="main-content">
        <!-- Views will be inserted here -->
    </div>
</div>

<!-- Modal Overlay -->
<div class="modal-overlay" id="modal-overlay">
    <div class="modal" id="modal">
        <div class="modal-header">
            <h2 id="modal-title">Modal Title</h2>
            <button class="modal-close" id="modal-close">&times;</button>
        </div>
        <div class="modal-body" id="modal-body"></div>
        <div class="modal-footer" id="modal-footer"></div>
    </div>
</div>

<!-- Tour Spotlight Overlay -->
<div class="tour-overlay" id="tour-overlay">
    <div class="tour-spotlight" id="tour-spotlight"></div>
    <div class="tour-tooltip" id="tour-tooltip">
        <div class="tour-tooltip-header">
            <span class="tour-step-badge" id="tour-step-badge">1/5</span>
            <h3 id="tour-tooltip-title">Tour Title</h3>
        </div>
        <p id="tour-tooltip-desc">Description</p>
        <div class="tour-tooltip-actions">
            <button class="btn btn-sm btn-secondary" id="tour-prev" onclick="tourPrev()">← Back</button>
            <button class="btn btn-sm btn-secondary" onclick="endTour()">Skip Tour</button>
            <button class="btn btn-sm btn-primary" id="tour-next" onclick="tourNext()">Next →</button>
        </div>
    </div>
</div>

<!-- Onboarding Wizard Overlay -->
<div class="onboarding-overlay" id="onboarding-overlay">
    <div class="onboarding-wizard">
        <div class="onboarding-progress" id="onboarding-progress"></div>
        <div class="onboarding-content" id="onboarding-content"></div>
        <div class="onboarding-actions" id="onboarding-actions"></div>
    </div>
</div>

<!-- Toast Container -->
<div class="toast-container" id="toast-container"></div>

<!-- ETHDenver Badge -->
<div class="ethdenver-badge">🏗️ ETHDenver 2026 BUIDLathon</div>


<script>
// ============================================================
// AGENTIC TRUST LAYER v3.0 - Part 1: Framework
// ETHDenver 2026 BUIDLathon | PROSPERIA Track
// ============================================================

// ========== STATE MANAGEMENT ==========
const APP_STATE = {
    currentRole: 'admin',
    currentView: 'dashboard',
    onboardingComplete: {},
    activeInitiative: null,
    viewCache: {}
};

// ========== ROLES ==========
const ROLES = {
    admin: {
        name: 'Elena Rodriguez',
        title: 'System Administrator',
        email: 'elena@unitedfw.org',
        color: '#DC3545',
        navSections: ['main', 'initiatives', 'admin']
    },
    coordinator: {
        name: 'Sarah Chen',
        title: 'Coalition Coordinator',
        email: 'sarah@unitedfw.org',
        color: '#7B1FA2',
        navSections: ['main', 'initiatives', 'coordination']
    },
    org_admin: {
        name: 'Marcus Webb',
        title: 'Organization Admin',
        email: 'marcus@metroworkforce.org',
        color: '#2B5797',
        navSections: ['main', 'initiatives', 'org_admin']
    },
    contributor: {
        name: 'Priya Patel',
        title: 'Data Analyst',
        email: 'priya@freelance.com',
        color: '#28A745',
        navSections: ['main', 'initiatives']
    },
    funder: {
        name: 'David Park',
        title: 'Grantmaker',
        email: 'david@dfwfoundation.org',
        color: '#F57C00',
        navSections: ['main', 'initiatives', 'grant']
    }
};

// ========== NAVIGATION ITEMS ==========
const NAV_ITEMS = {
    main: {
        label: 'Main',
        items: [
            { id: 'dashboard', label: '📊 Dashboard', view: 'dashboard' },
            { id: 'agents', label: '🤖 Agent Registry', view: 'agent-registry', roles: ['admin', 'coordinator', 'org_admin'] },
            { id: 'coordination', label: '🔄 Coordination Hub', view: 'coordination-hub', roles: ['coordinator'] },
            { id: 'trust-trail', label: '📜 Trust Trail', view: 'trust-trail' },
            { id: 'opportunities', label: '💼 Opportunities', view: 'opportunities', roles: ['contributor'] },
            { id: 'engagements', label: '✅ My Engagements', view: 'my-engagements', roles: ['contributor'] },
            { id: 'reputation', label: '⭐ My Reputation', view: 'my-reputation', roles: ['contributor'] },
            { id: 'wallet', label: '💰 Wallet', view: 'wallet', roles: ['coordinator', 'org_admin', 'contributor', 'admin'] },
            { id: 'ecosystem', label: '🌐 Ecosystem Map', view: 'ecosystem-map', roles: ['admin', 'coordinator', 'funder'] },
            { id: 'portfolio', label: '📈 Portfolio Overview', view: 'portfolio-overview', roles: ['funder'] },
            { id: 'outcomes', label: '✔️ Outcome Verification', view: 'outcome-verification', roles: ['funder'] },
            { id: 'compliance', label: '📋 Compliance', view: 'compliance', roles: ['funder'] },
            { id: 'analytics', label: '📊 Analytics', view: 'analytics', roles: ['admin', 'coordinator', 'funder'] }
        ]
    },
    initiatives: {
        label: 'Initiatives',
        items: [
            { id: 'initiative-dashboard', label: '🎯 Initiative Dashboard', view: 'initiative-dashboard' },
            { id: 'active-initiatives', label: '📋 Active Initiatives', view: 'active-initiatives' },
            { id: 'create-initiative', label: '➕ Create Initiative', view: 'create-initiative', roles: ['coordinator', 'org_admin', 'admin'] },
            { id: 'my-initiatives', label: '📌 My Initiatives', view: 'my-initiatives', roles: ['contributor', 'org_admin'] },
            { id: 'initiative-matching', label: '🔗 Smart Matching', view: 'initiative-matching', roles: ['coordinator', 'admin'] }
        ]
    },
    admin: {
        label: 'Admin Tools',
        items: [
            { id: 'system-settings', label: '⚙️ System Settings', view: 'system-settings', roles: ['admin'] },
            { id: 'users', label: '👥 User Management', view: 'user-management', roles: ['admin'] },
            { id: 'protocol', label: '📡 Protocol Config', view: 'protocol-config', roles: ['admin'] },
            { id: 'approvals', label: '✋ Agent Approvals', view: 'agent-approvals', roles: ['admin', 'coordinator'] },
            { id: 'audit', label: '🔍 Audit Log', view: 'audit-log', roles: ['admin'] }
        ]
    },
    coordination: {
        label: 'Coordination Tools',
        items: [
            { id: 'coalition-settings', label: '⚙️ Coalition Settings', view: 'coalition-settings', roles: ['coordinator'] },
            { id: 'member-orgs', label: '🏢 Member Organizations', view: 'member-organizations', roles: ['coordinator'] },
            { id: 'coordinator-sync', label: '🔗 Coordinator Sync', view: 'coordinator-sync', roles: ['coordinator'] }
        ]
    },
    org_admin: {
        label: 'Organization Tools',
        items: [
            { id: 'org-settings', label: '⚙️ Organization Settings', view: 'org-settings', roles: ['org_admin'] },
            { id: 'team', label: '👤 Team Management', view: 'team-management', roles: ['org_admin'] },
            { id: 'budget', label: '💵 Budget & Allocations', view: 'budget-allocations', roles: ['org_admin'] },
            { id: 'agent-config', label: '🤖 Agent Configuration', view: 'agent-configuration', roles: ['org_admin'] }
        ]
    },
    grant: {
        label: 'Grant Admin',
        items: [
            { id: 'grant-config', label: '📋 Grant Configuration', view: 'grant-configuration', roles: ['funder'] },
            { id: 'reporting', label: '📝 Reporting Settings', view: 'reporting-settings', roles: ['funder'] }
        ]
    }
};

// ========== DEMO DATA ==========
const DEMO_DATA = {
    agents: [
        { id: 'ag-1', name: 'Unite DFW Coordination Agent', type: 'Coordinator', status: 'active', tier: 'steward', chain: 'BASE', erc: 'ERC-8004', registeredDate: '2026-01-15', engagements: 23, org: 'Unite DFW', address: '0x7a3b...f82c', attestations: 47, completed: 23 },
        { id: 'ag-2', name: 'Workforce Analytics Agent', type: 'Analytics', status: 'active', tier: 'coordinator', chain: 'ETH', erc: 'ERC-8004', registeredDate: '2026-01-20', engagements: 18, org: 'Metro Workforce', address: '0x2f5d...8a1e', attestations: 34, completed: 18 },
        { id: 'ag-3', name: 'Grant Writing Agent', type: 'Content', status: 'active', tier: 'advisor', chain: 'LINEA', erc: 'ERC-8004', registeredDate: '2026-02-01', engagements: 12, org: 'Legal Aid', address: '0x9c2a...3b5f', attestations: 28, completed: 12 },
        { id: 'ag-4', name: 'Community Liaison Agent', type: 'Engagement', status: 'active', tier: 'observer', chain: 'BASE', erc: 'ERC-8004', registeredDate: '2026-02-05', engagements: 8, org: 'Hope House', address: '0x1d8f...c7e2', attestations: 15, completed: 8 },
        { id: 'ag-5', name: 'DFW Foundation Oversight', type: 'Oversight', status: 'suspended', tier: 'steward', chain: 'ETH', erc: 'ERC-8004', registeredDate: '2025-12-10', engagements: 31, org: 'DFW Foundation', address: '0x5e3c...9a4d', attestations: 52, completed: 31 }
    ],
    organizations: [
        { id: 'org-1', name: 'Metro Workforce Alliance', sector: 'Workforce', contact: 'Marcus Webb', status: 'active', programs: 3, budget: '$450K', verified: true, agents: 3, engagements: 12, tier: 'coordinator' },
        { id: 'org-2', name: 'Hope House', sector: 'Housing', contact: 'Amanda Foster', status: 'active', programs: 2, budget: '$280K', verified: true, agents: 2, engagements: 8, tier: 'advisor' },
        { id: 'org-3', name: 'Skills Bridge Academy', sector: 'Training', contact: 'Carlos Ramirez', status: 'active', programs: 2, budget: '$165K', verified: true, agents: 2, engagements: 6, tier: 'coordinator' },
        { id: 'org-4', name: 'Metro Housing Coalition', sector: 'Housing', contact: 'Jennifer Osei', status: 'active', programs: 1, budget: '$120K', verified: true, agents: 1, engagements: 4, tier: 'observer' },
        { id: 'org-5', name: 'DFW Youth Services', sector: 'Youth', contact: 'Carlos Ramirez', status: 'active', programs: 2, budget: '$190K', verified: true, agents: 2, engagements: 7, tier: 'advisor' },
        { id: 'org-6', name: 'Community Health Partners', sector: 'Health', contact: 'Dr. Lisa Wong', status: 'active', programs: 1, budget: '$95K', verified: false, agents: 1, engagements: 3, tier: 'observer' },
        { id: 'org-7', name: 'Rebuilding Together DFW', sector: 'Housing', contact: 'Amanda Foster', status: 'active', programs: 1, budget: '$145K', verified: true, agents: 1, engagements: 5, tier: 'advisor' },
        { id: 'org-8', name: 'North Texas Food Bank', sector: 'Food Security', contact: 'Michael Brooks', status: 'active', programs: 2, budget: '$210K', verified: true, agents: 2, engagements: 9, tier: 'coordinator' },
        { id: 'org-9', name: 'Legal Aid of NW Texas', sector: 'Legal Services', contact: 'Lisa Chen', status: 'active', programs: 1, budget: '$85K', verified: true, agents: 1, engagements: 4, tier: 'advisor' },
        { id: 'org-10', name: 'Goodwill Industries North Texas', sector: 'Employment', contact: 'Robert James', status: 'active', programs: 2, budget: '$175K', verified: true, agents: 2, engagements: 6, tier: 'coordinator' }
    ],
    contributors: [
        { id: 'c-1', name: 'Priya Patel', skills: ['Data Analysis', 'Research', 'Evaluation'], status: 'active', tier: 'advisor', initiatives: 2, role: 'Data Analyst', completed: 14, wallet: '0x3e4b...2c9f' },
        { id: 'c-2', name: 'James Washington', skills: ['Grant Writing', 'Research', 'Communications'], status: 'active', tier: 'coordinator', initiatives: 3, role: 'Grant Writer', completed: 22, wallet: '0x8d2a...5e1c' },
        { id: 'c-3', name: 'Maria Santos', skills: ['Community Outreach', 'Facilitation'], status: 'active', tier: 'observer', initiatives: 1, role: 'Community Liaison', completed: 7, wallet: '0x1f7c...9a3e' },
        { id: 'c-4', name: 'Arun Krishnamurthy', skills: ['Program Evaluation', 'Data Analysis'], status: 'active', tier: 'advisor', initiatives: 2, role: 'Program Evaluator', completed: 18, wallet: '0x4b8e...6d5a' },
        { id: 'c-5', name: 'Lisa Thompson', skills: ['Accounting', 'Compliance', 'Audit'], status: 'active', tier: 'coordinator', initiatives: 3, role: 'Nonprofit Accountant', completed: 26, wallet: '0x9f2d...1b8c' },
        { id: 'c-6', name: 'Derek Okafor', skills: ['Community Outreach', 'Program Design'], status: 'active', tier: 'observer', initiatives: 1, role: 'Community Organizer', completed: 5, wallet: '0x3a5f...7e4d' },
        { id: 'c-7', name: 'Sarah Kim', skills: ['UX Research', 'Design Thinking'], status: 'active', tier: 'advisor', initiatives: 2, role: 'UX Researcher', completed: 11, wallet: '0x6c9b...3f2e' },
        { id: 'c-8', name: 'Tom Rodriguez', skills: ['IT Infrastructure', 'Security'], status: 'active', tier: 'coordinator', initiatives: 2, role: 'IT Infrastructure', completed: 19, wallet: '0x2e7a...8c1f' }
    ],
    coordinators: [
        { id: 'coord-1', name: 'Sarah Chen', initiatives: 5, budget: '$453K', activeEngagements: 12, verified: true },
        { id: 'coord-2', name: 'Michael Brooks', initiatives: 2, budget: '$147K', activeEngagements: 6, verified: true },
        { id: 'coord-3', name: 'Jennifer Osei', initiatives: 3, budget: '$325K', activeEngagements: 8, verified: true },
        { id: 'coord-4', name: 'Carlos Ramirez', initiatives: 2, budget: '$263K', activeEngagements: 5, verified: true }
    ],
    opportunities: [
        { id: 'opp-1', name: 'Grant Writing for Housing Program', title: 'Grant Writing for Housing Program', initiative: 'Housing Stability Network', status: 'active', skills: ['Writing', 'Research'], deadline: '2026-03-15', org: 'Hope House', duration: '3 months', budget: '$8K-12K', match: 92 },
        { id: 'opp-2', name: 'Data Analysis for Workforce Program', title: 'Data Analysis for Workforce Program', initiative: 'Workforce Readiness 2026', status: 'active', skills: ['Analytics', 'SQL', 'Data Viz'], deadline: '2026-04-30', org: 'Metro Workforce', duration: '2 months', budget: '$6K-9K', match: 88 },
        { id: 'opp-3', name: 'Community Engagement Planning', title: 'Community Engagement Planning', initiative: 'Youth Pathways Program', status: 'open', skills: ['Facilitation', 'Planning'], deadline: '2026-03-31', org: 'DFW Youth Services', duration: '4 months', budget: '$10K-15K', match: 75 },
        { id: 'opp-4', name: 'Program Evaluation Framework', title: 'Program Evaluation Framework', initiative: 'Housing Stability Network', status: 'active', skills: ['Evaluation', 'Design'], deadline: '2026-04-15', org: 'Skills Bridge Academy', duration: '2 months', budget: '$7K-10K', match: 85 },
        { id: 'opp-5', name: 'Financial Audit Preparation', title: 'Financial Audit Preparation', initiative: 'Community Food Access', status: 'active', skills: ['Accounting', 'Compliance'], deadline: '2026-05-15', org: 'North Texas Food Bank', duration: '1 month', budget: '$5K-8K', match: 90 }
    ],
    initiatives: [
        { id: 'ini-1', name: 'Workforce Readiness 2026', status: 'active', lead: 'Sarah Chen', orgs: 5, contributors: 12, budget: '$145K', progress: 68, sector: 'Workforce', description: 'Cross-sector initiative to prepare 500 residents for high-demand jobs through coordinated training, mentorship, and placement services.', startDate: '2026-01-15', endDate: '2026-07-15', milestones: [{ name: 'Partner Onboarding', status: 'complete', date: '2026-01-30' }, { name: 'Curriculum Development', status: 'complete', date: '2026-02-15' }, { name: 'Cohort 1 Launch', status: 'active', date: '2026-03-01' }, { name: 'Mid-Program Evaluation', status: 'pending', date: '2026-04-15' }, { name: 'Cohort 2 Launch', status: 'pending', date: '2026-05-01' }, { name: 'Final Report', status: 'pending', date: '2026-07-15' }] },
        { id: 'ini-2', name: 'Housing Stability Network', status: 'active', lead: 'Jennifer Osei', orgs: 4, contributors: 8, budget: '$210K', progress: 42, sector: 'Housing', description: 'Coordinated approach to housing stability combining rapid rehousing, case management, and employment support.', startDate: '2026-02-01', endDate: '2026-08-31', milestones: [{ name: 'Needs Assessment', status: 'complete', date: '2026-02-15' }, { name: 'Service Mapping', status: 'active', date: '2026-03-01' }, { name: 'Pilot Launch', status: 'pending', date: '2026-04-01' }, { name: 'Scale to 3 Neighborhoods', status: 'pending', date: '2026-06-01' }] },
        { id: 'ini-3', name: 'Youth Pathways Program', status: 'active', lead: 'Carlos Ramirez', orgs: 3, contributors: 6, budget: '$98K', progress: 25, sector: 'Youth', description: 'Connecting at-risk youth aged 16-24 with education, employment, and mentorship opportunities across the DFW region.', startDate: '2026-02-10', endDate: '2026-09-30', milestones: [{ name: 'Youth Advisory Board', status: 'complete', date: '2026-02-20' }, { name: 'Mentor Matching', status: 'active', date: '2026-03-15' }, { name: 'First Cohort', status: 'pending', date: '2026-04-01' }] },
        { id: 'ini-4', name: 'Health Equity Data Hub', status: 'planning', lead: 'Sarah Chen', orgs: 2, contributors: 3, budget: '$75K', progress: 10, sector: 'Health', description: 'Shared data infrastructure for tracking health disparities and coordinating interventions across providers.', startDate: '2026-03-01', endDate: '2026-10-31', milestones: [{ name: 'Data Standards Agreement', status: 'active', date: '2026-03-15' }, { name: 'Platform Setup', status: 'pending', date: '2026-04-15' }] },
        { id: 'ini-5', name: 'Community Food Access', status: 'completed', lead: 'Michael Brooks', orgs: 4, contributors: 9, budget: '$62K', progress: 100, sector: 'Food Security', description: 'Mapped food deserts and coordinated mobile pantry routes with 6 food banks, serving 2,400 families monthly.', startDate: '2025-09-01', endDate: '2026-01-31', milestones: [{ name: 'Food Desert Mapping', status: 'complete', date: '2025-09-30' }, { name: 'Route Optimization', status: 'complete', date: '2025-11-15' }, { name: 'Full Deployment', status: 'complete', date: '2025-12-01' }, { name: 'Impact Report', status: 'complete', date: '2026-01-31' }] }
    ],
    users: [
        { id: 'u1', name: 'Elena Rodriguez', email: 'elena@unitedfw.org', role: 'admin', status: 'active', lastLogin: '2026-02-20 14:30', created: '2025-12-01' },
        { id: 'u2', name: 'Sarah Chen', email: 'sarah@unitedfw.org', role: 'coordinator', status: 'active', lastLogin: '2026-02-20 13:15', created: '2025-12-15' },
        { id: 'u3', name: 'Marcus Webb', email: 'marcus@metroworkforce.org', role: 'org_admin', status: 'active', lastLogin: '2026-02-20 11:00', created: '2026-01-05' },
        { id: 'u4', name: 'Priya Patel', email: 'priya@freelance.com', role: 'contributor', status: 'active', lastLogin: '2026-02-20 10:30', created: '2026-01-10' },
        { id: 'u5', name: 'David Park', email: 'david@dfwfoundation.org', role: 'funder', status: 'active', lastLogin: '2026-02-19 16:45', created: '2025-12-20' },
        { id: 'u6', name: 'Michael Brooks', email: 'michael@unitedfw.org', role: 'coordinator', status: 'active', lastLogin: '2026-02-20 09:00', created: '2025-12-15' },
        { id: 'u7', name: 'Jennifer Osei', email: 'jennifer@unitedfw.org', role: 'coordinator', status: 'active', lastLogin: '2026-02-19 14:20', created: '2026-01-01' },
        { id: 'u8', name: 'Carlos Ramirez', email: 'carlos@unitedfw.org', role: 'coordinator', status: 'active', lastLogin: '2026-02-20 12:30', created: '2026-01-01' },
        { id: 'u9', name: 'Amanda Foster', email: 'amanda@hopehouse.org', role: 'org_admin', status: 'active', lastLogin: '2026-02-18 09:15', created: '2026-01-20' },
        { id: 'u10', name: 'Derek Okafor', email: 'derek@community.org', role: 'contributor', status: 'pending', lastLogin: 'Never', created: '2026-02-18' }
    ],
    auditLog: [
        { ts: '2026-02-20 14:32:45', event: 'Agent Registered', actor: 'Grant Writing Agent', detail: 'New agent registered on BASE chain', severity: 'info' },
        { ts: '2026-02-20 14:15:22', event: 'Initiative Updated', actor: 'Sarah Chen', detail: 'Workforce Readiness 2026 - milestone completed', severity: 'info' },
        { ts: '2026-02-20 13:58:12', event: 'Trust Tier Change', actor: 'Priya Patel', detail: 'Upgraded from Observer to Advisor', severity: 'success' },
        { ts: '2026-02-20 13:28:00', event: 'Engagement Completed', actor: 'Hope House / Priya Patel', detail: 'Program Evaluation verified on-chain', severity: 'success' },
        { ts: '2026-02-20 12:45:33', event: 'Session Started', actor: 'Sarah Chen', detail: 'Coordinator session with 2h session key', severity: 'info' },
        { ts: '2026-02-20 11:12:00', event: 'Budget Alert', actor: 'Metro Workforce', detail: '80% of Q1 budget utilized', severity: 'warning' },
        { ts: '2026-02-20 10:30:15', event: 'Agent Suspended', actor: 'Admin: Elena', detail: 'Community Analytics Agent - policy violation', severity: 'danger' },
        { ts: '2026-02-20 09:28:17', event: 'New User Registered', actor: 'Derek Okafor', detail: 'Contributor - pending verification', severity: 'info' },
        { ts: '2026-02-20 08:00:00', event: 'System Backup', actor: 'System', detail: 'Daily backup completed successfully', severity: 'info' },
        { ts: '2026-02-19 17:45:00', event: 'Grant Disbursed', actor: 'DFW Foundation', detail: '$25,000 to Metro Workforce via escrow', severity: 'success' }
    ],
    onboardingSteps: {
        admin: ['Welcome', 'System Overview', 'Protocol Configuration', 'User Management Basics', 'Ready'],
        coordinator: ['Welcome', 'Your Coalition', 'Matching & Coordination', 'Agent Oversight', 'Ready'],
        org_admin: ['Welcome', 'Organization Profile', 'Team Setup', 'Post Your First Need', 'Ready'],
        contributor: ['Welcome', 'Build Your Profile', 'Verify Skills', 'Browse Opportunities', 'Ready'],
        funder: ['Welcome', 'Portfolio Setup', 'Grant Configuration', 'Outcome Tracking', 'Ready']
    }
};

// ========== HELPER FUNCTIONS ==========
function getTierBadge(tier) {
    const t = (tier || '').toLowerCase();
    const tiers = {
        'observer': 'badge-observer',
        'advisor': 'badge-advisor',
        'coordinator': 'badge-coordinator',
        'steward': 'badge-steward',
        'verified': 'badge-coordinator',
        'trusted': 'badge-steward'
    };
    const labels = {
        'observer': 'Observer',
        'advisor': 'Advisor',
        'coordinator': 'Coordinator',
        'steward': 'Steward',
        'verified': 'Verified',
        'trusted': 'Trusted'
    };
    return `<span class="badge ${tiers[t] || ''}">${labels[t] || tier}</span>`;
}

function getChainBadge(chain) {
    const classes = {
        'BASE': 'badge-base',
        'ETH': 'badge-eth',
        'LINEA': 'badge-linea',
        'ETHEREUM': 'badge-eth',
        'ARBITRUM': 'badge-eth'
    };
    return `<span class="badge ${classes[chain] || ''}">${chain}</span>`;
}

function getStatusBadge(status) {
    const map = {
        'active': '<span class="badge badge-active" style="background:#28A745;color:white;">Active</span>',
        'planning': '<span class="badge badge-pending" style="background:#FFC107;color:black;">Planning</span>',
        'completed': '<span class="badge" style="background:#17A2B8;color:white;">Completed</span>',
        'paused': '<span class="badge" style="background:#f0f0f0;color:#666;">Paused</span>',
        'pending': '<span class="badge badge-pending" style="background:#FFC107;color:black;">Pending</span>',
        'suspended': '<span class="badge" style="background:#DC3545;color:white;">Suspended</span>'
    };
    return map[status] || status;
}

function getSeverityIcon(severity) {
    const map = { info: 'ℹ️', success: '✓', warning: '⚠️', danger: '🚫' };
    return map[severity] || '';
}

function formatDate(dateStr) {
    const date = new Date(dateStr);
    return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
}

// ========== MODAL FUNCTIONS ==========
function showModal(title, content, footer) {
    document.getElementById('modal-title').textContent = title;
    document.getElementById('modal-body').innerHTML = content;
    document.getElementById('modal-footer').innerHTML = footer || '';
    document.getElementById('modal-overlay').classList.add('open');
}

function closeModal() {
    document.getElementById('modal-overlay').classList.remove('open');
}

function showToast(message, type = 'success') {
    const container = document.getElementById('toast-container');
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.textContent = message;
    container.appendChild(toast);

    setTimeout(() => {
        toast.style.animation = 'slideOutRight 0.3s ease';
        setTimeout(() => toast.remove(), 300);
    }, 3000);
}

// ========== NAVIGATION BUILDER ==========
function buildNavigation() {
    const sidebar = document.getElementById('sidebar');
    sidebar.querySelectorAll('.sidebar-section-dynamic').forEach(el => el.remove());

    const mainSidebar = document.getElementById('sidebar-main');
    const toolsSidebar = document.getElementById('sidebar-tools');

    mainSidebar.innerHTML = '<div class="sidebar-section-title">Main</div>';
    toolsSidebar.innerHTML = '';

    const role = ROLES[APP_STATE.currentRole];

    // Build Main section
    const mainItems = NAV_ITEMS.main.items.filter(item => !item.roles || item.roles.includes(APP_STATE.currentRole));
    mainItems.forEach(item => {
        const navItem = document.createElement('div');
        navItem.className = `sidebar-item ${item.view === APP_STATE.currentView ? 'active' : ''}`;
        navItem.textContent = item.label;
        navItem.setAttribute('data-view', item.view);
        navItem.addEventListener('click', () => switchToView(item.view, item.label));
        mainSidebar.appendChild(navItem);
    });

    // Build Initiatives section (NEW - for ALL roles)
    if (role.navSections.includes('initiatives')) {
        const initSection = document.createElement('div');
        initSection.className = 'sidebar-section sidebar-section-dynamic';
        initSection.innerHTML = '<div class="sidebar-section-title">Initiatives</div>';
        NAV_ITEMS.initiatives.items
            .filter(item => !item.roles || item.roles.includes(APP_STATE.currentRole))
            .forEach(item => {
                const navItem = document.createElement('div');
                navItem.className = `sidebar-item ${item.view === APP_STATE.currentView ? 'active' : ''}`;
                navItem.textContent = item.label;
                navItem.setAttribute('data-view', item.view);
                navItem.addEventListener('click', () => switchToView(item.view, item.label));
                initSection.appendChild(navItem);
            });
        sidebar.insertBefore(initSection, toolsSidebar);
    }

    // Build role-specific tool sections
    const toolSections = ['admin', 'coordination', 'org_admin', 'grant'];
    toolSections.forEach(sectionKey => {
        if (role.navSections.includes(sectionKey) && NAV_ITEMS[sectionKey]) {
            const section = document.createElement('div');
            section.className = 'sidebar-section sidebar-section-dynamic';
            section.innerHTML = `<div class="sidebar-section-title">${NAV_ITEMS[sectionKey].label}</div>`;
            NAV_ITEMS[sectionKey].items
                .filter(item => !item.roles || item.roles.includes(APP_STATE.currentRole))
                .forEach(item => {
                    const navItem = document.createElement('div');
                    navItem.className = `sidebar-item ${item.view === APP_STATE.currentView ? 'active' : ''}`;
                    navItem.textContent = item.label;
                    navItem.setAttribute('data-view', item.view);
                    navItem.addEventListener('click', () => switchToView(item.view, item.label));
                    section.appendChild(navItem);
                });
            sidebar.appendChild(section);
        }
    });
}

// ========== VIEW SWITCHING ==========
function switchToView(viewId, title = '') {
    APP_STATE.currentView = viewId;
    document.getElementById('header-title').textContent = title || viewId.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());

    document.querySelectorAll('.view').forEach(v => v.remove());

    createView(viewId);
    const viewElement = document.getElementById(`view-${viewId}`);
    if (viewElement) viewElement.classList.add('active');

    document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
    document.querySelectorAll(`[data-view="${viewId}"]`).forEach(item => item.classList.add('active'));
}

// ========== VIEW CREATION DISPATCHER (UNIFIED) ==========
function createView(viewId) {
    const role = APP_STATE.currentRole;
    const main = document.getElementById('main-content');

    // Part 1 views (DOM-append pattern: render(role, parent))
    switch(viewId) {
        case 'dashboard':
            return renderDashboard(role, main);
        case 'agent-registry':
            return renderAgentRegistry(role, main);
        case 'trust-trail':
            return renderTrustTrail(role, main);
        case 'initiative-dashboard':
            return renderInitiativeDashboard(role, main);
        case 'active-initiatives':
            return renderActiveInitiatives(role, main);
        case 'create-initiative':
            return renderCreateInitiative(role, main);
        case 'my-initiatives':
            return renderMyInitiatives(role, main);
        case 'initiative-matching':
            return renderInitiativeMatching(role, main);
        case 'coordinator-board':
            return renderCoordinatorBoard(role, main);
    }

    // Part 2 views (HTML-return pattern: render(role) → string)
    let html = '';
    switch(viewId) {
        case 'coordination-hub': html = renderCoordinationHub(role); break;
        case 'opportunities': html = renderOpportunities(role); break;
        case 'my-engagements': html = renderMyEngagements(role); break;
        case 'my-reputation': html = renderMyReputation(role); break;
        case 'wallet': html = renderWallet(role); break;
        case 'ecosystem-map': html = renderEcosystemMap(role); break;
        case 'analytics': html = renderAnalytics(role); break;
        case 'portfolio-overview': html = renderPortfolioOverview(role); break;
        case 'outcome-verification': html = renderOutcomeVerification(role); break;
        case 'compliance': html = renderCompliance(role); break;
        case 'system-settings': html = renderSystemSettings(role); break;
        case 'protocol-config': html = renderProtocolConfig(role); break;
        case 'agent-approvals': html = renderAgentApprovals(role); break;
        case 'coalition-settings': html = renderCoalitionSettings(role); break;
        case 'member-organizations': html = renderMemberOrganizations(role); break;
        case 'coordinator-sync': html = renderCoordinatorSync(role); break;
        case 'org-settings': html = renderOrgSettings(role); break;
        case 'team-management': html = renderTeamManagement(role); break;
        case 'budget-allocations': html = renderBudgetAllocations(role); break;
        case 'agent-configuration': html = renderAgentConfiguration(role); break;
        case 'grant-configuration': html = renderGrantConfiguration(role); break;
        case 'user-management': html = renderUserManagement(role); break;
        case 'audit-log': html = renderAuditLog(role); break;
        case 'reporting-settings': html = renderReportingSettings(role); break;
        default:
            html = '<div class="card"><p>View not found: ' + viewId + '</p></div>';
    }

    const view = document.createElement('div');
    view.className = 'view';
    view.id = 'view-' + viewId;
    view.innerHTML = html;
    main.appendChild(view);
}

// ========== DASHBOARD VIEWS (ROLE-SPECIFIC) ==========
function renderDashboard(role, parent) {
    const view = document.createElement('div');
    view.className = 'view';
    view.id = 'view-dashboard';
    const roleData = ROLES[role];

    let header = `
        <div class="content-header">
            <h1>Welcome back, ${roleData.name}</h1>
            <p>${roleData.title} • ${roleData.email}</p>
        </div>
    `;

    let body = '';
    switch(role) {
        case 'admin': body = renderAdminDashboard(); break;
        case 'coordinator': body = renderCoordinatorDashboard(); break;
        case 'org_admin': body = renderOrgAdminDashboard(); break;
        case 'contributor': body = renderContributorDashboard(); break;
        case 'funder': body = renderFunderDashboard(); break;
        default: body = '<div class="card"><p>Dashboard not available for this role.</p></div>';
    }

    view.innerHTML = header + body;
    parent.appendChild(view);
}

function renderAdminDashboard() {
    return `
        <div class="stat-grid">
            <div class="stat-card">
                <div class="stat-label">Total Agents</div>
                <div class="stat-value">${DEMO_DATA.agents.length}</div>
                <div class="stat-subtext">↑ ${DEMO_DATA.agents.filter(a => a.status === 'active').length} active</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Active Sessions</div>
                <div class="stat-value">23</div>
                <div class="stat-subtext">↑ 5 from yesterday</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Trust Events (24h)</div>
                <div class="stat-value">156</div>
                <div class="stat-subtext">↑ 12% vs avg</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Protocol Uptime</div>
                <div class="stat-value">99.97%</div>
                <div class="stat-subtext">No incidents</div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3>System Alerts</h3>
                <div class="card-header-actions">
                    <button class="btn btn-sm btn-secondary">Dismiss All</button>
                </div>
            </div>
            <div class="alert alert-warning">⚠️ 4 agents pending registration approval (avg review time: 2.3 hours)</div>
            <div class="alert alert-info">ℹ️ Trust threshold breach detected: 1 agent below minimum tier requirements</div>
            <div class="alert alert-success">✓ All smart contracts operating normally on BASE, ETH, LINEA</div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3>Recent System Events</h3>
            </div>
            <table class="table">
                <thead>
                    <tr><th>Timestamp</th><th>Event Type</th><th>Agent / User</th><th>Status</th></tr>
                </thead>
                <tbody>
                    ${DEMO_DATA.auditLog.slice(0, 5).map(log => `
                        <tr>
                            <td>${log.ts}</td>
                            <td>${log.event}</td>
                            <td>${log.actor}</td>
                            <td>${getStatusBadge(log.severity === 'success' ? 'active' : log.severity === 'warning' ? 'pending' : 'active')}</td>
                        </tr>
                    `).join('')}
                </tbody>
            </table>
        </div>

        <div class="grid-2">
            <div class="card">
                <div class="card-header"><h3>Quick Actions</h3></div>
                <button class="btn btn-primary" style="width:100%;margin-bottom:10px;" onclick="switchToView('agent-approvals','✋ Agent Approvals')">Review Pending Approvals</button>
                <button class="btn btn-secondary" style="width:100%;margin-bottom:10px;" onclick="switchToView('audit-log','📋 Audit Log')">View Audit Log</button>
                <button class="btn btn-secondary" style="width:100%;">Export System Report</button>
            </div>
            <div class="card">
                <div class="card-header"><h3>System Health</h3></div>
                <p><strong>Smart Contracts:</strong> ✓ All deployed</p>
                <p><strong>RPC Endpoints:</strong> ✓ All responding</p>
                <p><strong>Data Integrity:</strong> ✓ No issues</p>
                <p><strong>Trust Registry:</strong> ✓ Synced across ${DEMO_DATA.organizations.length} orgs</p>
            </div>
        </div>
    `;
}

function renderCoordinatorDashboard() {
    return `
        <div class="stat-grid">
            <div class="stat-card">
                <div class="stat-label">Active Needs</div>
                <div class="stat-value">23</div>
                <div class="stat-subtext">↑ 5 this week</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Pending Matches</div>
                <div class="stat-value">12</div>
                <div class="stat-subtext">Awaiting confirmation</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Agents Online</div>
                <div class="stat-value">${DEMO_DATA.agents.filter(a => a.status === 'active').length}</div>
                <div class="stat-subtext">100% of active</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Trust Events Today</div>
                <div class="stat-value">156</div>
                <div class="stat-subtext">↑ 12% vs yesterday</div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><h3>Active Coordination Requests</h3></div>
            <div class="grid-3">
                <div class="opportunity-card" onclick="showModal('Coordination Request', 'Workforce Skills Training Program<br><br>Requesting Org: Metro Workforce Alliance<br>Estimated Budget: $45K<br>Duration: 6 months<br>Priority: High<br><br><button class=\\'btn btn-primary\\'>Approve & Match</button>')">
                    <div class="opportunity-header">
                        <h4>Workforce Skills Training</h4>
                        <span class="match-indicator">8 matches</span>
                    </div>
                    <p class="text-sm text-muted">Metro Workforce Alliance</p>
                    <p class="text-sm">Seeking data analysts, grant writers, evaluators</p>
                </div>
                <div class="opportunity-card" onclick="showModal('Coordination Request', 'Housing Support Program<br><br>Requesting Org: Hope House<br>Budget: $32K<br>Duration: 4 months<br><br><button class=\\'btn btn-primary\\'>Approve & Match</button>')">
                    <div class="opportunity-header">
                        <h4>Housing Support Program</h4>
                        <span class="match-indicator">5 matches</span>
                    </div>
                    <p class="text-sm text-muted">Hope House</p>
                    <p class="text-sm">Community liaisons, program managers</p>
                </div>
                <div class="opportunity-card" onclick="showModal('Coordination Request', 'Youth Development Initiative<br><br>Requesting Org: DFW Youth Services<br>Budget: $55K<br>Duration: 8 months<br><br><button class=\\'btn btn-primary\\'>Approve & Match</button>')">
                    <div class="opportunity-header">
                        <h4>Youth Development Initiative</h4>
                        <span class="match-indicator">6 matches</span>
                    </div>
                    <p class="text-sm text-muted">DFW Youth Services</p>
                    <p class="text-sm">Facilitators, curriculum designers</p>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><h3>Agent Activity Feed</h3></div>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-dot" style="background-color: #28A745;"></div>
                    <div class="timeline-content">
                        <h5>Priya Patel completed engagement</h5>
                        <p>Hope House Program Evaluation — Verified on-chain via EAS</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot" style="background-color: #F57C00;"></div>
                    <div class="timeline-content">
                        <h5>James Washington proposed engagement</h5>
                        <p>Metro Workforce Grant Writing — Pending org approval</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot" style="background-color: #2B5797;"></div>
                    <div class="timeline-content">
                        <h5>New agent registered</h5>
                        <p>Community Liaison Agent — Awaiting coordinator approval</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot" style="background-color: #7B1FA2;"></div>
                    <div class="timeline-content">
                        <h5>Trust tier upgrade</h5>
                        <p>Priya Patel: Observer → Advisor (auto-promoted after 10 verified engagements)</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><h3>Coordinator Sync Alerts</h3></div>
            <div class="alert alert-info">ℹ️ Michael Brooks is engaging "Priya Patel" on Workforce Program (overlap risk)</div>
            <div class="alert alert-success">✓ ${DEMO_DATA.coordinators.length} active coordinators currently online</div>
        </div>
    `;
}

function renderOrgAdminDashboard() {
    return `
        <div class="stat-grid">
            <div class="stat-card">
                <div class="stat-label">Open Needs</div>
                <div class="stat-value">4</div>
                <div class="stat-subtext">2 actively recruiting</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Active Engagements</div>
                <div class="stat-value">7</div>
                <div class="stat-subtext">In progress</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Team Members</div>
                <div class="stat-value">12</div>
                <div class="stat-subtext">4 coordinators</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Org Trust Tier</div>
                <div class="stat-value">Coordinator</div>
                <div class="stat-subtext">95% compliance</div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><h3>Budget Utilization</h3></div>
            <p style="margin-bottom:12px;"><strong>$18,000 of $25,000 allocated</strong></p>
            <div class="progress-bar">
                <div class="progress-fill" style="width:72%"></div>
            </div>
            <p style="margin-top:12px;font-size:12px;color:#666;">$7,000 remaining • 72% utilized</p>
        </div>

        <div class="card">
            <div class="card-header"><h3>Active Engagements</h3></div>
            <table class="table">
                <thead>
                    <tr><th>Contributor</th><th>Scope</th><th>Status</th><th>Progress</th></tr>
                </thead>
                <tbody>
                    <tr><td>Priya Patel</td><td>Program Evaluation</td><td><span class="badge badge-active" style="background:#28A745;color:white;">In Progress</span></td><td>75%</td></tr>
                    <tr><td>James Washington</td><td>Grant Writing</td><td><span class="badge badge-active" style="background:#28A745;color:white;">In Progress</span></td><td>50%</td></tr>
                    <tr><td>Lisa Thompson</td><td>Financial Audit</td><td><span class="badge badge-active" style="background:#28A745;color:white;">In Progress</span></td><td>60%</td></tr>
                </tbody>
            </table>
        </div>

        <div class="grid-2">
            <div class="card">
                <div class="card-header"><h3>Pending Approvals</h3></div>
                <p style="margin-bottom:12px;">2 matches awaiting org sign-off</p>
                <button class="btn btn-primary" style="width:100%;">Review Matches</button>
            </div>
            <div class="card">
                <div class="card-header"><h3>Quick Actions</h3></div>
                <button class="btn btn-primary" style="width:100%;margin-bottom:10px;">Post New Need</button>
                <button class="btn btn-secondary" style="width:100%;" onclick="switchToView('team-management','👥 Team Management')">Manage Team</button>
            </div>
        </div>
    `;
}

function renderContributorDashboard() {
    return `
        <div class="stat-grid">
            <div class="stat-card">
                <div class="stat-label">Available Opportunities</div>
                <div class="stat-value">${DEMO_DATA.opportunities.length}</div>
                <div class="stat-subtext">Matching your skills</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Active Engagements</div>
                <div class="stat-value">2</div>
                <div class="stat-subtext">In progress</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Completed</div>
                <div class="stat-value">14</div>
                <div class="stat-subtext">With attestations</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Reputation Tier</div>
                <div class="stat-value">Advisor</div>
                <div class="stat-subtext">↑ from Observer</div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3>Recommended Opportunities</h3>
                <div class="card-header-actions">
                    <button class="btn btn-sm btn-secondary" onclick="switchToView('opportunities','🎯 Opportunities')">View All →</button>
                </div>
            </div>
            <div class="grid-3">
                ${DEMO_DATA.opportunities.sort((a,b) => (b.match||0) - (a.match||0)).slice(0, 3).map(opp => `
                    <div class="opportunity-card" onclick="showModal('Opportunity Details', '${opp.title || opp.name}<br>${opp.org || ''}<br>${opp.duration || ''} | ${opp.budget || ''}<br><br>Match: ${opp.match}%<br><br>Skills: ${opp.skills.join(', ')}<br><br><button class=\\'btn btn-success\\' onclick=\\'closeModal(); showToast(&quot;Application submitted!&quot;)\\'>Apply Now</button>')">
                        <div class="opportunity-header">
                            <h4>${(opp.title || opp.name).split(' ').slice(0,3).join(' ')}</h4>
                            <span class="match-indicator">${opp.match}% Match</span>
                        </div>
                        <p class="text-sm text-muted">${opp.org || ''}</p>
                        <div class="opportunity-details">
                            <span class="opportunity-detail-item">📅 ${opp.duration || ''}</span>
                            <span class="opportunity-detail-item">💰 ${opp.budget || ''}</span>
                        </div>
                    </div>
                `).join('')}
            </div>
        </div>

        <div class="card">
            <div class="card-header"><h3>Active Engagements</h3></div>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-dot" style="background-color: #28A745;"></div>
                    <div class="timeline-content">
                        <h5>Hope House — Program Evaluation (75% complete)</h5>
                        <p>Started Jan 15 | Expected completion: Mar 15</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot" style="background-color: #2B5797;"></div>
                    <div class="timeline-content">
                        <h5>Metro Workforce — Data Analysis (40% complete)</h5>
                        <p>Started Feb 1 | Expected completion: Apr 1</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><h3>Recent Attestations</h3></div>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-dot" style="background-color: #7B1FA2;"></div>
                    <div class="timeline-content">
                        <h5>Competency Verified: Data Analysis</h5>
                        <p>Attested by Metro Workforce Alliance via EAS — Feb 18, 2026</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot" style="background-color: #7B1FA2;"></div>
                    <div class="timeline-content">
                        <h5>Completion Verified: Community Needs Assessment</h5>
                        <p>Attested by Hope House via EAS — Feb 15, 2026</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot" style="background-color: #28A745;"></div>
                    <div class="timeline-content">
                        <h5>Tier Upgrade: Observer → Advisor</h5>
                        <p>Auto-promoted after 10 verified engagements — Feb 10, 2026</p>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function renderFunderDashboard() {
    return `
        <div class="stat-grid">
            <div class="stat-card">
                <div class="stat-label">Active Grants</div>
                <div class="stat-value">12</div>
                <div class="stat-subtext">5 completing this Q</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Organizations Funded</div>
                <div class="stat-value">28</div>
                <div class="stat-subtext">Across 6 sectors</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Allocated</div>
                <div class="stat-value">$2.4M</div>
                <div class="stat-subtext">↑ 18% YoY</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Outcomes Verified</div>
                <div class="stat-value">89%</div>
                <div class="stat-subtext">↑ from 84% (on-chain via EAS)</div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><h3>Grant Performance by Sector</h3></div>
            <table class="table">
                <thead>
                    <tr><th>Sector</th><th>Active Grants</th><th>Total Allocated</th><th>Outcomes %</th></tr>
                </thead>
                <tbody>
                    <tr><td>Workforce Development</td><td>4</td><td>$580K</td><td>92%</td></tr>
                    <tr><td>Housing & Homelessness</td><td>3</td><td>$750K</td><td>88%</td></tr>
                    <tr><td>Youth Services</td><td>2</td><td>$380K</td><td>85%</td></tr>
                    <tr><td>Health Equity</td><td>2</td><td>$410K</td><td>91%</td></tr>
                    <tr><td>Food Security</td><td>1</td><td>$280K</td><td>87%</td></tr>
                </tbody>
            </table>
        </div>

        <div class="card">
            <div class="card-header"><h3>Pending Outcome Verifications</h3></div>
            <p style="margin-bottom:12px;"><strong>3 attestations awaiting review</strong></p>
            <button class="btn btn-primary" onclick="switchToView('outcome-verification','✅ Outcome Verification')">Review Verifications</button>
        </div>

        <div class="grid-2">
            <div class="card">
                <div class="card-header"><h3>Compliance Status</h3></div>
                <p><strong>On-Time Reports:</strong> 26/28 (93%)</p>
                <p><strong>Audit Ready:</strong> 25/28 (89%)</p>
                <p><strong>Grant Conditions Met:</strong> 27/28 (96%)</p>
            </div>
            <div class="card">
                <div class="card-header"><h3>Quick Actions</h3></div>
                <button class="btn btn-primary" style="width:100%;margin-bottom:10px;" onclick="switchToView('portfolio-overview','💰 Portfolio Overview')">Review Portfolio</button>
                <button class="btn btn-secondary" style="width:100%;">Generate Report</button>
            </div>
        </div>
    `;
}

// ========== AGENT REGISTRY VIEW (VISUAL CARDS) ==========
function renderAgentRegistry(role, parent) {
    const view = document.createElement('div');
    view.className = 'view';
    view.id = 'view-agent-registry';

    let html = `
        <div class="content-header">
            <h1>Agent Registry</h1>
            <p>Manage autonomous agents across the coalition — ERC-8004 compliant</p>
        </div>

        <div style="display:flex;gap:10px;margin-bottom:20px;">
            <input type="text" id="agent-search" placeholder="Search agents..." class="input" style="flex:1;">
            <select id="agent-filter" class="input" style="width:150px;">
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="suspended">Suspended</option>
            </select>
            ${role === 'admin' ? '<button class="btn btn-primary" onclick="showAddAgentModal()">+ Register Agent</button>' : ''}
        </div>

        <div style="display:grid;grid-template-columns:1fr;gap:12px;">
    `;

    DEMO_DATA.agents.forEach(agent => {
        html += `
            <div class="agent-card" onclick="showAgentModal('${agent.id}')">
                <div class="agent-card-header">
                    <div class="agent-avatar">${agent.name.charAt(0)}</div>
                    <div class="agent-info">
                        <h4>${agent.name}</h4>
                        <p>${agent.type}${agent.org ? ' | ' + agent.org : ''}</p>
                    </div>
                    <div style="margin-left:auto;">
                        ${getStatusBadge(agent.status)}
                    </div>
                </div>
                <div class="agent-card-badges">
                    ${getTierBadge(agent.tier)}
                    ${getChainBadge(agent.chain)}
                    <span class="badge" style="background-color:#f0f0f0;color:#333;">✓ ${agent.attestations || 0} attestations</span>
                    <span class="badge" style="background-color:#f0f0f0;color:#333;">🤝 ${agent.engagements} engagements</span>
                    ${agent.address ? `<span class="badge" style="background-color:#f8f8f8;color:#999;font-family:monospace;font-size:10px;">${agent.address}</span>` : ''}
                </div>
                ${role === 'admin' ? `<div style="margin-top:10px;text-align:right;"><button class="btn btn-sm btn-warning" onclick="event.stopPropagation();toggleAgentStatus('${agent.id}')">Toggle Status</button></div>` : ''}
            </div>
        `;
    });

    html += `
        </div>
    `;

    view.innerHTML = html;
    parent.appendChild(view);
}

function showAgentModal(agentId) {
    const agent = DEMO_DATA.agents.find(a => a.id === agentId);
    if (!agent) return;

    const content = `
        <div style="display:flex;gap:20px;margin-bottom:20px;">
            <div class="agent-avatar" style="width:80px;height:80px;font-size:32px;">${agent.name.charAt(0)}</div>
            <div>
                <h3 style="margin:0 0 4px 0;">${agent.name}</h3>
                <p style="margin:0 0 8px 0;color:#666;">${agent.type}${agent.org ? ' | ' + agent.org : ''}</p>
                ${agent.address ? `<p style="margin:0;font-size:12px;color:#999;">ERC-8004 Address: ${agent.address}</p>` : ''}
            </div>
        </div>
        <div style="line-height:1.8;">
            <p><strong>Status:</strong> ${getStatusBadge(agent.status)}</p>
            <p><strong>Trust Tier:</strong> ${getTierBadge(agent.tier)}</p>
            <p><strong>Chain:</strong> ${getChainBadge(agent.chain)}</p>
            <p><strong>ERC Standard:</strong> ${agent.erc}</p>
            <p><strong>Registered:</strong> ${formatDate(agent.registeredDate)}</p>
            <p><strong>Engagements:</strong> ${agent.engagements}</p>
            ${agent.attestations ? `<p><strong>Attestations:</strong> ${agent.attestations} verified</p>` : ''}
            ${agent.completed ? `<p><strong>Completed:</strong> ${agent.completed} tasks</p>` : ''}
            <p style="margin-top:20px;"><strong>Description:</strong></p>
            <p>This is a ${agent.type} agent with ${agent.tier} tier access. It has successfully completed ${agent.engagements} engagements across the coalition network.</p>
        </div>
    `;

    showModal(`Agent: ${agent.name}`, content);
}

function showAddAgentModal() {
    const content = `
        <div style="line-height:1.8;">
            <div style="margin-bottom:15px;">
                <label><strong>Agent Name</strong></label>
                <input type="text" class="input" placeholder="e.g., Grant Writing Agent" style="width:100%;margin-top:5px;">
            </div>
            <div style="margin-bottom:15px;">
                <label><strong>Agent Type</strong></label>
                <select class="input" style="width:100%;margin-top:5px;">
                    <option>Writing Assistant</option>
                    <option>Matcher</option>
                    <option>Analytics</option>
                    <option>Data Pipeline</option>
                    <option>Communication</option>
                </select>
            </div>
            <div style="margin-bottom:15px;">
                <label><strong>Chain</strong></label>
                <select class="input" style="width:100%;margin-top:5px;">
                    <option>BASE</option>
                    <option>ETHEREUM</option>
                    <option>ARBITRUM</option>
                </select>
            </div>
            <div style="margin-bottom:15px;">
                <label><strong>Initial Trust Tier</strong></label>
                <select class="input" style="width:100%;margin-top:5px;">
                    <option>Observer</option>
                    <option>Verified</option>
                </select>
            </div>
            <div style="margin-bottom:15px;">
                <label><strong>Description</strong></label>
                <textarea class="input" rows="3" placeholder="Describe the agent's purpose..." style="width:100%;margin-top:5px;"></textarea>
            </div>
        </div>
    `;
    const footer = `
        <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
        <button class="btn btn-primary" onclick="showToast('Agent registered on BASE via ERC-8004','success'); closeModal();">Register Agent</button>
    `;
    showModal('Register New Agent', content, footer);
}

function toggleAgentStatus(agentId) {
    const agent = DEMO_DATA.agents.find(a => a.id === agentId);
    if (agent) {
        agent.status = agent.status === 'active' ? 'suspended' : 'active';
        switchToView('agent-registry', '🤖 Agent Registry');
        showToast(`Agent ${agent.status === 'active' ? 'reactivated' : 'suspended'}`, 'success');
    }
}

// ========== TRUST TRAIL VIEW ==========
function renderTrustTrail(role, parent) {
    const view = document.createElement('div');
    view.className = 'view';
    view.id = `view-trust-trail`;

    let html = `
        <div class="content-header">
            <h1>Trust Trail</h1>
            <p>Verifiable audit log of all system actions and verifications</p>
        </div>

        <div style="display:flex;gap:10px;margin-bottom:20px;">
            <select id="trail-filter" class="input" style="flex:1;">
                <option value="">All Events</option>
                <option value="Agent Registered">Agent Registered</option>
                <option value="Initiative Updated">Initiative Updated</option>
                <option value="Trust Tier Change">Trust Tier Change</option>
                <option value="Engagement Completed">Engagement Completed</option>
            </select>
        </div>

        <div class="audit-timeline">
    `;

    DEMO_DATA.auditLog.forEach((log, idx) => {
        const icon = getSeverityIcon(log.severity);
        const colorMap = { info: '#007BFF', success: '#28A745', warning: '#FFC107', danger: '#DC3545' };
        const color = colorMap[log.severity] || '#666';

        html += `
            <div class="timeline-item" style="border-left-color:${color};">
                <div class="timeline-dot" style="background:${color};">${icon}</div>
                <div class="timeline-content">
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <h4>${log.event}</h4>
                        <span style="font-size:0.85em;color:#999;">${log.ts}</span>
                    </div>
                    <p><strong>Actor:</strong> ${log.actor}</p>
                    <p><strong>Detail:</strong> ${log.detail}</p>
                </div>
            </div>
        `;
    });

    html += `
        </div>
    `;

    view.innerHTML = html;
    parent.appendChild(view);
}

// ========== INITIATIVE DASHBOARD ==========
function renderInitiativeDashboard(role, parent) {
    const view = document.createElement('div');
    view.className = 'view';
    view.id = `view-initiative-dashboard`;

    const active = DEMO_DATA.initiatives.filter(i => i.status === 'active').length;
    const planning = DEMO_DATA.initiatives.filter(i => i.status === 'planning').length;
    const completed = DEMO_DATA.initiatives.filter(i => i.status === 'completed').length;

    let html = `
        <div class="content-header">
            <h1>Initiative Dashboard</h1>
            <p>Coalition-wide initiative overview and metrics</p>
        </div>

        <div class="dashboard-grid">
            <div class="stat-card">
                <div class="stat-value">${DEMO_DATA.initiatives.length}</div>
                <div class="stat-label">Total Initiatives</div>
                <div class="stat-detail">All time</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${active}</div>
                <div class="stat-label">Active Now</div>
                <div class="stat-detail">In progress</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${planning}</div>
                <div class="stat-label">In Planning</div>
                <div class="stat-detail">Preparation phase</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${completed}</div>
                <div class="stat-label">Completed</div>
                <div class="stat-detail">Successfully delivered</div>
            </div>
        </div>

        <div class="section-header" style="margin-top:40px;">
            <h2>Sector Breakdown</h2>
        </div>

        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-top:20px;">
    `;

    const sectors = {};
    DEMO_DATA.initiatives.forEach(i => {
        sectors[i.sector] = (sectors[i.sector] || 0) + 1;
    });

    Object.entries(sectors).forEach(([sector, count]) => {
        const colors = { Workforce: '#2B5797', Housing: '#7B1FA2', Youth: '#28A745', Health: '#F57C00', 'Food Security': '#DC3545' };
        html += `
            <div class="card">
                <div style="text-align:center;">
                    <div style="font-size:2em;font-weight:bold;color:${colors[sector] || '#666'};">${count}</div>
                    <div style="font-size:1.1em;margin-top:10px;">${sector}</div>
                </div>
            </div>
        `;
    });

    html += `
        </div>

        <div class="section-header" style="margin-top:40px;">
            <h2>Active Initiative Progress</h2>
        </div>

        <div style="margin-top:20px;">
    `;

    DEMO_DATA.initiatives.filter(i => i.status === 'active').forEach(ini => {
        const progressColor = ini.progress > 70 ? '#28A745' : ini.progress > 40 ? '#FFC107' : '#DC3545';
        html += `
            <div style="margin-bottom:30px;">
                <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                    <h4>${ini.name}</h4>
                    <span style="font-weight:bold;color:${progressColor};">${ini.progress}%</span>
                </div>
                <div class="progress-bar" style="height:8px;">
                    <div class="progress-fill" style="width:${ini.progress}%;background:${progressColor};"></div>
                </div>
            </div>
        `;
    });

    html += `
        </div>
    `;

    view.innerHTML = html;
    parent.appendChild(view);
}

// ========== ACTIVE INITIATIVES ==========
function renderActiveInitiatives(role, parent) {
    const view = document.createElement('div');
    view.className = 'view';
    view.id = `view-active-initiatives`;

    let html = `
        <div class="content-header">
            <h1>Active Initiatives</h1>
            <p>Browse and manage all coalition initiatives</p>
        </div>

        <div style="display:flex;gap:10px;margin-bottom:20px;">
            <input type="text" id="ini-search" placeholder="Search initiatives..." class="input" style="flex:1;">
            <select id="ini-sector-filter" class="input" style="width:150px;">
                <option value="">All Sectors</option>
                <option value="Workforce">Workforce</option>
                <option value="Housing">Housing</option>
                <option value="Youth">Youth</option>
                <option value="Health">Health</option>
                <option value="Food Security">Food Security</option>
            </select>
            ${['coordinator', 'org_admin', 'admin'].includes(role) ? '<button class="btn btn-primary" onclick="switchToView(\'create-initiative\',\'Create Initiative\')">+ New Initiative</button>' : ''}
        </div>

        <div class="initiatives-list" style="display:grid;gap:20px;">
    `;

    DEMO_DATA.initiatives.forEach(ini => {
        const color = { Workforce: '#2B5797', Housing: '#7B1FA2', Youth: '#28A745', Health: '#F57C00', 'Food Security': '#DC3545' }[ini.sector] || '#666';

        html += `
            <div class="card" style="border-left:4px solid ${color};">
                <div class="card-header">
                    <div>
                        <h3>${ini.name}</h3>
                        <p style="color:#666;font-size:0.9em;">${ini.sector} • Led by ${ini.lead}</p>
                    </div>
                    <div>${getStatusBadge(ini.status)}</div>
                </div>
                <div class="card-body">
                    <p style="margin-bottom:15px;">${ini.description}</p>
                    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:15px;margin-bottom:15px;font-size:0.9em;">
                        <div><strong>Budget:</strong> ${ini.budget}</div>
                        <div><strong>Organizations:</strong> ${ini.orgs}</div>
                        <div><strong>Contributors:</strong> ${ini.contributors}</div>
                        <div><strong>Progress:</strong> ${ini.progress}%</div>
                    </div>
                    <div class="progress-bar" style="margin-bottom:15px;">
                        <div class="progress-fill" style="width:${ini.progress}%;"></div>
                    </div>
                    <button class="btn btn-sm btn-info" onclick="showInitiativeModal('${ini.id}')">View Details</button>
                </div>
            </div>
        `;
    });

    html += `
        </div>
    `;

    view.innerHTML = html;
    parent.appendChild(view);
}

function showInitiativeModal(iniId) {
    const ini = DEMO_DATA.initiatives.find(i => i.id === iniId);
    if (!ini) return;

    let content = `
        <div style="line-height:1.8;">
            <h3 style="margin-bottom:15px;">${ini.name}</h3>
            <p><strong>Status:</strong> ${getStatusBadge(ini.status)}</p>
            <p><strong>Sector:</strong> ${ini.sector}</p>
            <p><strong>Lead Coordinator:</strong> ${ini.lead}</p>
            <p><strong>Budget:</strong> ${ini.budget}</p>
            <p><strong>Timeline:</strong> ${formatDate(ini.startDate)} to ${formatDate(ini.endDate)}</p>
            <p><strong>Description:</strong></p>
            <p>${ini.description}</p>
            <p style="margin-top:20px;"><strong>Partner Organizations (${ini.orgs}):</strong></p>
            <ul>
    `;

    DEMO_DATA.organizations.slice(0, ini.orgs).forEach(org => {
        content += `<li>${org.name}</li>`;
    });

    content += `
            </ul>
            <p style="margin-top:20px;"><strong>Milestones:</strong></p>
            <table class="table" style="margin-top:10px;">
                <thead>
                    <tr><th>Milestone</th><th>Status</th><th>Date</th></tr>
                </thead>
                <tbody>
    `;

    ini.milestones.forEach(m => {
        content += `<tr><td>${m.name}</td><td>${getStatusBadge(m.status)}</td><td>${formatDate(m.date)}</td></tr>`;
    });

    content += `
                </tbody>
            </table>
        </div>
    `;

    showModal(`Initiative: ${ini.name}`, content);
}

// ========== CREATE INITIATIVE ==========
function renderCreateInitiative(role, parent) {
    const view = document.createElement('div');
    view.className = 'view';
    view.id = `view-create-initiative`;

    let html = `
        <div class="content-header">
            <h1>Create New Initiative</h1>
            <p>Launch a multi-sector collaborative initiative</p>
        </div>

        <div class="card" style="max-width:800px;">
            <div class="card-body">
                <h3>Step 1: Initiative Basics</h3>
                <div style="margin:20px 0;">
                    <label class="label">Initiative Name</label>
                    <input type="text" class="input" placeholder="e.g., Community Workforce Readiness 2026">
                </div>
                <div style="margin:20px 0;">
                    <label class="label">Description</label>
                    <textarea class="input" placeholder="Describe the initiative goals and approach" style="min-height:100px;"></textarea>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin:20px 0;">
                    <div>
                        <label class="label">Sector</label>
                        <select class="input">
                            <option>Workforce Development</option>
                            <option>Housing</option>
                            <option>Youth Services</option>
                            <option>Health & Wellness</option>
                            <option>Food Security</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">Timeline (Months)</label>
                        <input type="number" class="input" placeholder="6" min="1" max="24">
                    </div>
                </div>

                <h3 style="margin-top:30px;">Step 2: Partner Organizations</h3>
                <div style="margin:20px 0;">
                    <p style="margin-bottom:10px;">Select partner organizations:</p>
    `;

    DEMO_DATA.organizations.forEach(org => {
        html += `
            <div style="margin-bottom:10px;display:flex;align-items:center;">
                <input type="checkbox" id="org-${org.id}" style="margin-right:10px;">
                <label for="org-${org.id}" style="cursor:pointer;flex:1;">${org.name} (${org.sector})</label>
            </div>
        `;
    });

    html += `
                </div>

                <h3 style="margin-top:30px;">Step 3: Budget & Roles</h3>
                <div style="margin:20px 0;">
                    <label class="label">Total Budget</label>
                    <input type="text" class="input" placeholder="$150,000">
                </div>
                <div style="margin:20px 0;">
                    <label class="label">Key Roles Needed</label>
                    <input type="text" class="input" placeholder="e.g., Program Manager, Data Analyst, Community Outreach Coordinator">
                </div>

                <div style="margin-top:30px;display:flex;gap:10px;">
                    <button class="btn btn-primary" onclick="showToast('Initiative created successfully!','success'); switchToView('active-initiatives','Active Initiatives');">Create Initiative</button>
                    <button class="btn btn-secondary" onclick="switchToView('active-initiatives','Active Initiatives');">Cancel</button>
                </div>
            </div>
        </div>
    `;

    view.innerHTML = html;
    parent.appendChild(view);
}

// ========== MY INITIATIVES ==========
function renderMyInitiatives(role, parent) {
    const view = document.createElement('div');
    view.className = 'view';
    view.id = `view-my-initiatives`;

    let html = `
        <div class="content-header">
            <h1>My Initiatives</h1>
            <p>Initiatives you are actively engaged with</p>
        </div>

        <div style="margin-bottom:20px;">
            <select class="input" style="width:200px;">
                <option>All Roles</option>
                <option>Contributor</option>
                <option>Lead Coordinator</option>
                <option>Organization Admin</option>
            </select>
        </div>

        <div class="initiatives-list" style="display:grid;gap:20px;">
    `;

    let myInitiatives = [];
    if (role === 'contributor') {
        myInitiatives = DEMO_DATA.initiatives.slice(0, 2);
    } else if (role === 'org_admin') {
        myInitiatives = DEMO_DATA.initiatives.slice(0, 3);
    }

    if (myInitiatives.length === 0) {
        html += `<div class="card"><p style="text-align:center;color:#999;">No initiatives assigned yet</p></div>`;
    } else {
        myInitiatives.forEach(ini => {
            html += `
                <div class="card">
                    <div class="card-header">
                        <div>
                            <h3>${ini.name}</h3>
                            <p style="color:#666;font-size:0.9em;">${ini.sector}</p>
                        </div>
                        ${getStatusBadge(ini.status)}
                    </div>
                    <div class="card-body">
                        <p><strong>Your Role:</strong> ${role === 'contributor' ? 'Data Analyst' : 'Organization Admin'}</p>
                        <p><strong>Progress:</strong> ${ini.progress}%</p>
                        <div class="progress-bar" style="margin:15px 0;">
                            <div class="progress-fill" style="width:${ini.progress}%;"></div>
                        </div>
                        <p><strong>Next Milestone:</strong> ${ini.milestones.find(m => m.status !== 'complete')?.name || 'All completed'}</p>
                        <button class="btn btn-sm btn-info" onclick="showInitiativeModal('${ini.id}')">View Details</button>
                    </div>
                </div>
            `;
        });
    }

    html += `
        </div>
    `;

    view.innerHTML = html;
    parent.appendChild(view);
}

// ========== INITIATIVE MATCHING ==========
function renderInitiativeMatching(role, parent) {
    const view = document.createElement('div');
    view.className = 'view';
    view.id = `view-initiative-matching`;

    let html = `
        <div class="content-header">
            <h1>Smart Initiative Matching</h1>
            <p>Match organizational needs with available contributor expertise</p>
        </div>

        <div style="display:flex;gap:15px;margin-bottom:20px;">
            <select class="input" style="flex:1;">
                <option value="">All Initiatives</option>
                ${DEMO_DATA.initiatives.filter(i => i.status === 'active').map(i => `<option value="${i.id}">${i.name}</option>`).join('')}
            </select>
            <select class="input" style="flex:1;">
                <option value="">All Skill Categories</option>
                <option value="analysis">Data Analysis</option>
                <option value="writing">Grant Writing</option>
                <option value="design">Program Design</option>
                <option value="outreach">Community Outreach</option>
            </select>
        </div>

        <div class="matches-grid" style="display:grid;gap:20px;">
    `;

    // Generate sample matches
    const matches = [
        { need: 'Data Analysis & Reporting', ini: 'Housing Stability Network', skill: 'Data Analysis', contributors: 3, score: 95 },
        { need: 'Curriculum Development', ini: 'Workforce Readiness 2026', skill: 'Program Design', contributors: 2, score: 87 },
        { need: 'Grant Writing Support', ini: 'Health Equity Data Hub', skill: 'Grant Writing', contributors: 4, score: 91 },
        { need: 'Community Outreach', ini: 'Youth Pathways Program', skill: 'Community Outreach', contributors: 5, score: 78 }
    ];

    matches.forEach((match, idx) => {
        const scoreColor = match.score >= 90 ? '#28A745' : match.score >= 80 ? '#FFC107' : '#DC3545';
        html += `
            <div class="card">
                <div class="card-header">
                    <div>
                        <h3>${match.need}</h3>
                        <p style="color:#666;font-size:0.9em;">${match.ini}</p>
                    </div>
                </div>
                <div class="card-body">
                    <p><strong>Skill Match:</strong> ${match.skill}</p>
                    <p><strong>Available Contributors:</strong> ${match.contributors}</p>
                    <div style="display:flex;align-items:center;gap:10px;margin:15px 0;">
                        <span>Match Score:</span>
                        <div style="flex:1;height:8px;background:#eee;border-radius:4px;overflow:hidden;">
                            <div style="height:100%;width:${match.score}%;background:${scoreColor};"></div>
                        </div>
                        <span style="font-weight:bold;color:${scoreColor};min-width:40px;">${match.score}%</span>
                    </div>
                    <button class="btn btn-sm btn-primary" onclick="showMatchModal('${idx}')">View Matches</button>
                </div>
            </div>
        `;
    });

    html += `
        </div>
    `;

    view.innerHTML = html;
    parent.appendChild(view);
}

function showMatchModal(matchIdx) {
    const content = `
        <div style="line-height:1.8;">
            <h4 style="margin-bottom:15px;">Recommended Contributors</h4>
            <table class="table">
                <thead>
                    <tr><th>Name</th><th>Skills</th><th>Tier</th><th>Experience</th><th>Action</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Priya Patel</strong></td>
                        <td>Data Analysis, Research</td>
                        <td><span class="badge" style="background:#007BFF;color:white;">Advisor</span></td>
                        <td>2 active initiatives</td>
                        <td><button class="btn btn-sm btn-success">Assign</button></td>
                    </tr>
                    <tr>
                        <td><strong>Rachel Martinez</strong></td>
                        <td>Grant Writing, Communications</td>
                        <td><span class="badge" style="background:#17A2B8;color:white;">Verified</span></td>
                        <td>3 active initiatives</td>
                        <td><button class="btn btn-sm btn-success">Assign</button></td>
                    </tr>
                    <tr>
                        <td><strong>Derek Okafor</strong></td>
                        <td>Community Outreach, Design</td>
                        <td><span class="badge" style="background:#6C757D;color:white;">Observer</span></td>
                        <td>1 active initiative</td>
                        <td><button class="btn btn-sm btn-success">Assign</button></td>
                    </tr>
                </tbody>
            </table>
        </div>
    `;

    showModal('Recommended Contributors', content);
}

// ========== USER MANAGEMENT ==========
function renderUserManagement(role, parent) {
    const view = document.createElement('div');
    view.className = 'view';
    view.id = `view-user-management`;

    let html = `
        <div class="content-header">
            <h1>User Management</h1>
            <p>Manage system users and access controls</p>
        </div>

        <div style="display:flex;gap:10px;margin-bottom:20px;">
            <input type="text" placeholder="Search users..." class="input" style="flex:1;">
            <select class="input" style="width:150px;">
                <option value="">All Roles</option>
                <option value="admin">Admin</option>
                <option value="coordinator">Coordinator</option>
                <option value="org_admin">Org Admin</option>
                <option value="contributor">Contributor</option>
                <option value="funder">Funder</option>
            </select>
            <select class="input" style="width:150px;">
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="pending">Pending</option>
            </select>
            <button class="btn btn-primary" onclick="showAddUserModal()">+ Add User</button>
        </div>

        <table class="table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Status</th>
                    <th>Last Login</th>
                    <th>Created</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
    `;

    DEMO_DATA.users.forEach(user => {
        html += `
            <tr>
                <td><strong>${user.name}</strong></td>
                <td>${user.email}</td>
                <td>${user.role}</td>
                <td>${getStatusBadge(user.status)}</td>
                <td>${user.lastLogin}</td>
                <td>${formatDate(user.created)}</td>
                <td>
                    <button class="btn btn-sm btn-info" onclick="showUserModal('${user.id}')">Edit</button>
                </td>
            </tr>
        `;
    });

    html += `
            </tbody>
        </table>
    `;

    view.innerHTML = html;
    parent.appendChild(view);
}

function showAddUserModal() {
    const content = `
        <div>
            <div style="margin:20px 0;">
                <label class="label">Full Name</label>
                <input type="text" class="input" placeholder="Enter user name">
            </div>
            <div style="margin:20px 0;">
                <label class="label">Email</label>
                <input type="email" class="input" placeholder="user@example.org">
            </div>
            <div style="margin:20px 0;">
                <label class="label">Role</label>
                <select class="input">
                    <option value="">Select a role</option>
                    <option value="admin">Admin</option>
                    <option value="coordinator">Coordinator</option>
                    <option value="org_admin">Organization Admin</option>
                    <option value="contributor">Contributor</option>
                    <option value="funder">Funder</option>
                </select>
            </div>
            <div style="margin-top:30px;display:flex;gap:10px;justify-content:flex-end;">
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" onclick="showToast('User added successfully','success'); closeModal();">Add User</button>
            </div>
        </div>
    `;

    showModal('Add New User', content);
}

function showUserModal(userId) {
    const user = DEMO_DATA.users.find(u => u.id === userId);
    if (!user) return;

    const content = `
        <div>
            <div style="margin:20px 0;">
                <label class="label">Full Name</label>
                <input type="text" class="input" value="${user.name}">
            </div>
            <div style="margin:20px 0;">
                <label class="label">Email</label>
                <input type="email" class="input" value="${user.email}">
            </div>
            <div style="margin:20px 0;">
                <label class="label">Role</label>
                <select class="input">
                    <option value="admin" ${user.role === 'admin' ? 'selected' : ''}>Admin</option>
                    <option value="coordinator" ${user.role === 'coordinator' ? 'selected' : ''}>Coordinator</option>
                    <option value="org_admin" ${user.role === 'org_admin' ? 'selected' : ''}>Organization Admin</option>
                    <option value="contributor" ${user.role === 'contributor' ? 'selected' : ''}>Contributor</option>
                    <option value="funder" ${user.role === 'funder' ? 'selected' : ''}>Funder</option>
                </select>
            </div>
            <div style="margin:20px 0;">
                <label class="label">Status</label>
                <select class="input">
                    <option value="active" ${user.status === 'active' ? 'selected' : ''}>Active</option>
                    <option value="pending" ${user.status === 'pending' ? 'selected' : ''}>Pending</option>
                </select>
            </div>
            <div style="margin-top:30px;display:flex;gap:10px;justify-content:flex-end;">
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" onclick="showToast('User updated','success'); closeModal();">Save Changes</button>
            </div>
        </div>
    `;

    showModal(`Edit User: ${user.name}`, content);
}

// ========== AUDIT LOG ==========
function renderAuditLog(role, parent) {
    const view = document.createElement('div');
    view.className = 'view';
    view.id = `view-audit-log`;

    let html = `
        <div class="content-header">
            <h1>System Audit Log</h1>
            <p>Complete audit trail of all system actions</p>
        </div>

        <div style="display:flex;gap:10px;margin-bottom:20px;">
            <input type="text" placeholder="Search events..." class="input" style="flex:1;">
            <select class="input" style="width:150px;">
                <option value="">All Events</option>
                <option value="agent">Agent Actions</option>
                <option value="initiative">Initiative Updates</option>
                <option value="trust">Trust Changes</option>
                <option value="user">User Actions</option>
            </select>
            <select class="input" style="width:150px;">
                <option value="">All Severity</option>
                <option value="info">Info</option>
                <option value="success">Success</option>
                <option value="warning">Warning</option>
                <option value="danger">Danger</option>
            </select>
        </div>

        <div class="audit-timeline">
    `;

    DEMO_DATA.auditLog.forEach((log) => {
        const icon = getSeverityIcon(log.severity);
        const colorMap = { info: '#007BFF', success: '#28A745', warning: '#FFC107', danger: '#DC3545' };
        const color = colorMap[log.severity] || '#666';

        html += `
            <div class="timeline-item" style="border-left-color:${color};">
                <div class="timeline-dot" style="background:${color};">${icon}</div>
                <div class="timeline-content">
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <h4>${log.event}</h4>
                        <span style="font-size:0.85em;color:#999;">${log.ts}</span>
                    </div>
                    <p><strong>Actor:</strong> ${log.actor}</p>
                    <p><strong>Detail:</strong> ${log.detail}</p>
                </div>
            </div>
        `;
    });

    html += `
        </div>
    `;

    view.innerHTML = html;
    parent.appendChild(view);
}

// ========== COORDINATOR BOARD ==========
function renderCoordinatorBoard(role, parent) {
    const view = document.createElement('div');
    view.className = 'view';
    view.id = `view-coordinator-board`;

    let html = `
        <div class="content-header">
            <h1>Coordinator Board</h1>
            <p>Coalition coordination dashboard and operations</p>
        </div>

        <div class="dashboard-grid">
            <div class="stat-card">
                <div class="stat-value">${DEMO_DATA.coordinators.length}</div>
                <div class="stat-label">Coordinators</div>
                <div class="stat-detail">${DEMO_DATA.coordinators.filter(c => c.verified).length} Verified</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${DEMO_DATA.initiatives.filter(i => i.status === 'active').length}</div>
                <div class="stat-label">Active Initiatives</div>
                <div class="stat-detail">Under coordination</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">$${DEMO_DATA.initiatives.reduce((sum, i) => sum + parseInt(i.budget.replace(/[$,K]/g, '')), 0) * 1000}</div>
                <div class="stat-label">Total Budget</div>
                <div class="stat-detail">All initiatives</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${DEMO_DATA.agents.filter(a => a.status === 'active').length}</div>
                <div class="stat-label">Active Agents</div>
                <div class="stat-detail">Supporting coordination</div>
            </div>
        </div>

        <div class="section-header" style="margin-top:40px;">
            <h2>Coordinator Team</h2>
        </div>

        <table class="table" style="margin-top:20px;">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Initiatives Led</th>
                    <th>Total Budget</th>
                    <th>Active Engagements</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
    `;

    DEMO_DATA.coordinators.forEach(coord => {
        html += `
            <tr>
                <td><strong>${coord.name}</strong></td>
                <td>${coord.initiatives}</td>
                <td>${coord.budget}</td>
                <td>${coord.activeEngagements}</td>
                <td><span style="color:#28A745;font-weight:bold;">✓ Verified</span></td>
            </tr>
        `;
    });

    html += `
            </tbody>
        </table>
    `;

    view.innerHTML = html;
    parent.appendChild(view);
}

// ========== ROLE SWITCHER ==========
function switchRole(roleId) {
    APP_STATE.currentRole = roleId;
    const role = ROLES[roleId];

    document.getElementById('role-dot').style.backgroundColor = role.color;
    document.getElementById('role-name').textContent = role.name.split(' ')[0];
    document.getElementById('role-dropdown').classList.remove('open');

    renderRoleDropdown();
    buildNavigation();
    switchToView('dashboard', '📊 Dashboard');
    showToast(`Switched to ${role.name} (${role.title})`, 'info');
}

// ========== APP MODE SYSTEM (Explore / Tour / Onboard) ==========
APP_STATE.appMode = 'explore'; // 'explore' | 'tour' | 'onboard'
APP_STATE.tourStep = 0;
APP_STATE.onboardStep = 0;

function setAppMode(mode) {
    APP_STATE.appMode = mode;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector(`[data-mode="${mode}"]`).classList.add('active');

    // Clean up other modes
    endTour(true);
    document.getElementById('onboarding-overlay').classList.remove('active');

    if (mode === 'tour') startTour();
    else if (mode === 'onboard') startOnboarding();
}

// ========== GUIDED TOUR ENGINE ==========
const TOUR_CONFIGS = {
    admin: [
        { target: '#sidebar', title: 'Navigation Sidebar', desc: 'Your command center. As System Admin, you see all sections: Main views, Initiatives, and Admin Tools. Other roles see a tailored subset.', position: 'right' },
        { target: '[data-view="dashboard"]', title: 'Dashboard', desc: 'Real-time overview of coalition health — registered agents, partner organizations, active initiatives, and contributor activity. All on-chain verified.', position: 'right', navigate: 'dashboard' },
        { target: '[data-view="agent-registry"]', title: 'Agent Registry (ERC-8004)', desc: 'Every autonomous agent is registered on-chain via ERC-8004. You can view trust tiers, suspend agents, and register new ones. Trust tiers progress: Observer → Verified → Advisor → Trusted.', position: 'right', navigate: 'agent-registry' },
        { target: '[data-view="trust-trail"]', title: 'Trust Trail (EAS Attestations)', desc: 'An immutable audit trail powered by Ethereum Attestation Service. Every action — grants, verifications, tier changes — is attested on-chain for full transparency.', position: 'right', navigate: 'trust-trail' },
        { target: '[data-view="initiative-dashboard"]', title: 'Initiative Dashboard', desc: 'The heart of collective impact. Initiatives coordinate multiple organizations, contributors, and agents toward shared outcomes. Track progress, milestones, and budget across the coalition.', position: 'right', navigate: 'initiative-dashboard' },
        { target: '[data-view="ecosystem-map"]', title: 'Ecosystem Map', desc: 'Visual network graph of all organizations, their sectors, and interconnections. See how the coalition weaves together across workforce, housing, health, and youth services.', position: 'right', navigate: 'ecosystem-map' },
        { target: '[data-view="system-settings"]', title: 'Admin: System Settings', desc: 'Configure the trust protocol — chain deployment, session key policies, gas sponsorship via ERC-4337, and trust tier thresholds.', position: 'right', navigate: 'system-settings' },
        { target: '.mode-toggle', title: 'Mode Toggle', desc: 'Switch between Free Exploration (click anything), this Guided Tour, or the Onboarding flow for new users. Try switching roles with the role picker to see how each stakeholder experiences the platform!', position: 'bottom' }
    ],
    coordinator: [
        { target: '#sidebar', title: 'Coordinator View', desc: 'As Coalition Coordinator, you manage initiatives, match resources, oversee agents, and keep member organizations aligned.', position: 'right' },
        { target: '[data-view="dashboard"]', title: 'Your Dashboard', desc: 'Coordinator-specific metrics: active initiatives you lead, pending matches, engagement levels, and budget utilization across your portfolio.', position: 'right', navigate: 'dashboard' },
        { target: '[data-view="coordination-hub"]', title: 'Coordination Hub', desc: 'Your daily operating center. See pending needs from organizations, match them with contributors and agents, and track the coordination queue.', position: 'right', navigate: 'coordination-hub' },
        { target: '[data-view="initiative-dashboard"]', title: 'Initiative Management', desc: 'Create and manage cross-sector initiatives. Set milestones, assign organizations, track budget, and coordinate contributors — all with on-chain accountability.', position: 'right', navigate: 'initiative-dashboard' },
        { target: '[data-view="coalition-settings"]', title: 'Coalition Settings', desc: 'Configure matching criteria, communication preferences, and onboarding workflows for your coalition members.', position: 'right', navigate: 'coalition-settings' },
        { target: '[data-view="member-organizations"]', title: 'Member Organizations', desc: 'Directory of all coalition members. Review verification status, monitor engagement, and manage the onboarding queue for new organizations joining Unite DFW.', position: 'right', navigate: 'member-organizations' }
    ],
    org_admin: [
        { target: '#sidebar', title: 'Organization Admin View', desc: 'As an Org Admin, you manage your team, configure agents, post needs, and track budget allocations within your organization.', position: 'right' },
        { target: '[data-view="dashboard"]', title: 'Organization Dashboard', desc: 'See your org\'s active programs, team engagement, budget utilization, and how your agents are performing across coalition initiatives.', position: 'right', navigate: 'dashboard' },
        { target: '[data-view="initiative-dashboard"]', title: 'Initiatives You\'re Part Of', desc: 'View and contribute to coalition-wide initiatives your organization has joined. Track your org\'s commitments and deliverables.', position: 'right', navigate: 'initiative-dashboard' },
        { target: '[data-view="team-management"]', title: 'Team Management', desc: 'Manage team members, their roles, and permissions. Invite new contributors and track their verification progress.', position: 'right', navigate: 'team-management' },
        { target: '[data-view="budget-allocations"]', title: 'Budget & Allocations', desc: 'Track how your budget flows across initiatives. Escrow-backed payments with milestone-based releases ensure accountability. All transactions on-chain.', position: 'right', navigate: 'budget-allocations' },
        { target: '[data-view="agent-configuration"]', title: 'Agent Configuration', desc: 'Configure AI agents that work on your org\'s behalf — set trust bounds, session key limits, and allowable actions via ERC-4337.', position: 'right', navigate: 'agent-configuration' }
    ],
    contributor: [
        { target: '#sidebar', title: 'Contributor View', desc: 'As a Contributor, you browse opportunities, build your reputation through verified work, and earn portable on-chain attestations.', position: 'right' },
        { target: '[data-view="dashboard"]', title: 'Your Dashboard', desc: 'See your active engagements, skill matches, trust tier progress, and recent attestations. Your work history is verifiable on-chain.', position: 'right', navigate: 'dashboard' },
        { target: '[data-view="opportunities"]', title: 'Opportunities Board', desc: 'Browse open opportunities matched to your skills. See match percentages, budgets, and timelines. Apply with one click — your verified reputation speaks for itself.', position: 'right', navigate: 'opportunities' },
        { target: '[data-view="my-engagements"]', title: 'My Engagements', desc: 'Track your active, completed, and pending engagements. Each completion earns an on-chain attestation that builds your trust tier.', position: 'right', navigate: 'my-engagements' },
        { target: '[data-view="my-reputation"]', title: 'My Reputation', desc: 'Your portable reputation profile — trust tier, skill attestations, endorsements, and engagement history. This travels with you across the ecosystem.', position: 'right', navigate: 'my-reputation' },
        { target: '[data-view="wallet"]', title: 'Wallet (ERC-4337)', desc: 'Your smart wallet powered by account abstraction. View balances, pending payments, and escrow milestones. Gas is sponsored — no crypto knowledge needed.', position: 'right', navigate: 'wallet' }
    ],
    funder: [
        { target: '#sidebar', title: 'Funder View', desc: 'As a Grantmaker, you track portfolio impact, verify outcomes, ensure compliance, and configure grants — all with on-chain transparency.', position: 'right' },
        { target: '[data-view="dashboard"]', title: 'Funder Dashboard', desc: 'Portfolio overview with total deployed capital, active grants, verified outcomes, and impact metrics across all funded initiatives.', position: 'right', navigate: 'dashboard' },
        { target: '[data-view="portfolio-overview"]', title: 'Portfolio Overview', desc: 'Detailed breakdown of your grant portfolio. See which initiatives are on track, at risk, or completed. Budget utilization by sector and time.', position: 'right', navigate: 'portfolio-overview' },
        { target: '[data-view="outcome-verification"]', title: 'Outcome Verification', desc: 'Verify real-world outcomes against program milestones. Each verification creates an on-chain attestation via EAS — trustless proof of impact.', position: 'right', navigate: 'outcome-verification' },
        { target: '[data-view="compliance"]', title: 'Compliance Dashboard', desc: 'Track regulatory compliance, audit readiness, and reporting requirements across your portfolio. Auto-generated compliance reports from on-chain data.', position: 'right', navigate: 'compliance' },
        { target: '[data-view="grant-configuration"]', title: 'Grant Configuration', desc: 'Set up new grants with escrow parameters, milestone definitions, disbursement schedules, and reporting requirements. Smart contract-backed accountability.', position: 'right', navigate: 'grant-configuration' }
    ]
};

function startTour() {
    APP_STATE.tourStep = 0;
    const overlay = document.getElementById('tour-overlay');
    overlay.classList.add('active');
    showTourStep();
}

function showTourStep() {
    const role = APP_STATE.currentRole;
    const steps = TOUR_CONFIGS[role] || TOUR_CONFIGS.admin;
    const step = steps[APP_STATE.tourStep];
    if (!step) { endTour(); return; }

    // Navigate if needed
    if (step.navigate) {
        switchToView(step.navigate, step.title);
    }

    // Update badge
    document.getElementById('tour-step-badge').textContent = `${APP_STATE.tourStep + 1}/${steps.length}`;
    document.getElementById('tour-tooltip-title').textContent = step.title;
    document.getElementById('tour-tooltip-desc').textContent = step.desc;

    // Show/hide prev button
    document.getElementById('tour-prev').style.display = APP_STATE.tourStep === 0 ? 'none' : 'inline-block';
    document.getElementById('tour-next').textContent = APP_STATE.tourStep === steps.length - 1 ? 'Finish ✓' : 'Next →';

    // Position spotlight
    const targetEl = document.querySelector(step.target);
    const spotlight = document.getElementById('tour-spotlight');
    const tooltip = document.getElementById('tour-tooltip');

    if (targetEl) {
        const rect = targetEl.getBoundingClientRect();
        const pad = 8;
        spotlight.style.left = (rect.left - pad) + 'px';
        spotlight.style.top = (rect.top - pad) + 'px';
        spotlight.style.width = (rect.width + pad * 2) + 'px';
        spotlight.style.height = (rect.height + pad * 2) + 'px';
        spotlight.style.display = 'block';

        // Position tooltip
        if (step.position === 'right') {
            tooltip.style.left = (rect.right + 20) + 'px';
            tooltip.style.top = Math.max(10, rect.top) + 'px';
        } else if (step.position === 'bottom') {
            tooltip.style.left = rect.left + 'px';
            tooltip.style.top = (rect.bottom + 15) + 'px';
        } else {
            tooltip.style.left = (rect.right + 20) + 'px';
            tooltip.style.top = rect.top + 'px';
        }
    } else {
        // Fallback: center tooltip
        spotlight.style.display = 'none';
        tooltip.style.left = '50%';
        tooltip.style.top = '50%';
        tooltip.style.transform = 'translate(-50%, -50%)';
    }
}

function tourNext() {
    const role = APP_STATE.currentRole;
    const steps = TOUR_CONFIGS[role] || TOUR_CONFIGS.admin;
    if (APP_STATE.tourStep >= steps.length - 1) {
        endTour();
        showToast('Tour complete! Switch to Explore mode to try everything yourself.', 'success');
    } else {
        APP_STATE.tourStep++;
        showTourStep();
    }
}

function tourPrev() {
    if (APP_STATE.tourStep > 0) {
        APP_STATE.tourStep--;
        showTourStep();
    }
}

function endTour(silent) {
    document.getElementById('tour-overlay').classList.remove('active');
    if (!silent) {
        APP_STATE.appMode = 'explore';
        document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
        document.querySelector('[data-mode="explore"]').classList.add('active');
    }
}

// ========== ONBOARDING WIZARD ENGINE ==========
const ONBOARDING_CONFIGS = {
    // ===== CONTRIBUTOR (Priya Patel) =====
    contributor: {
        steps: [
            {
                title: '🔗 Connect Your Account',
                subtitle: 'Step 1 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Sign in with your email to get started. Web3Auth will create a smart wallet for you automatically — no crypto experience needed.</p><div class="ob-field"><label>Email Address</label><input type="email" value="priya.patel@gmail.com" readonly></div><div style="margin-top:12px;padding:12px;background:#f0fdf4;border-radius:8px;font-size:0.85rem;color:#16a34a;">✓ Web3Auth will provision an ERC-4337 smart wallet on BASE chain<br>✓ Gas fees are sponsored — transactions are free for you</div></div>'
            },
            {
                title: '👤 Your Profile',
                subtitle: 'Step 2 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Tell us about yourself so we can match you with the right opportunities.</p><div class="ob-row"><div class="ob-field"><label>First Name</label><input type="text" value="Priya" readonly></div><div class="ob-field"><label>Last Name</label><input type="text" value="Patel" readonly></div></div><div class="ob-field"><label>Role / Title</label><input type="text" value="Data Analyst" readonly></div><div class="ob-field"><label>Bio</label><textarea readonly>Experienced data analyst specializing in program evaluation and community impact measurement. 5+ years working with nonprofits across DFW.</textarea></div></div>'
            },
            {
                title: '🤖 Create Your Agent',
                subtitle: 'Step 3 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Name your personal AI agent. It will assist you with opportunity matching, engagement tracking, and building your reputation.</p><div class="ob-field"><label>Agent Name</label><input type="text" value="Priya\'s Research Agent" readonly><div class="ob-hint">Your agent is registered on-chain via ERC-8004 and starts at the Observer trust tier.</div></div><div class="ob-agent-preview"><div class="ob-agent-icon">🤖</div><div class="ob-agent-meta"><h4>Priya\'s Research Agent</h4><p>ERC-8004 · Observer Tier · BASE Chain</p><p style="margin-top:4px;font-size:0.75rem;font-family:monospace;color:#94a3b8;">0x7f2a...4e8b</p></div></div></div>'
            },
            {
                title: '🏷️ Skills & Availability',
                subtitle: 'Step 4 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:12px;">Select your skills and set your availability. These power the matching algorithm.</p><div class="ob-field"><label>Select Your Skills</label><div class="ob-tags"><span class="ob-tag selected">Data Analysis</span><span class="ob-tag selected">Research</span><span class="ob-tag selected">Program Evaluation</span><span class="ob-tag">Grant Writing</span><span class="ob-tag">Case Management</span><span class="ob-tag selected">Impact Measurement</span><span class="ob-tag">Community Outreach</span><span class="ob-tag">Project Management</span><span class="ob-tag">Policy Analysis</span></div></div><div class="ob-row"><div class="ob-field"><label>Availability</label><select><option selected>10-20 hrs/week</option></select></div><div class="ob-field"><label>Preferred Engagement</label><select><option selected>Short-term projects (1-3 months)</option></select></div></div></div>'
            },
            {
                title: '✅ You\'re All Set!',
                subtitle: 'Step 5 of 5',
                content: '<div class="ob-summary"><p style="margin-bottom:16px;">Here\'s a summary of your setup. Click <strong>Get Started</strong> to enter the platform.</p><div class="ob-summary-item"><span class="ob-label">Name</span><span class="ob-value">Priya Patel</span></div><div class="ob-summary-item"><span class="ob-label">Email</span><span class="ob-value">priya.patel@gmail.com</span></div><div class="ob-summary-item"><span class="ob-label">Role</span><span class="ob-value">Contributor</span></div><div class="ob-summary-item"><span class="ob-label">Agent</span><span class="ob-value">Priya\'s Research Agent</span></div><div class="ob-summary-item"><span class="ob-label">Skills</span><span class="ob-value">Data Analysis, Research, Program Evaluation, Impact Measurement</span></div><div class="ob-summary-item"><span class="ob-label">Trust Tier</span><span class="ob-value">Observer (starting)</span></div><div class="ob-wallet-card"><div class="ob-wallet-label">Smart Wallet (ERC-4337)</div><div class="ob-wallet-addr">0x7f2a8B3c9D1e4F6a...2C5d7E9b1A3f4e8b</div><div class="ob-wallet-chain"><span>BASE</span><span>Gas Sponsored ✓</span></div></div></div>'
            }
        ]
    },

    // ===== ORG ADMIN (Marcus Webb) =====
    org_admin: {
        steps: [
            {
                title: '🔗 Connect Your Account',
                subtitle: 'Step 1 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Sign in with your organization email to begin setting up your organization in the coalition.</p><div class="ob-field"><label>Email Address</label><input type="email" value="marcus.webb@metroworkforce.org" readonly></div><div class="ob-row"><div class="ob-field"><label>First Name</label><input type="text" value="Marcus" readonly></div><div class="ob-field"><label>Last Name</label><input type="text" value="Webb" readonly></div></div><div style="margin-top:12px;padding:12px;background:#f0fdf4;border-radius:8px;font-size:0.85rem;color:#16a34a;">✓ Web3Auth wallet provisioned on BASE chain</div></div>'
            },
            {
                title: '🤖 Create Your Agent',
                subtitle: 'Step 2 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Name your personal AI agent. As an Org Admin, you\'ll also create an organizational agent in the next step.</p><div class="ob-field"><label>Personal Agent Name</label><input type="text" value="Marcus\'s Admin Agent" readonly><div class="ob-hint">Your personal agent handles notifications, scheduling, and admin tasks.</div></div><div class="ob-agent-preview"><div class="ob-agent-icon">🤖</div><div class="ob-agent-meta"><h4>Marcus\'s Admin Agent</h4><p>ERC-8004 · Observer Tier · BASE Chain</p><p style="margin-top:4px;font-size:0.75rem;font-family:monospace;color:#94a3b8;">0x2f5d...8a1e</p></div></div></div>'
            },
            {
                title: '🏢 Register Organization',
                subtitle: 'Step 3 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Register your organization in the Unite DFW coalition.</p><div class="ob-field"><label>Organization Name</label><input type="text" value="Metro Workforce Solutions" readonly></div><div class="ob-row"><div class="ob-field"><label>Sector</label><select><option selected>Workforce Development</option></select></div><div class="ob-field"><label>Annual Budget</label><input type="text" value="$450,000" readonly></div></div><div class="ob-field"><label>Active Programs</label><textarea readonly>Job Training & Placement, Skills Certification, Employer Partnerships</textarea></div><div class="ob-field"><label>Primary Contact</label><input type="text" value="marcus.webb@metroworkforce.org" readonly></div><div class="ob-field"><label>Service Area</label><input type="text" value="Dallas-Fort Worth Metroplex" readonly></div></div>'
            },
            {
                title: '🤖 Create Organization Agent',
                subtitle: 'Step 4 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Name the AI agent that will act on behalf of your organization. This agent handles coordination requests, resource matching, and reporting within defined trust bounds.</p><div class="ob-field"><label>Organization Agent Name</label><input type="text" value="Metro Workforce Coordination Agent" readonly></div><div class="ob-field"><label>Agent Permissions</label><div style="margin-top:8px;"><div class="ob-check"><input type="checkbox" checked onclick="return false"> Respond to coordination requests</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> Submit milestone reports</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> Match team members to opportunities</div><div class="ob-check"><input type="checkbox" onclick="return false"> Approve budget disbursements</div></div><div class="ob-hint">Permissions can be adjusted later in Agent Configuration.</div></div><div class="ob-agent-preview"><div class="ob-agent-icon">🏢</div><div class="ob-agent-meta"><h4>Metro Workforce Coordination Agent</h4><p>ERC-8004 · Observer Tier · BASE Chain · Org-scoped</p></div></div></div>'
            },
            {
                title: '✅ You\'re All Set!',
                subtitle: 'Step 5 of 5',
                content: '<div class="ob-summary"><p style="margin-bottom:16px;">Your organization is registered and ready to engage in the coalition.</p><div class="ob-summary-item"><span class="ob-label">Admin</span><span class="ob-value">Marcus Webb</span></div><div class="ob-summary-item"><span class="ob-label">Organization</span><span class="ob-value">Metro Workforce Solutions</span></div><div class="ob-summary-item"><span class="ob-label">Sector</span><span class="ob-value">Workforce Development</span></div><div class="ob-summary-item"><span class="ob-label">Personal Agent</span><span class="ob-value">Marcus\'s Admin Agent</span></div><div class="ob-summary-item"><span class="ob-label">Org Agent</span><span class="ob-value">Metro Workforce Coordination Agent</span></div><div class="ob-summary-item"><span class="ob-label">Programs</span><span class="ob-value">Job Training, Skills Certification, Employer Partnerships</span></div><div class="ob-wallet-card"><div class="ob-wallet-label">Organization Wallet (ERC-4337)</div><div class="ob-wallet-addr">0x2f5d9C1a3B7e8D4f...6A2c8E5b1D3f8a1e</div><div class="ob-wallet-chain"><span>BASE</span><span>Gas Sponsored ✓</span><span>Verified ✓</span></div></div></div>'
            }
        ]
    },

    // ===== COORDINATOR (Sarah Chen) =====
    coordinator: {
        steps: [
            {
                title: '🔗 Connect Your Account',
                subtitle: 'Step 1 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Sign in with your email to join as a Coalition Coordinator.</p><div class="ob-field"><label>Email Address</label><input type="email" value="sarah.chen@unitedfw.org" readonly></div><div class="ob-row"><div class="ob-field"><label>First Name</label><input type="text" value="Sarah" readonly></div><div class="ob-field"><label>Last Name</label><input type="text" value="Chen" readonly></div></div><div class="ob-field"><label>Title</label><input type="text" value="Coalition Coordinator" readonly></div><div style="margin-top:12px;padding:12px;background:#f0fdf4;border-radius:8px;font-size:0.85rem;color:#16a34a;">✓ Web3Auth wallet provisioned on BASE chain</div></div>'
            },
            {
                title: '🤖 Create Your Agent',
                subtitle: 'Step 2 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Name your personal AI agent. As a Coordinator, your agent has elevated permissions for matching and oversight.</p><div class="ob-field"><label>Agent Name</label><input type="text" value="Sarah\'s Coordination Agent" readonly><div class="ob-hint">Coordination agents can match resources, deploy task agents, and oversee engagements.</div></div><div class="ob-agent-preview"><div class="ob-agent-icon">🔄</div><div class="ob-agent-meta"><h4>Sarah\'s Coordination Agent</h4><p>ERC-8004 · Observer Tier · BASE Chain · Coordinator-scoped</p></div></div></div>'
            },
            {
                title: '🏠 Coalition & Scope',
                subtitle: 'Step 3 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Define which coalition you coordinate and your sector coverage.</p><div class="ob-field"><label>Coalition</label><input type="text" value="Unite DFW" readonly></div><div class="ob-field"><label>Sectors You Coordinate</label><div class="ob-tags"><span class="ob-tag selected">Workforce</span><span class="ob-tag selected">Housing</span><span class="ob-tag selected">Youth Services</span><span class="ob-tag selected">Health</span><span class="ob-tag">Food Security</span><span class="ob-tag">Education</span><span class="ob-tag">Legal Aid</span></div></div><div class="ob-field"><label>Organizations in Portfolio</label><div style="margin-top:8px;"><div class="ob-check"><input type="checkbox" checked onclick="return false"> Metro Workforce Solutions</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> Hope House Shelter</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> DFW Youth Alliance</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> Community Health Network</div><div class="ob-check"><input type="checkbox" onclick="return false"> Legal Aid of NorthTexas</div></div></div></div>'
            },
            {
                title: '⚙️ Agent Permissions',
                subtitle: 'Step 4 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Configure the trust bounds for your coordination agent.</p><div class="ob-field"><label>Matching Authority</label><div style="margin-top:8px;"><div class="ob-check"><input type="checkbox" checked onclick="return false"> Match contributors to organization needs</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> Deploy task-specific agents</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> Approve engagement requests</div><div class="ob-check"><input type="checkbox" onclick="return false"> Auto-approve matches under $5K</div></div></div><div class="ob-row"><div class="ob-field"><label>Budget Threshold</label><input type="text" value="$10,000" readonly><div class="ob-hint">Matches above this need manual approval</div></div><div class="ob-field"><label>Session Key Duration</label><select><option selected>24 hours</option></select><div class="ob-hint">Agent permissions auto-expire via ERC-4337</div></div></div></div>'
            },
            {
                title: '✅ You\'re All Set!',
                subtitle: 'Step 5 of 5',
                content: '<div class="ob-summary"><p style="margin-bottom:16px;">Your coordinator profile is ready. You\'ll land in the Coordination Hub.</p><div class="ob-summary-item"><span class="ob-label">Name</span><span class="ob-value">Sarah Chen</span></div><div class="ob-summary-item"><span class="ob-label">Role</span><span class="ob-value">Coalition Coordinator</span></div><div class="ob-summary-item"><span class="ob-label">Coalition</span><span class="ob-value">Unite DFW</span></div><div class="ob-summary-item"><span class="ob-label">Agent</span><span class="ob-value">Sarah\'s Coordination Agent</span></div><div class="ob-summary-item"><span class="ob-label">Sectors</span><span class="ob-value">Workforce, Housing, Youth, Health</span></div><div class="ob-summary-item"><span class="ob-label">Orgs Managed</span><span class="ob-value">4 organizations</span></div><div class="ob-summary-item"><span class="ob-label">Budget Authority</span><span class="ob-value">Up to $10,000</span></div><div class="ob-wallet-card"><div class="ob-wallet-label">Coordinator Wallet (ERC-4337)</div><div class="ob-wallet-addr">0x4a9c7E2b1F3d6A8e...5B1c3D7f9A2e4c6b</div><div class="ob-wallet-chain"><span>BASE</span><span>Gas Sponsored ✓</span><span>Coordinator ✓</span></div></div></div>'
            }
        ]
    },

    // ===== FUNDER (David Park) =====
    funder: {
        steps: [
            {
                title: '🔗 Connect Your Account',
                subtitle: 'Step 1 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Sign in with your email to set up your grantmaker profile.</p><div class="ob-field"><label>Email Address</label><input type="email" value="david.park@dfwfoundation.org" readonly></div><div class="ob-row"><div class="ob-field"><label>First Name</label><input type="text" value="David" readonly></div><div class="ob-field"><label>Last Name</label><input type="text" value="Park" readonly></div></div><div class="ob-field"><label>Title</label><input type="text" value="Program Officer" readonly></div><div style="margin-top:12px;padding:12px;background:#f0fdf4;border-radius:8px;font-size:0.85rem;color:#16a34a;">✓ Web3Auth wallet provisioned on BASE chain</div></div>'
            },
            {
                title: '🤖 Create Your Agent',
                subtitle: 'Step 2 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Name your oversight agent. This agent monitors grant performance, flags compliance issues, and surfaces verification requests.</p><div class="ob-field"><label>Agent Name</label><input type="text" value="DFW Foundation Oversight Agent" readonly><div class="ob-hint">Oversight agents have read access to all funded initiatives and can flag anomalies.</div></div><div class="ob-agent-preview"><div class="ob-agent-icon">👁️</div><div class="ob-agent-meta"><h4>DFW Foundation Oversight Agent</h4><p>ERC-8004 · Observer Tier · BASE Chain · Funder-scoped</p></div></div></div>'
            },
            {
                title: '🏛️ Funding Entity',
                subtitle: 'Step 3 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Register your funding entity and define your grantmaking focus.</p><div class="ob-field"><label>Entity Name</label><input type="text" value="DFW Community Foundation" readonly></div><div class="ob-row"><div class="ob-field"><label>Entity Type</label><select><option selected>Community Foundation</option></select></div><div class="ob-field"><label>Annual Grant Budget</label><input type="text" value="$2,400,000" readonly></div></div><div class="ob-field"><label>Focus Areas</label><div class="ob-tags"><span class="ob-tag selected">Workforce Development</span><span class="ob-tag selected">Housing Stability</span><span class="ob-tag selected">Youth Services</span><span class="ob-tag">Education</span><span class="ob-tag selected">Community Health</span><span class="ob-tag">Food Security</span></div></div><div class="ob-field"><label>Geographic Scope</label><input type="text" value="Dallas-Fort Worth Metroplex" readonly></div></div>'
            },
            {
                title: '📋 Compliance & Reporting',
                subtitle: 'Step 4 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Set your compliance requirements. These are enforced automatically through smart contracts.</p><div class="ob-field"><label>Reporting Frequency</label><select><option selected>Quarterly</option></select></div><div class="ob-field"><label>Required Verifications</label><div style="margin-top:8px;"><div class="ob-check"><input type="checkbox" checked onclick="return false"> Milestone-based disbursement (escrow release on completion)</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> On-chain outcome attestations via EAS</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> Coordinator validation required before release</div><div class="ob-check"><input type="checkbox" onclick="return false"> Independent third-party audit</div></div></div><div class="ob-field"><label>Auto-generated Reports</label><div style="margin-top:8px;"><div class="ob-check"><input type="checkbox" checked onclick="return false"> Budget utilization by initiative</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> Outcome metrics dashboard</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> Compliance status summary</div></div></div></div>'
            },
            {
                title: '✅ You\'re All Set!',
                subtitle: 'Step 5 of 5',
                content: '<div class="ob-summary"><p style="margin-bottom:16px;">Your funder profile is ready. You\'ll land in the Portfolio Dashboard.</p><div class="ob-summary-item"><span class="ob-label">Name</span><span class="ob-value">David Park</span></div><div class="ob-summary-item"><span class="ob-label">Entity</span><span class="ob-value">DFW Community Foundation</span></div><div class="ob-summary-item"><span class="ob-label">Role</span><span class="ob-value">Grantmaker</span></div><div class="ob-summary-item"><span class="ob-label">Agent</span><span class="ob-value">DFW Foundation Oversight Agent</span></div><div class="ob-summary-item"><span class="ob-label">Grant Budget</span><span class="ob-value">$2,400,000</span></div><div class="ob-summary-item"><span class="ob-label">Focus Areas</span><span class="ob-value">Workforce, Housing, Youth, Health</span></div><div class="ob-summary-item"><span class="ob-label">Reporting</span><span class="ob-value">Quarterly, milestone-based</span></div><div class="ob-wallet-card"><div class="ob-wallet-label">Foundation Wallet (ERC-4337)</div><div class="ob-wallet-addr">0x8e1b5F3a7C9d2E4f...6B8c1D5a3F7e2b9d</div><div class="ob-wallet-chain"><span>BASE</span><span>Gas Sponsored ✓</span><span>Escrow Enabled ✓</span></div></div></div>'
            }
        ]
    },

    // ===== ADMIN (Elena Rodriguez) =====
    admin: {
        steps: [
            {
                title: '🔗 Connect Your Account',
                subtitle: 'Step 1 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Sign in with your administrator email to configure the trust protocol.</p><div class="ob-field"><label>Email Address</label><input type="email" value="elena.rodriguez@unitedfw.org" readonly></div><div class="ob-row"><div class="ob-field"><label>First Name</label><input type="text" value="Elena" readonly></div><div class="ob-field"><label>Last Name</label><input type="text" value="Rodriguez" readonly></div></div><div class="ob-field"><label>Title</label><input type="text" value="System Administrator" readonly></div><div style="margin-top:12px;padding:12px;background:#f0fdf4;border-radius:8px;font-size:0.85rem;color:#16a34a;">✓ Web3Auth wallet provisioned on BASE chain<br>✓ Admin credentials verified via deployment key</div></div>'
            },
            {
                title: '🤖 Create Your Agent',
                subtitle: 'Step 2 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Name your admin agent. This agent monitors system health, manages the agent registry, and enforces protocol rules.</p><div class="ob-field"><label>Agent Name</label><input type="text" value="Unite DFW System Agent" readonly><div class="ob-hint">System agents have the highest permission level and can register/suspend other agents.</div></div><div class="ob-agent-preview"><div class="ob-agent-icon">⚡</div><div class="ob-agent-meta"><h4>Unite DFW System Agent</h4><p>ERC-8004 · Steward Tier · BASE Chain · System-scoped</p></div></div></div>'
            },
            {
                title: '⚙️ Protocol Configuration',
                subtitle: 'Step 3 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Configure the core trust protocol settings for your coalition.</p><div class="ob-row"><div class="ob-field"><label>Primary Chain</label><select><option selected>BASE</option></select></div><div class="ob-field"><label>Secondary Chain</label><select><option selected>Ethereum (L1)</option></select></div></div><div class="ob-field"><label>Gas Sponsorship</label><div style="margin-top:8px;"><div class="ob-check"><input type="checkbox" checked onclick="return false"> Sponsor all participant transactions</div><div class="ob-check"><input type="checkbox" checked onclick="return false"> Sponsor agent operations</div><div class="ob-check"><input type="checkbox" onclick="return false"> Require deposit for high-value operations</div></div></div><div class="ob-row"><div class="ob-field"><label>Session Key Expiry</label><select><option selected>24 hours</option></select></div><div class="ob-field"><label>Max Agent Budget / Session</label><input type="text" value="$5,000" readonly></div></div></div>'
            },
            {
                title: '📊 Trust Tier Thresholds',
                subtitle: 'Step 4 of 5',
                content: '<div class="ob-form"><p style="margin-bottom:16px;">Define how participants and agents progress through trust tiers.</p><div style="margin-top:8px;"><div style="display:grid;grid-template-columns:1fr 2fr 1fr;gap:8px;padding:8px 0;border-bottom:1px solid var(--border);font-size:0.8rem;font-weight:600;color:var(--muted);"><span>TIER</span><span>REQUIREMENT</span><span>THRESHOLD</span></div><div style="display:grid;grid-template-columns:1fr 2fr 1fr;gap:8px;padding:10px 0;border-bottom:1px solid var(--border);font-size:0.9rem;align-items:center;"><span class="badge badge-observer">Observer</span><span>Registration complete</span><input type="text" value="0 attestations" readonly style="padding:6px 8px;border:1px solid var(--border);border-radius:6px;font-size:0.85rem;"></div><div style="display:grid;grid-template-columns:1fr 2fr 1fr;gap:8px;padding:10px 0;border-bottom:1px solid var(--border);font-size:0.9rem;align-items:center;"><span class="badge badge-advisor">Advisor</span><span>Verified skills + engagement</span><input type="text" value="5 attestations" readonly style="padding:6px 8px;border:1px solid var(--border);border-radius:6px;font-size:0.85rem;"></div><div style="display:grid;grid-template-columns:1fr 2fr 1fr;gap:8px;padding:10px 0;border-bottom:1px solid var(--border);font-size:0.9rem;align-items:center;"><span class="badge badge-coordinator">Coordinator</span><span>Sustained quality + endorsements</span><input type="text" value="15 attestations" readonly style="padding:6px 8px;border:1px solid var(--border);border-radius:6px;font-size:0.85rem;"></div><div style="display:grid;grid-template-columns:1fr 2fr 1fr;gap:8px;padding:10px 0;font-size:0.9rem;align-items:center;"><span class="badge badge-steward">Steward</span><span>Long-term track record + governance</span><input type="text" value="30 attestations" readonly style="padding:6px 8px;border:1px solid var(--border);border-radius:6px;font-size:0.85rem;"></div></div></div>'
            },
            {
                title: '✅ You\'re All Set!',
                subtitle: 'Step 5 of 5',
                content: '<div class="ob-summary"><p style="margin-bottom:16px;">The trust protocol is configured. You\'ll land in the System Dashboard.</p><div class="ob-summary-item"><span class="ob-label">Admin</span><span class="ob-value">Elena Rodriguez</span></div><div class="ob-summary-item"><span class="ob-label">Coalition</span><span class="ob-value">Unite DFW</span></div><div class="ob-summary-item"><span class="ob-label">System Agent</span><span class="ob-value">Unite DFW System Agent</span></div><div class="ob-summary-item"><span class="ob-label">Primary Chain</span><span class="ob-value">BASE</span></div><div class="ob-summary-item"><span class="ob-label">Gas Policy</span><span class="ob-value">Fully sponsored</span></div><div class="ob-summary-item"><span class="ob-label">Session Key Expiry</span><span class="ob-value">24 hours</span></div><div class="ob-summary-item"><span class="ob-label">Trust Tiers</span><span class="ob-value">Observer → Advisor → Coordinator → Steward</span></div><div class="ob-wallet-card"><div class="ob-wallet-label">Admin Wallet (ERC-4337)</div><div class="ob-wallet-addr">0x1a3b5C7d9E2f4A6b...8C1d3E5f7A9b2c4e</div><div class="ob-wallet-chain"><span>BASE</span><span>Admin ✓</span><span>Steward Tier ✓</span></div></div></div>'
            }
        ]
    }
};

function startOnboarding() {
    APP_STATE.onboardStep = 0;
    document.getElementById('onboarding-overlay').classList.add('active');
    renderOnboardingStep();
}

function renderOnboardingStep() {
    const role = APP_STATE.currentRole;
    const config = ONBOARDING_CONFIGS[role] || ONBOARDING_CONFIGS.admin;
    const steps = config.steps;
    const step = steps[APP_STATE.onboardStep];

    // Render progress dots
    const progressEl = document.getElementById('onboarding-progress');
    progressEl.innerHTML = steps.map((s, i) => {
        let cls = 'onboarding-progress-step';
        if (i < APP_STATE.onboardStep) cls += ' completed';
        if (i === APP_STATE.onboardStep) cls += ' active';
        return `<div class="${cls}" onclick="goToOnboardStep(${i})"></div>`;
    }).join('');

    // Render content
    const contentEl = document.getElementById('onboarding-content');
    contentEl.innerHTML = `
        ${step.subtitle ? `<div style="font-size:0.85rem;color:#64748b;margin-bottom:8px;">${step.subtitle}</div>` : ''}
        <h2>${step.title}</h2>
        ${step.content}
    `;

    // Render actions
    const actionsEl = document.getElementById('onboarding-actions');
    const isFirst = APP_STATE.onboardStep === 0;
    const isLast = APP_STATE.onboardStep === steps.length - 1;

    actionsEl.innerHTML = `
        ${!isFirst ? '<button class="btn btn-secondary" onclick="prevOnboardStep()">← Back</button>' : '<button class="btn btn-secondary" onclick="skipOnboarding()">Skip</button>'}
        ${isLast ? '<button class="btn btn-primary" onclick="finishOnboarding()">Get Started! →</button>' : '<button class="btn btn-primary" onclick="nextOnboardStep()">Continue →</button>'}
    `;
}

function nextOnboardStep() {
    const role = APP_STATE.currentRole;
    const steps = (ONBOARDING_CONFIGS[role] || ONBOARDING_CONFIGS.admin).steps;
    if (APP_STATE.onboardStep < steps.length - 1) {
        APP_STATE.onboardStep++;
        renderOnboardingStep();
    }
}

function prevOnboardStep() {
    if (APP_STATE.onboardStep > 0) {
        APP_STATE.onboardStep--;
        renderOnboardingStep();
    }
}

function goToOnboardStep(idx) {
    APP_STATE.onboardStep = idx;
    renderOnboardingStep();
}

function skipOnboarding() {
    finishOnboarding();
}

function finishOnboarding() {
    document.getElementById('onboarding-overlay').classList.remove('active');
    APP_STATE.onboardingComplete[APP_STATE.currentRole] = true;
    APP_STATE.appMode = 'explore';
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('[data-mode="explore"]').classList.add('active');
    showToast('Onboarding complete! Explore the platform freely.', 'success');
}

// ========== INITIALIZATION ==========
function initializeApp() {
    const role = ROLES[APP_STATE.currentRole];

    // Update header role display
    document.getElementById('role-dot').style.backgroundColor = role.color;
    document.getElementById('role-name').textContent = role.name.split(' ')[0];

    // Build role dropdown
    renderRoleDropdown();
    buildNavigation();
    switchToView('dashboard', '📊 Dashboard');

    // Role switcher toggle
    document.getElementById('role-button').addEventListener('click', () => {
        document.getElementById('role-dropdown').classList.toggle('open');
    });

    // Close dropdown on outside click
    document.addEventListener('click', (e) => {
        if (!e.target.closest('.role-switcher')) {
            document.getElementById('role-dropdown').classList.remove('open');
        }
    });

    // Modal close
    document.getElementById('modal-close').addEventListener('click', closeModal);
    document.getElementById('modal-overlay').addEventListener('click', (e) => {
        if (e.target === document.getElementById('modal-overlay')) {
            closeModal();
        }
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeModal();
    });
}

function renderRoleDropdown() {
    const dropdown = document.getElementById('role-dropdown');
    dropdown.innerHTML = '';
    Object.entries(ROLES).forEach(([id, role]) => {
        const option = document.createElement('div');
        option.className = `role-option ${id === APP_STATE.currentRole ? 'active' : ''}`;
        option.innerHTML = `
            <div>
                <span class="role-dot" style="background-color: ${role.color}"></span>
                <strong>${role.name}</strong>
                <div class="role-option-role">${role.title}</div>
            </div>
            ${id === APP_STATE.currentRole ? '<span class="role-option-checkmark">✓</span>' : ''}
        `;
        option.addEventListener('click', () => switchRole(id));
        dropdown.appendChild(option);
    });
}


// Bridge removed - unified createView handles all views directly

// ============================================================
// AGENTIC TRUST LAYER v3.0 - Part 2: View Implementations
// ETHDenver 2026 BUIDLathon | PROSPERIA Track
// ============================================================

/**
 * 1. COORDINATION HUB
 * Coordinator's main workspace with matching queue and collaboration tools
 */
function renderCoordinationHub(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Coordination Hub</h1>
        <p class="text-muted">Active matching and coordinator collaboration</p>
      </div>

      <!-- Stat Cards -->
      <div class="stat-grid">
        <div class="stat-card">
          <div class="stat-label">Active Needs</div>
          <div class="stat-value">23</div>
          <div class="stat-subtext">+3 this week</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Pending Matches</div>
          <div class="stat-value">12</div>
          <div class="stat-subtext">2 high priority</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Match Success Rate</div>
          <div class="stat-value">87%</div>
          <div class="stat-subtext">+5% from last month</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Avg Time to Match</div>
          <div class="stat-value">3.2d</div>
          <div class="stat-subtext">-1.1d improvement</div>
        </div>
      </div>

      <!-- Active Matching Queue -->
      <div class="card">
        <div class="card-header">
          <h2>Active Matching Queue</h2>
          <div class="card-header-actions">
            <button class="btn btn-sm btn-secondary" onclick="showToast('Refreshing queue...', 'info')">↻ Refresh</button>
          </div>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Need ID</th>
                <th>Organization</th>
                <th>Skills Required</th>
                <th>Candidates</th>
                <th>Match Score</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>#N-2401</strong></td>
                <td>Community Health Plus</td>
                <td><span class="badge">Data Analysis</span> <span class="badge">Python</span></td>
                <td>4</td>
                <td><strong style="color: #22c55e;">94%</strong></td>
                <td><button class="btn btn-sm btn-primary" onclick="showMatchModal('N-2401', 'Community Health Plus', 4)">Review Matches</button></td>
              </tr>
              <tr>
                <td><strong>#N-2402</strong></td>
                <td>DFW Education Collective</td>
                <td><span class="badge">Curriculum Dev</span> <span class="badge">Education</span></td>
                <td>3</td>
                <td><strong style="color: #22c55e;">89%</strong></td>
                <td><button class="btn btn-sm btn-primary" onclick="showMatchModal('N-2402', 'DFW Education Collective', 3)">Review Matches</button></td>
              </tr>
              <tr>
                <td><strong>#N-2403</strong></td>
                <td>Tech for Social Good</td>
                <td><span class="badge">DevOps</span> <span class="badge">Cloud</span></td>
                <td>2</td>
                <td><strong style="color: #f59e0b;">76%</strong></td>
                <td><button class="btn btn-sm btn-primary" onclick="showMatchModal('N-2403', 'Tech for Social Good', 2)">Review Matches</button></td>
              </tr>
              <tr>
                <td><strong>#N-2404</strong></td>
                <td>Housing First DFW</td>
                <td><span class="badge">Grants</span> <span class="badge">Nonprofit Ops</span></td>
                <td>5</td>
                <td><strong style="color: #22c55e;">91%</strong></td>
                <td><button class="btn btn-sm btn-primary" onclick="showMatchModal('N-2404', 'Housing First DFW', 5)">Review Matches</button></td>
              </tr>
              <tr>
                <td><strong>#N-2405</strong></td>
                <td>Urban Agriculture Initiative</td>
                <td><span class="badge">Sustainability</span> <span class="badge">Project Mgmt</span></td>
                <td>3</td>
                <td><strong style="color: #3b82f6;">82%</strong></td>
                <td><button class="btn btn-sm btn-primary" onclick="showMatchModal('N-2405', 'Urban Agriculture Initiative', 3)">Review Matches</button></td>
              </tr>
              <tr>
                <td><strong>#N-2406</strong></td>
                <td>Youth Workforce Alliance</td>
                <td><span class="badge">Training</span> <span class="badge">Career Development</span></td>
                <td>6</td>
                <td><strong style="color: #22c55e;">93%</strong></td>
                <td><button class="btn btn-sm btn-primary" onclick="showMatchModal('N-2406', 'Youth Workforce Alliance', 6)">Review Matches</button></td>
              </tr>
              <tr>
                <td><strong>#N-2407</strong></td>
                <td>Mental Health Services Coalition</td>
                <td><span class="badge">Mental Health</span> <span class="badge">Community Outreach</span></td>
                <td>2</td>
                <td><strong style="color: #ef4444;">65%</strong></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showToast('Need more candidates', 'warning')">Expand Search</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Coordinator Collaboration -->
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <h2>Online Coordinators</h2>
          </div>
          <div style="padding: 1.5rem; display: flex; flex-direction: column; gap: 1rem;">
            <div style="display: flex; align-items: center; justify-content: space-between;">
              <div style="display: flex; align-items: center; gap: 0.75rem;">
                <div style="width: 12px; height: 12px; border-radius: 50%; background: #22c55e;"></div>
                <div>
                  <div style="font-weight: 500;">Sarah Chen</div>
                  <div class="text-sm text-muted">Healthcare Sector</div>
                </div>
              </div>
              <span class="badge badge-active">Active</span>
            </div>
            <div style="display: flex; align-items: center; justify-content: space-between;">
              <div style="display: flex; align-items: center; gap: 0.75rem;">
                <div style="width: 12px; height: 12px; border-radius: 50%; background: #22c55e;"></div>
                <div>
                  <div style="font-weight: 500;">Marcus Rodriguez</div>
                  <div class="text-sm text-muted">Education Sector</div>
                </div>
              </div>
              <span class="badge badge-active">Active</span>
            </div>
            <div style="display: flex; align-items: center; justify-content: space-between;">
              <div style="display: flex; align-items: center; gap: 0.75rem;">
                <div style="width: 12px; height: 12px; border-radius: 50%; background: #a1a5a9;"></div>
                <div>
                  <div style="font-weight: 500;">Jennifer Lopez</div>
                  <div class="text-sm text-muted">Housing Sector</div>
                </div>
              </div>
              <span class="badge badge-pending">Away</span>
            </div>
            <div style="display: flex; align-items: center; justify-content: space-between;">
              <div style="display: flex; align-items: center; gap: 0.75rem;">
                <div style="width: 12px; height: 12px; border-radius: 50%; background: #22c55e;"></div>
                <div>
                  <div style="font-weight: 500;">David Kim</div>
                  <div class="text-sm text-muted">Tech Sector</div>
                </div>
              </div>
              <span class="badge badge-active">Active</span>
            </div>
          </div>
        </div>

        <!-- Recent Match Activity Timeline -->
        <div class="card">
          <div class="card-header">
            <h2>Recent Match Activity</h2>
          </div>
          <div class="timeline" style="padding: 1.5rem;">
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #22c55e;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">Match Confirmed</div>
                <div class="text-sm text-muted">Alex Martinez → Community Health Plus</div>
                <div class="text-sm text-muted">2 hours ago</div>
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #3b82f6;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">Match Proposed</div>
                <div class="text-sm text-muted">4 candidates for DFW Education Collective</div>
                <div class="text-sm text-muted">3 hours ago</div>
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #22c55e;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">Engagement Started</div>
                <div class="text-sm text-muted">Jordan Lee began work at Tech for Social Good</div>
                <div class="text-sm text-muted">5 hours ago</div>
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #8b5cf6;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">Need Created</div>
                <div class="text-sm text-muted">Housing First DFW posted 2 positions</div>
                <div class="text-sm text-muted">7 hours ago</div>
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #22c55e;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">Milestone Completed</div>
                <div class="text-sm text-muted">Urban Agriculture Initiative Phase 1 verified</div>
                <div class="text-sm text-muted">Yesterday</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * 2. OPPORTUNITIES BROWSER
 * Contributor-facing opportunity discovery with filters and applications
 */
function renderOpportunities(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Opportunities</h1>
        <p class="text-muted">Discover and apply for engagements</p>
      </div>

      <!-- Filter Bar -->
      <div class="card" style="margin-bottom: 2rem;">
        <div style="padding: 1.5rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
          <div class="form-group">
            <label>Sector</label>
            <select onchange="showToast('Filter applied', 'info')">
              <option>All Sectors</option>
              <option>Healthcare</option>
              <option>Education</option>
              <option>Housing</option>
              <option>Technology</option>
              <option>Environment</option>
            </select>
          </div>
          <div class="form-group">
            <label>Skill Type</label>
            <select onchange="showToast('Filter applied', 'info')">
              <option>All Skills</option>
              <option>Data Analysis</option>
              <option>Project Management</option>
              <option>Development</option>
              <option>Operations</option>
              <option>Grants Writing</option>
            </select>
          </div>
          <div class="form-group">
            <label>Duration</label>
            <select onchange="showToast('Filter applied', 'info')">
              <option>All Durations</option>
              <option>1-2 weeks</option>
              <option>1-3 months</option>
              <option>3-6 months</option>
              <option>6+ months</option>
            </select>
          </div>
          <div class="form-group">
            <label>Sort By</label>
            <select onchange="showToast('Sorted', 'info')">
              <option>Best Match</option>
              <option>Most Recent</option>
              <option>Highest Budget</option>
              <option>Ending Soon</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Opportunities Grid -->
      <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem;">
        ${renderOpportunityCard('OPP-001', 'Data Analytics for Community Health', 'Community Health Plus', '6 weeks', '$3,500', ['Data Analysis', 'Python', 'Health'], 94)}
        ${renderOpportunityCard('OPP-002', 'Curriculum Development Specialist', 'DFW Education Collective', '3 months', '$5,200', ['Education', 'Curriculum Design', 'Writing'], 89)}
        ${renderOpportunityCard('OPP-003', 'DevOps Infrastructure Lead', 'Tech for Social Good', '4 months', '$7,800', ['DevOps', 'AWS', 'Kubernetes'], 76)}
        ${renderOpportunityCard('OPP-004', 'Grants Writer & Manager', 'Housing First DFW', '6 months', '$6,000', ['Grants', 'Nonprofit Ops', 'Writing'], 91)}
        ${renderOpportunityCard('OPP-005', 'Sustainability Coordinator', 'Urban Agriculture Initiative', '3 months', '$4,200', ['Sustainability', 'Project Mgmt', 'Environment'], 82)}
        ${renderOpportunityCard('OPP-006', 'Youth Career Coach', 'Youth Workforce Alliance', '2 months', '$2,800', ['Coaching', 'Career Dev', 'Training'], 88)}
        ${renderOpportunityCard('OPP-007', 'Community Outreach Manager', 'Mental Health Services Coalition', '4 months', '$5,500', ['Community Outreach', 'Mental Health', 'Events'], 79)}
        ${renderOpportunityCard('OPP-008', 'Impact Measurement Analyst', 'Healthcare Access Initiative', '3 months', '$4,800', ['Data Analysis', 'Impact Measurement', 'Research'], 85)}
      </div>
    </div>
  `;
  return html;
}

function renderOpportunityCard(id, title, org, duration, budget, skills, match) {
  return `
    <div class="opportunity-card card" onclick="showOpportunityModal('${id}', '${title}', '${org}', '${duration}', '${budget}', ${JSON.stringify(skills)}, ${match})" style="cursor: pointer;">
      <div class="opportunity-header">
        <h3 style="margin: 0 0 0.5rem 0;">${title}</h3>
        <div class="text-sm text-muted">${org}</div>
      </div>
      <div class="match-indicator" style="margin: 1rem 0;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
          <span style="font-size: 0.875rem;">Your Match</span>
          <strong style="color: ${match >= 90 ? '#22c55e' : match >= 80 ? '#3b82f6' : '#f59e0b'};">${match}%</strong>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" style="width: ${match}%; background: ${match >= 90 ? '#22c55e' : match >= 80 ? '#3b82f6' : '#f59e0b'};"></div>
        </div>
      </div>
      <div class="opportunity-details">
        <div class="opportunity-detail-item">
          <span class="text-sm text-muted">Duration:</span>
          <strong>${duration}</strong>
        </div>
        <div class="opportunity-detail-item">
          <span class="text-sm text-muted">Budget:</span>
          <strong>${budget}</strong>
        </div>
      </div>
      <div style="margin-top: 1rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
        ${skills.map(s => `<span class="badge" style="background: #e0e7ff; color: #4f46e5; font-size: 0.75rem;">${s}</span>`).join('')}
      </div>
      <div style="margin-top: 1rem; display: flex; gap: 0.75rem;">
        <button class="btn btn-sm btn-primary" onclick="event.stopPropagation(); showToast('Application submitted!', 'success')">Apply</button>
        <button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); showToast('Saved for later', 'info')">Save</button>
      </div>
    </div>
  `;
}

/**
 * 3. MY ENGAGEMENTS
 * Contributor's engagement tracker with active, completed, and pending
 */
function renderMyEngagements(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>My Engagements</h1>
        <p class="text-muted">Track your active work and completed projects</p>
      </div>

      <!-- Tab Navigation -->
      <div class="card" style="margin-bottom: 2rem;">
        <div style="padding: 0; display: flex; border-bottom: 1px solid #e5e7eb;">
          <button class="btn" style="border-radius: 0; border: none; flex: 1; padding: 1rem; text-align: left; font-weight: 500; background: transparent; border-bottom: 3px solid #3b82f6;" onclick="switchTab('active')">
            Active <span class="badge" style="margin-left: 0.5rem;">2</span>
          </button>
          <button class="btn" style="border-radius: 0; border: none; flex: 1; padding: 1rem; text-align: left; font-weight: 500; background: transparent;" onclick="switchTab('completed')">
            Completed <span class="badge" style="margin-left: 0.5rem;">14</span>
          </button>
          <button class="btn" style="border-radius: 0; border: none; flex: 1; padding: 1rem; text-align: left; font-weight: 500; background: transparent;" onclick="switchTab('pending')">
            Pending <span class="badge" style="margin-left: 0.5rem;">1</span>
          </button>
        </div>
      </div>

      <!-- Active Tab Content -->
      <div id="tab-active">
        <div class="grid-2" style="gap: 1.5rem;">
          <!-- Engagement 1 -->
          <div class="card">
            <div class="card-header">
              <div>
                <h3>Data Analytics Project</h3>
                <div class="text-sm text-muted">Community Health Plus</div>
              </div>
            </div>
            <div style="padding: 1.5rem;">
              <div style="margin-bottom: 1.5rem;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Progress</span>
                  <strong>65%</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 65%;"></div>
                </div>
              </div>
              <div style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                <div style="font-weight: 500; margin-bottom: 0.5rem;">Milestones</div>
                <ul style="margin: 0; padding-left: 1.5rem; list-style: none;">
                  <li style="margin-bottom: 0.5rem;"><input type="checkbox" checked> Phase 1 Complete</li>
                  <li style="margin-bottom: 0.5rem;"><input type="checkbox" checked> Data Collection</li>
                  <li style="margin-bottom: 0.5rem;"><input type="checkbox"> Analysis & Report</li>
                  <li style="margin-bottom: 0;"><input type="checkbox"> Final Review</li>
                </ul>
              </div>
              <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                <strong style="color: #d97706;">Next Deadline:</strong> <span style="color: #92400e;">Feb 27, 2026</span>
              </div>
              <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem;">
                <div class="text-sm text-muted">Organization Contact</div>
                <div style="font-weight: 500;">Dr. Sarah Williams</div>
                <div class="text-sm text-muted">sarah@commhealth.org</div>
              </div>
            </div>
          </div>

          <!-- Engagement 2 -->
          <div class="card">
            <div class="card-header">
              <div>
                <h3>Grants Development Support</h3>
                <div class="text-sm text-muted">Housing First DFW</div>
              </div>
            </div>
            <div style="padding: 1.5rem;">
              <div style="margin-bottom: 1.5rem;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Progress</span>
                  <strong>42%</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 42%;"></div>
                </div>
              </div>
              <div style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                <div style="font-weight: 500; margin-bottom: 0.5rem;">Milestones</div>
                <ul style="margin: 0; padding-left: 1.5rem; list-style: none;">
                  <li style="margin-bottom: 0.5rem;"><input type="checkbox" checked> Grant Research</li>
                  <li style="margin-bottom: 0.5rem;"><input type="checkbox"> Application Drafts</li>
                  <li style="margin-bottom: 0.5rem;"><input type="checkbox"> Submission Prep</li>
                  <li style="margin-bottom: 0;"><input type="checkbox"> Support Calls</li>
                </ul>
              </div>
              <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                <strong style="color: #d97706;">Next Deadline:</strong> <span style="color: #92400e;">Mar 5, 2026</span>
              </div>
              <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem;">
                <div class="text-sm text-muted">Organization Contact</div>
                <div style="font-weight: 500;">Marcus Thompson</div>
                <div class="text-sm text-muted">marcus@housingfirst.org</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Completed Tab Content (hidden by default) -->
      <div id="tab-completed" style="display: none;">
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Organization</th>
                <th>Scope</th>
                <th>Completed</th>
                <th>Duration</th>
                <th>Attestation</th>
                <th>Rating</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Tech Skills Academy</strong></td>
                <td>Curriculum Design</td>
                <td>Jan 15, 2026</td>
                <td>8 weeks</td>
                <td><span class="badge badge-success">Verified</span></td>
                <td>⭐⭐⭐⭐⭐ 5.0</td>
              </tr>
              <tr>
                <td><strong>Community Garden Initiative</strong></td>
                <td>Project Management</td>
                <td>Jan 8, 2026</td>
                <td>4 weeks</td>
                <td><span class="badge badge-success">Verified</span></td>
                <td>⭐⭐⭐⭐⭐ 5.0</td>
              </tr>
              <tr>
                <td><strong>Healthcare Access Coalition</strong></td>
                <td>Data Analysis</td>
                <td>Dec 28, 2025</td>
                <td>6 weeks</td>
                <td><span class="badge badge-success">Verified</span></td>
                <td>⭐⭐⭐⭐ 4.5</td>
              </tr>
              <tr>
                <td><strong>Youth Employment Network</strong></td>
                <td>Training Delivery</td>
                <td>Dec 15, 2025</td>
                <td>3 weeks</td>
                <td><span class="badge badge-success">Verified</span></td>
                <td>⭐⭐⭐⭐⭐ 4.8</td>
              </tr>
              <tr>
                <td><strong>Social Impact Research Lab</strong></td>
                <td>Research Assistance</td>
                <td>Nov 30, 2025</td>
                <td>5 weeks</td>
                <td><span class="badge badge-success">Verified</span></td>
                <td>⭐⭐⭐⭐ 4.7</td>
              </tr>
              <tr>
                <td><strong>Economic Opportunity Fund</strong></td>
                <td>Grant Writing</td>
                <td>Nov 10, 2025</td>
                <td>6 weeks</td>
                <td><span class="badge badge-success">Verified</span></td>
                <td>⭐⭐⭐⭐⭐ 4.9</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Pending Tab Content (hidden by default) -->
      <div id="tab-pending" style="display: none;">
        <div class="card">
          <div class="card-header">
            <h3>Proposal Awaiting Approval</h3>
          </div>
          <div style="padding: 1.5rem;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
              <div>
                <div class="text-sm text-muted">Organization</div>
                <strong>Urban Agriculture Initiative</strong>
              </div>
              <div>
                <div class="text-sm text-muted">Submitted</div>
                <strong>Feb 18, 2026</strong>
              </div>
              <div>
                <div class="text-sm text-muted">Requested Scope</div>
                <strong>Sustainability Coordinator (3 months)</strong>
              </div>
              <div>
                <div class="text-sm text-muted">Status</div>
                <span class="badge badge-pending">Awaiting Review</span>
              </div>
            </div>
            <div style="background: #f0f9ff; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; border-left: 4px solid #0284c7;">
              <div class="text-sm text-muted" style="color: #0284c7;">Expected Response</div>
              <strong>By Feb 25, 2026</strong>
            </div>
            <button class="btn btn-primary" onclick="showToast('Proposal withdrawn', 'info')">Withdraw Proposal</button>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * 4. MY REPUTATION
 * Contributor reputation dashboard with tier progression and attestations
 */
function renderMyReputation(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>My Reputation</h1>
        <p class="text-muted">Your trust tier, attestations, and portable reputation</p>
      </div>

      <!-- Trust Tier Display -->
      <div class="card" style="margin-bottom: 2rem;">
        <div style="padding: 2rem; text-align: center;">
          <div style="font-size: 0.875rem; text-transform: uppercase; color: #6b7280; letter-spacing: 0.05em; margin-bottom: 1rem;">Current Trust Tier</div>
          <div style="display: flex; justify-content: center; gap: 1rem; margin-bottom: 2rem;">
            <div style="text-align: center;">
              <div style="font-size: 0.75rem; color: #9ca3af;">Observer</div>
              <div style="width: 60px; height: 60px; border-radius: 50%; background: #e5e7eb; display: flex; align-items: center; justify-content: center; color: #6b7280; font-weight: bold;">1</div>
            </div>
            <div style="text-align: center;">
              <div style="font-size: 0.75rem; color: #9ca3af;">Advisor</div>
              <div style="width: 60px; height: 60px; border-radius: 50%; background: #e5e7eb; display: flex; align-items: center; justify-content: center; color: #6b7280; font-weight: bold;">2</div>
            </div>
            <div style="text-align: center;">
              <div style="font-size: 0.75rem; color: #059669; font-weight: bold;">Coordinator</div>
              <div style="width: 60px; height: 60px; border-radius: 50%; background: #d1fae5; display: flex; align-items: center; justify-content: center; color: #059669; font-weight: bold; border: 3px solid #059669;">3</div>
            </div>
            <div style="text-align: center;">
              <div style="font-size: 0.75rem; color: #9ca3af;">Steward</div>
              <div style="width: 60px; height: 60px; border-radius: 50%; background: #e5e7eb; display: flex; align-items: center; justify-content: center; color: #6b7280; font-weight: bold;">4</div>
            </div>
          </div>
          <h2 style="margin: 0 0 1rem 0;">Coordinator</h2>
          <div class="text-muted" style="margin-bottom: 1.5rem;">Achieved Feb 10, 2026</div>

          <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 0.5rem; padding: 1rem; text-align: left; margin-bottom: 1rem;">
            <div style="font-weight: 500; color: #059669; margin-bottom: 0.5rem;">Next Tier: Steward</div>
            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.75rem;">Requirements for promotion:</div>
            <ul style="margin: 0; padding-left: 1.5rem; font-size: 0.875rem;">
              <li style="margin-bottom: 0.5rem;">✓ 10+ completed engagements <strong>(14/10)</strong></li>
              <li style="margin-bottom: 0.5rem;">• 5+ successful matches facilitated <strong>(2/5)</strong></li>
              <li style="margin-bottom: 0.5rem;">✓ Average rating 4.5+ <strong>(4.7/4.5)</strong></li>
              <li>• 50+ total hours contributed <strong>(38/50)</strong></li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Stats -->
      <div class="stat-grid">
        <div class="stat-card">
          <div class="stat-label">Total Attestations</div>
          <div class="stat-value">14</div>
          <div class="stat-subtext">Verified on-chain</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Completed Engagements</div>
          <div class="stat-value">14</div>
          <div class="stat-subtext">100% success rate</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Average Rating</div>
          <div class="stat-value">4.7/5</div>
          <div class="stat-subtext">Highly trusted</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Skills Verified</div>
          <div class="stat-value">6</div>
          <div class="stat-subtext">Skill attestations</div>
        </div>
      </div>

      <!-- Portable Reputation -->
      <div class="card">
        <div class="card-header">
          <h2>Portable Reputation</h2>
          <div class="card-header-actions">
            <button class="btn btn-sm btn-secondary" onclick="showToast('Reputation exported to clipboard', 'success')">Export</button>
          </div>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
            <div style="background: #f0f9ff; border: 1px solid #bfdbfe; border-radius: 0.5rem; padding: 1rem;">
              <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <div style="width: 20px; height: 20px; border-radius: 50%; background: #0284c7;"></div>
                <span class="badge badge-base">BASE Chain</span>
              </div>
              <div class="text-sm text-muted">ERC-8004 Identity</div>
              <div style="font-family: monospace; font-size: 0.75rem; word-break: break-all; margin-top: 0.5rem; color: #0284c7;">0x7a3c...2ef9</div>
            </div>
            <div style="background: #f3f0ff; border: 1px solid #ddd6fe; border-radius: 0.5rem; padding: 1rem;">
              <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <div style="width: 20px; height: 20px; border-radius: 50%; background: #7c3aed;"></div>
                <span class="badge badge-eth">Ethereum</span>
              </div>
              <div class="text-sm text-muted">Cross-chain Attestations</div>
              <div style="font-family: monospace; font-size: 0.75rem; word-break: break-all; margin-top: 0.5rem; color: #7c3aed;">0x2b1f...8a47</div>
            </div>
            <div style="background: #fef3c7; border: 1px solid #fde68a; border-radius: 0.5rem; padding: 1rem;">
              <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <div style="width: 20px; height: 20px; border-radius: 50%; background: #f59e0b;"></div>
                <span class="badge badge-linea">Linea</span>
              </div>
              <div class="text-sm text-muted">Portable Reputation Registry</div>
              <div style="font-family: monospace; font-size: 0.75rem; word-break: break-all; margin-top: 0.5rem; color: #f59e0b;">0x9e4d...5f12</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Skill Attestations -->
      <div class="card">
        <div class="card-header">
          <h2>Skill Attestations</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Skill</th>
                <th>Attested By</th>
                <th>Date</th>
                <th>Chain</th>
                <th>Tx Hash</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Data Analysis</strong></td>
                <td>Community Health Plus</td>
                <td>Jan 20, 2026</td>
                <td><span class="badge badge-base">BASE</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;">0x7c3a...9f24</td>
              </tr>
              <tr>
                <td><strong>Project Management</strong></td>
                <td>Tech Skills Academy</td>
                <td>Jan 15, 2026</td>
                <td><span class="badge badge-eth">ETH</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;">0x5b2e...1a88</td>
              </tr>
              <tr>
                <td><strong>Training Delivery</strong></td>
                <td>Youth Employment Network</td>
                <td>Dec 20, 2025</td>
                <td><span class="badge badge-base">BASE</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;">0x3a1f...4b72</td>
              </tr>
              <tr>
                <td><strong>Grant Writing</strong></td>
                <td>Economic Opportunity Fund</td>
                <td>Nov 15, 2025</td>
                <td><span class="badge badge-linea">LINEA</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;">0x9e2c...7d59</td>
              </tr>
              <tr>
                <td><strong>Community Engagement</strong></td>
                <td>Healthcare Access Coalition</td>
                <td>Nov 10, 2025</td>
                <td><span class="badge badge-eth">ETH</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;">0x4d1a...2e91</td>
              </tr>
              <tr>
                <td><strong>Sustainability Practices</strong></td>
                <td>Community Garden Initiative</td>
                <td>Oct 25, 2025</td>
                <td><span class="badge badge-base">BASE</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;">0x6f3b...8c45</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Tier History -->
      <div class="card">
        <div class="card-header">
          <h2>Tier History</h2>
        </div>
        <div class="timeline" style="padding: 1.5rem;">
          <div class="timeline-item">
            <div class="timeline-dot" style="background: #22c55e;"></div>
            <div class="timeline-content">
              <div style="font-weight: 500;">Promoted to Coordinator</div>
              <div class="text-sm text-muted">Unlocked matching and facilitation capabilities</div>
              <div class="text-sm text-muted">Feb 10, 2026</div>
            </div>
          </div>
          <div class="timeline-item">
            <div class="timeline-dot" style="background: #3b82f6;"></div>
            <div class="timeline-content">
              <div style="font-weight: 500;">Promoted to Advisor</div>
              <div class="text-sm text-muted">Completed 5 engagements with excellent ratings</div>
              <div class="text-sm text-muted">Aug 15, 2025</div>
            </div>
          </div>
          <div class="timeline-item">
            <div class="timeline-dot" style="background: #a1a5a9;"></div>
            <div class="timeline-content">
              <div style="font-weight: 500;">Started as Observer</div>
              <div class="text-sm text-muted">Initial registration on Unite DFW</div>
              <div class="text-sm text-muted">May 1, 2025</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * 5. WALLET
 * ERC-4337 smart wallet view with accounts, sessions, escrow
 */
function renderWallet(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Smart Wallet</h1>
        <p class="text-muted">Account abstraction, session keys, and escrow management</p>
      </div>

      <!-- Wallet Address -->
      <div class="card" style="margin-bottom: 2rem;">
        <div style="padding: 1.5rem;">
          <div class="text-sm text-muted" style="margin-bottom: 0.5rem;">Wallet Address</div>
          <div style="display: flex; align-items: center; gap: 1rem;">
            <div style="font-family: monospace; font-size: 1rem; font-weight: 500; word-break: break-all;">0x7a3c2b9f1e8d4a5c6b7e9f2d3a4b5c6d7e8f9a0b</div>
            <button class="btn btn-sm btn-secondary" onclick="showToast('Address copied to clipboard', 'success')">Copy</button>
          </div>
        </div>
      </div>

      <!-- Balance Cards -->
      <div class="stat-grid">
        <div class="stat-card">
          <div class="stat-label">ETH Balance</div>
          <div class="stat-value">2.45</div>
          <div class="stat-subtext">≈ $4,410 USD</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">USDC Balance</div>
          <div class="stat-value">8,750</div>
          <div class="stat-subtext">Ready to spend</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Escrowed Funds</div>
          <div class="stat-value">6,200</div>
          <div class="stat-subtext">In 3 engagements</div>
        </div>
      </div>

      <!-- Active Session Keys -->
      <div class="card">
        <div class="card-header">
          <h2>Active Session Keys</h2>
          <div class="card-header-actions">
            <button class="btn btn-sm btn-primary" onclick="showToast('New session key created', 'success')">+ New Session Key</button>
          </div>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Session ID</th>
                <th>Scope</th>
                <th>Expires</th>
                <th>Spending Limit</th>
                <th>Used</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="font-family: monospace; font-size: 0.75rem;">0x5c7e...2d91</td>
                <td><span class="badge">Apply Opportunities</span></td>
                <td>Mar 5, 2026</td>
                <td>2,000 USDC</td>
                <td>340 USDC</td>
                <td><button class="btn btn-sm btn-secondary" onclick="showToast('Session key revoked', 'info')">Revoke</button></td>
              </tr>
              <tr>
                <td style="font-family: monospace; font-size: 0.75rem;">0x9a2f...4c67</td>
                <td><span class="badge">Pay Fees</span></td>
                <td>Feb 28, 2026</td>
                <td>500 USDC</td>
                <td>187 USDC</td>
                <td><button class="btn btn-sm btn-secondary" onclick="showToast('Session key revoked', 'info')">Revoke</button></td>
              </tr>
              <tr>
                <td style="font-family: monospace; font-size: 0.75rem;">0x3b1d...8e5a</td>
                <td><span class="badge">Escrow Operations</span></td>
                <td>Apr 20, 2026</td>
                <td>10,000 USDC</td>
                <td>0 USDC</td>
                <td><button class="btn btn-sm btn-secondary" onclick="showToast('Session key revoked', 'info')">Revoke</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Transaction History -->
      <div class="card">
        <div class="card-header">
          <h2>Transaction History</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Amount</th>
                <th>From / To</th>
                <th>Status</th>
                <th>Tx Hash</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Feb 19, 2026</td>
                <td><span class="badge" style="background: #d1fae5;">Escrow Deposit</span></td>
                <td>2,500 USDC</td>
                <td>Housing First DFW</td>
                <td><span class="badge badge-success">Confirmed</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x7f4a...2b8c</a></td>
              </tr>
              <tr>
                <td>Feb 18, 2026</td>
                <td><span class="badge" style="background: #fef3c7;">Milestone Payment</span></td>
                <td>1,500 USDC</td>
                <td>Community Health Plus</td>
                <td><span class="badge badge-success">Confirmed</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x5c2d...9e17</a></td>
              </tr>
              <tr>
                <td>Feb 17, 2026</td>
                <td><span class="badge" style="background: #f3e8ff;">Gas Sponsorship</span></td>
                <td>45 USDC</td>
                <td>Unite DFW Network</td>
                <td><span class="badge badge-success">Confirmed</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x3a1b...7c52</a></td>
              </tr>
              <tr>
                <td>Feb 15, 2026</td>
                <td><span class="badge" style="background: #dbeafe;">Token Transfer</span></td>
                <td>5,000 USDC</td>
                <td>From: Coinbase Wallet</td>
                <td><span class="badge badge-success">Confirmed</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x8e5f...3d24</a></td>
              </tr>
              <tr>
                <td>Feb 10, 2026</td>
                <td><span class="badge" style="background: #d1fae5;">Escrow Deposit</span></td>
                <td>1,800 USDC</td>
                <td>Tech for Social Good</td>
                <td><span class="badge badge-success">Confirmed</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x2b7e...9a41</a></td>
              </tr>
              <tr>
                <td>Feb 8, 2026</td>
                <td><span class="badge" style="background: #fef3c7;">Milestone Payment</span></td>
                <td>1,200 USDC</td>
                <td>DFW Education Collective</td>
                <td><span class="badge badge-success">Confirmed</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x6d3c...5f18</a></td>
              </tr>
              <tr>
                <td>Feb 5, 2026</td>
                <td><span class="badge" style="background: #f3e8ff;">Gas Sponsorship</span></td>
                <td>38 USDC</td>
                <td>Unite DFW Network</td>
                <td><span class="badge badge-success">Confirmed</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x4a2d...8b35</a></td>
              </tr>
              <tr>
                <td>Feb 1, 2026</td>
                <td><span class="badge" style="background: #dbeafe;">Token Transfer</span></td>
                <td>3,000 USDC</td>
                <td>From: Bank Wire</td>
                <td><span class="badge badge-success">Confirmed</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x7f1a...2e49</a></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Escrow Contracts -->
      <div class="card">
        <div class="card-header">
          <h2>Active Escrow Contracts</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
            <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Community Health Plus - Data Analytics</div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem; margin-bottom: 1rem;">
                <div>
                  <div class="text-muted">Escrowed</div>
                  <strong>2,500 USDC</strong>
                </div>
                <div>
                  <div class="text-muted">Release Condition</div>
                  <strong>Phase 2 Complete</strong>
                </div>
              </div>
              <div style="background: #f0fdf4; padding: 0.75rem; border-radius: 0.25rem; font-size: 0.75rem; color: #047857; margin-bottom: 1rem;">
                ✓ Phase 1 released (1,250 USDC)
              </div>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Release requested', 'info')">Request Release</button>
            </div>

            <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Housing First DFW - Grants Writing</div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem; margin-bottom: 1rem;">
                <div>
                  <div class="text-muted">Escrowed</div>
                  <strong>1,800 USDC</strong>
                </div>
                <div>
                  <div class="text-muted">Release Condition</div>
                  <strong>Grant Submitted</strong>
                </div>
              </div>
              <div style="background: #fffbeb; padding: 0.75rem; border-radius: 0.25rem; font-size: 0.75rem; color: #b45309; margin-bottom: 1rem;">
                ⏳ Awaiting milestone verification
              </div>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Release requested', 'info')">Request Release</button>
            </div>

            <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
              <div style="font-weight: 500; margin-bottom: 0.5rem;">Tech for Social Good - Infrastructure</div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem; margin-bottom: 1rem;">
                <div>
                  <div class="text-muted">Escrowed</div>
                  <strong>1,900 USDC</strong>
                </div>
                <div>
                  <div class="text-muted">Release Condition</div>
                  <strong>System Live + Audited</strong>
                </div>
              </div>
              <div style="background: #fffbeb; padding: 0.75rem; border-radius: 0.25rem; font-size: 0.75rem; color: #b45309; margin-bottom: 1rem;">
                ⏳ Awaiting milestone verification
              </div>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Release requested', 'info')">Request Release</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * 6. ECOSYSTEM MAP
 * Network visualization with nodes and connections
 */
function renderEcosystemMap(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Ecosystem Map</h1>
        <p class="text-muted">United DFW network of organizations, contributors, and agents</p>
      </div>

      <!-- Stats Bar -->
      <div class="stat-grid">
        <div class="stat-card">
          <div class="stat-label">Organizations</div>
          <div class="stat-value">10</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Contributors</div>
          <div class="stat-value">8</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Agents</div>
          <div class="stat-value">5</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Connections</div>
          <div class="stat-value">47</div>
        </div>
      </div>

      <!-- Network Visualization -->
      <div class="card" style="margin-bottom: 2rem;">
        <div style="width: 100%; height: 500px; background: linear-gradient(135deg, #f0f9ff 0%, #f0fdf4 100%); border-radius: 0.5rem; position: relative; overflow: hidden;">
          <!-- Center organization -->
          <div style="position: absolute; top: 50%; left: 50%; width: 60px; height: 60px; margin-left: -30px; margin-top: -30px; background: #0284c7; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.875rem; z-index: 10; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            Unite DFW
          </div>

          <!-- Organization nodes -->
          <div style="position: absolute; top: 15%; left: 10%; width: 50px; height: 50px; background: #ec4899; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.75rem; text-align: center;">Health</div>
          <div style="position: absolute; top: 15%; right: 10%; width: 50px; height: 50px; background: #f59e0b; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.75rem; text-align: center;">Edu</div>
          <div style="position: absolute; top: 50%; left: 5%; width: 50px; height: 50px; background: #8b5cf6; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.75rem; text-align: center;">Tech</div>
          <div style="position: absolute; top: 50%; right: 5%; width: 50px; height: 50px; background: #22c55e; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.75rem; text-align: center;">Hous</div>
          <div style="position: absolute; bottom: 15%; left: 10%; width: 50px; height: 50px; background: #06b6d4; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.75rem; text-align: center;">Env</div>
          <div style="position: absolute; bottom: 15%; right: 10%; width: 50px; height: 50px; background: #ef4444; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.75rem; text-align: center;">Youth</div>

          <!-- Contributors (smaller nodes) -->
          <div style="position: absolute; top: 25%; left: 30%; width: 35px; height: 35px; background: #d1fae5; border: 2px solid #10b981; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.65rem;">A</div>
          <div style="position: absolute; top: 35%; right: 25%; width: 35px; height: 35px; background: #dbeafe; border: 2px solid #0284c7; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.65rem;">B</div>
          <div style="position: absolute; bottom: 35%; left: 25%; width: 35px; height: 35px; background: #fef3c7; border: 2px solid #f59e0b; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.65rem;">C</div>

          <!-- Connection lines (using CSS borders) -->
          <svg style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1;">
            <line x1="50%" y1="50%" x2="20%" y2="20%" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5"></line>
            <line x1="50%" y1="50%" x2="80%" y2="20%" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5"></line>
            <line x1="50%" y1="50%" x2="15%" y2="50%" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5"></line>
            <line x1="50%" y1="50%" x2="85%" y2="50%" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5"></line>
            <line x1="50%" y1="50%" x2="20%" y2="80%" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5"></line>
            <line x1="50%" y1="50%" x2="80%" y2="80%" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5"></line>
          </svg>
        </div>
      </div>

      <!-- Network Statistics -->
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <h2>Sector Distribution</h2>
          </div>
          <div style="padding: 1.5rem;">
            <div style="display: grid; gap: 1rem;">
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Healthcare</span>
                  <strong>3 orgs</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 30%; background: #ec4899;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Education</span>
                  <strong>2 orgs</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 20%; background: #f59e0b;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Housing</span>
                  <strong>2 orgs</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 20%; background: #22c55e;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Technology</span>
                  <strong>2 orgs</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 20%; background: #8b5cf6;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Environment</span>
                  <strong>1 org</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 10%; background: #06b6d4;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>Trust Tier Distribution</h2>
          </div>
          <div style="padding: 1.5rem;">
            <div style="display: grid; gap: 1rem;">
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Steward</span>
                  <strong>1</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 12%; background: #7c3aed;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Coordinator</span>
                  <strong>3</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 37%; background: #22c55e;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Advisor</span>
                  <strong>2</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 25%; background: #3b82f6;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Observer</span>
                  <strong>2</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 25%; background: #9ca3af;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Network Activity -->
      <div class="card">
        <div class="card-header">
          <h2>Recent Network Activity</h2>
        </div>
        <div class="timeline" style="padding: 1.5rem;">
          <div class="timeline-item">
            <div class="timeline-dot" style="background: #0284c7;"></div>
            <div class="timeline-content">
              <div style="font-weight: 500;">New Organization Joined</div>
              <div class="text-sm text-muted">Mental Health Services Coalition registered</div>
              <div class="text-sm text-muted">2 hours ago</div>
            </div>
          </div>
          <div class="timeline-item">
            <div class="timeline-dot" style="background: #22c55e;"></div>
            <div class="timeline-content">
              <div style="font-weight: 500;">New Connection</div>
              <div class="text-sm text-muted">Housing First DFW → Tech for Social Good</div>
              <div class="text-sm text-muted">4 hours ago</div>
            </div>
          </div>
          <div class="timeline-item">
            <div class="timeline-dot" style="background: #8b5cf6;"></div>
            <div class="timeline-content">
              <div style="font-weight: 500;">Contributor Onboarded</div>
              <div class="text-sm text-muted">14 new members joined as Observers</div>
              <div class="text-sm text-muted">Yesterday</div>
            </div>
          </div>
          <div class="timeline-item">
            <div class="timeline-dot" style="background: #f59e0b;"></div>
            <div class="timeline-content">
              <div style="font-weight: 500;">Cross-Sector Initiative</div>
              <div class="text-sm text-muted">Education + Tech partnership launched</div>
              <div class="text-sm text-muted">3 days ago</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * Helper to switch engagement tabs
 */
function switchTab(tabName) {
  document.getElementById('tab-active').style.display = tabName === 'active' ? 'block' : 'none';
  document.getElementById('tab-completed').style.display = tabName === 'completed' ? 'block' : 'none';
  document.getElementById('tab-pending').style.display = tabName === 'pending' ? 'block' : 'none';
}

/**
 * Modal for opportunity details
 */
function showOpportunityModal(id, title, org, duration, budget, skills, match) {
  const skillsHtml = skills.map(s => `<span class="badge" style="background: #e0e7ff; color: #4f46e5;">${s}</span>`).join('');
  const content = `
    <div style="line-height: 1.6;">
      <div style="margin-bottom: 1.5rem;">
        <h3 style="margin: 0 0 0.5rem 0;">${title}</h3>
        <div class="text-muted">${org}</div>
      </div>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem; font-size: 0.875rem;">
        <div><span class="text-muted">Duration:</span> <strong>${duration}</strong></div>
        <div><span class="text-muted">Budget:</span> <strong>${budget}</strong></div>
        <div><span class="text-muted">Match Score:</span> <strong style="color: ${match >= 90 ? '#22c55e' : '#f59e0b'};">${match}%</strong></div>
        <div><span class="text-muted">Posted:</span> <strong>10 days ago</strong></div>
      </div>
      <div style="margin-bottom: 1.5rem;">
        <div style="font-weight: 500; margin-bottom: 0.75rem;">Skills Required</div>
        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">${skillsHtml}</div>
      </div>
      <div style="background: #f0fdf4; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
        <div style="font-weight: 500; color: #047857; margin-bottom: 0.5rem;">About This Opportunity</div>
        <p style="margin: 0; font-size: 0.875rem; color: #047857;">We're seeking an experienced professional to help drive impact in our organization. This is a high-impact role working with dedicated teams to advance our mission. You'll collaborate with our core team and have direct influence on program outcomes.</p>
      </div>
      <div style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem;">
        <div style="font-weight: 500; margin-bottom: 0.75rem;">What to Expect</div>
        <ul style="margin: 0; padding-left: 1.5rem; font-size: 0.875rem;">
          <li>Flexible work arrangement with key milestones</li>
          <li>Regular check-ins with organization leadership</li>
          <li>Escrow-backed payment with milestone releases</li>
          <li>Professional development opportunities</li>
          <li>Portable reputation attestations on completion</li>
        </ul>
      </div>
    </div>
  `;
  const footer = `
    <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
    <button class="btn btn-primary" onclick="closeModal(); showToast('Application submitted!', 'success')">Apply Now</button>
  `;
  showModal(`${title} - ${org}`, content, footer);
}

/**
 * Modal for match review
 */
function showMatchModal(needId, org, candidateCount) {
  const content = `
    <div>
      <div style="margin-bottom: 1.5rem;">
        <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.5rem;">NEED ID</div>
        <strong style="font-size: 1.125rem;">${needId}</strong>
      </div>
      <div style="background: #f0f9ff; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
        <div style="font-weight: 500; color: #0284c7; margin-bottom: 0.5rem;">Matching Candidates</div>
        <div class="table-responsive" style="font-size: 0.875rem;">
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Tier</th>
                <th>Match</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Alex Martinez</strong></td>
                <td><span class="badge badge-coordinator">Coordinator</span></td>
                <td><strong style="color: #22c55e;">96%</strong></td>
                <td><button class="btn btn-sm btn-success" onclick="closeModal(); showToast('Match confirmed with Alex Martinez', 'success')">Confirm</button></td>
              </tr>
              <tr>
                <td><strong>Jordan Lee</strong></td>
                <td><span class="badge badge-advisor">Advisor</span></td>
                <td><strong style="color: #22c55e;">91%</strong></td>
                <td><button class="btn btn-sm btn-success" onclick="closeModal(); showToast('Match confirmed with Jordan Lee', 'success')">Confirm</button></td>
              </tr>
              <tr>
                <td><strong>Casey Williams</strong></td>
                <td><span class="badge badge-coordinator">Coordinator</span></td>
                <td><strong style="color: #3b82f6;">85%</strong></td>
                <td><button class="btn btn-sm btn-success" onclick="closeModal(); showToast('Match confirmed with Casey Williams', 'success')">Confirm</button></td>
              </tr>
              <tr>
                <td><strong>Morgan Chen</strong></td>
                <td><span class="badge badge-observer">Observer</span></td>
                <td><strong style="color: #f59e0b;">78%</strong></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showToast('Insufficient tier for this need', 'warning')">Decline</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div style="background: #fef3c7; padding: 1rem; border-radius: 0.5rem;">
        <div style="font-weight: 500; color: #d97706; margin-bottom: 0.5rem;">Next Steps</div>
        <p style="margin: 0; font-size: 0.875rem; color: #92400e;">Once confirmed, the match will be sent to the selected candidate for acceptance. They'll have 24 hours to respond. Upon acceptance, an engagement record will be created with escrow setup.</p>
      </div>
    </div>
  `;
  const footer = `
    <button class="btn btn-secondary" onclick="closeModal()">Close</button>
  `;
  showModal(`Review Matches - ${org}`, content, footer);
}

/**
 * 7. ANALYTICS DASHBOARD
 * System-wide analytics and metrics
 */
function renderAnalytics(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Analytics Dashboard</h1>
        <p class="text-muted">Coordination metrics, trust growth, and ecosystem activity</p>
      </div>

      <!-- Time Range Selector -->
      <div class="card" style="margin-bottom: 2rem;">
        <div style="padding: 1.5rem; display: flex; gap: 0.75rem; flex-wrap: wrap;">
          <button class="btn btn-sm btn-primary" onclick="showToast('View updated', 'info')">Last 7 Days</button>
          <button class="btn btn-sm btn-secondary" onclick="showToast('View updated', 'info')">Last 30 Days</button>
          <button class="btn btn-sm btn-secondary" onclick="showToast('View updated', 'info')">Last 90 Days</button>
          <button class="btn btn-sm btn-secondary" onclick="showToast('View updated', 'info')">All Time</button>
        </div>
      </div>

      <!-- Stat Cards -->
      <div class="stat-grid">
        <div class="stat-card">
          <div class="stat-label">Coordination Efficiency</div>
          <div class="stat-value">87%</div>
          <div class="stat-subtext">+5% from last period</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Trust Growth</div>
          <div class="stat-value">+12%</div>
          <div class="stat-subtext">23 new members</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Resource Utilization</div>
          <div class="stat-value">78%</div>
          <div class="stat-subtext">$18.5K deployed</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Active Engagements</div>
          <div class="stat-value">23</div>
          <div class="stat-subtext">6 matched this week</div>
        </div>
      </div>

      <!-- Coordination Metrics -->
      <div class="card">
        <div class="card-header">
          <h2>Coordination Metrics</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Metric</th>
                <th>Current</th>
                <th>Previous</th>
                <th>Change</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Avg Match Time</strong></td>
                <td>3.2 days</td>
                <td>4.3 days</td>
                <td><span style="color: #22c55e;">↓ 1.1d (-26%)</span></td>
              </tr>
              <tr>
                <td><strong>Match Success Rate</strong></td>
                <td>87%</td>
                <td>82%</td>
                <td><span style="color: #22c55e;">↑ 5% (+6%)</span></td>
              </tr>
              <tr>
                <td><strong>Engagement Completion</strong></td>
                <td>94%</td>
                <td>91%</td>
                <td><span style="color: #22c55e;">↑ 3% (+3%)</span></td>
              </tr>
              <tr>
                <td><strong>Trust Events/Day</strong></td>
                <td>4.7</td>
                <td>3.9</td>
                <td><span style="color: #22c55e;">↑ 0.8 (+20%)</span></td>
              </tr>
              <tr>
                <td><strong>Avg Rating</strong></td>
                <td>4.7/5.0</td>
                <td>4.5/5.0</td>
                <td><span style="color: #22c55e;">↑ 0.2 (+4%)</span></td>
              </tr>
              <tr>
                <td><strong>Coordinator Capacity</strong></td>
                <td>78%</td>
                <td>65%</td>
                <td><span style="color: #ef4444;">↑ 13% (-capacity)</span></td>
              </tr>
              <tr>
                <td><strong>Onboarding Funnel</strong></td>
                <td>68%</td>
                <td>72%</td>
                <td><span style="color: #ef4444;">↓ 4% (-4%)</span></td>
              </tr>
              <tr>
                <td><strong>Repeat Engagement Rate</strong></td>
                <td>71%</td>
                <td>68%</td>
                <td><span style="color: #22c55e;">↑ 3% (+4%)</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Trust Tier Distribution -->
      <div class="grid-2" style="margin-top: 2rem;">
        <div class="card">
          <div class="card-header">
            <h2>Trust Tier Distribution</h2>
          </div>
          <div style="padding: 1.5rem;">
            <div style="display: grid; gap: 1rem;">
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Steward</span>
                  <strong>1</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 12%; background: #7c3aed;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Coordinator</span>
                  <strong>3</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 37%; background: #22c55e;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Advisor</span>
                  <strong>4</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 50%; background: #3b82f6;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Observer</span>
                  <strong>3</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 37%; background: #9ca3af;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>Sector Activity</h2>
          </div>
          <div class="table-responsive">
            <table>
              <thead>
                <tr>
                  <th>Sector</th>
                  <th>Orgs</th>
                  <th>Engagements</th>
                  <th>Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Healthcare</strong></td>
                  <td>3</td>
                  <td>7</td>
                  <td>$12,500</td>
                </tr>
                <tr>
                  <td><strong>Education</strong></td>
                  <td>2</td>
                  <td>5</td>
                  <td>$8,200</td>
                </tr>
                <tr>
                  <td><strong>Housing</strong></td>
                  <td>2</td>
                  <td>4</td>
                  <td>$6,800</td>
                </tr>
                <tr>
                  <td><strong>Technology</strong></td>
                  <td>2</td>
                  <td>4</td>
                  <td>$9,100</td>
                </tr>
                <tr>
                  <td><strong>Environment</strong></td>
                  <td>1</td>
                  <td>3</td>
                  <td>$5,900</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Top Performing Agents -->
      <div class="card" style="margin-top: 2rem;">
        <div class="card-header">
          <h2>Top Performing Agents (This Month)</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Rank</th>
                <th>Agent Name</th>
                <th>Tier</th>
                <th>Matches</th>
                <th>Avg Rating</th>
                <th>Hours Logged</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>🥇</strong></td>
                <td><strong>Alex Martinez</strong></td>
                <td><span class="badge badge-coordinator">Coordinator</span></td>
                <td>6</td>
                <td>4.9/5.0</td>
                <td>42 hrs</td>
              </tr>
              <tr>
                <td><strong>🥈</strong></td>
                <td><strong>Jordan Lee</strong></td>
                <td><span class="badge badge-coordinator">Coordinator</span></td>
                <td>5</td>
                <td>4.8/5.0</td>
                <td>38 hrs</td>
              </tr>
              <tr>
                <td><strong>🥉</strong></td>
                <td><strong>Casey Williams</strong></td>
                <td><span class="badge badge-advisor">Advisor</span></td>
                <td>4</td>
                <td>4.7/5.0</td>
                <td>32 hrs</td>
              </tr>
              <tr>
                <td><strong>4</strong></td>
                <td><strong>Morgan Chen</strong></td>
                <td><span class="badge badge-advisor">Advisor</span></td>
                <td>3</td>
                <td>4.6/5.0</td>
                <td>28 hrs</td>
              </tr>
              <tr>
                <td><strong>5</strong></td>
                <td><strong>Riley Thompson</strong></td>
                <td><span class="badge badge-observer">Observer</span></td>
                <td>2</td>
                <td>4.5/5.0</td>
                <td>18 hrs</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * 8. PORTFOLIO OVERVIEW
 * Funder's portfolio and grant management view
 */
function renderPortfolioOverview(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Portfolio Overview</h1>
        <p class="text-muted">Grant deployment, outcomes, and ROI tracking</p>
      </div>

      <!-- Stat Cards -->
      <div class="stat-grid">
        <div class="stat-card">
          <div class="stat-label">Total Deployed</div>
          <div class="stat-value">$2.4M</div>
          <div class="stat-subtext">Across 12 grants</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Active Grants</div>
          <div class="stat-value">12</div>
          <div class="stat-subtext">In execution phase</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Avg Outcome Rate</div>
          <div class="stat-value">89%</div>
          <div class="stat-subtext">Met objectives</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">ROI Score</div>
          <div class="stat-value">3.2x</div>
          <div class="stat-subtext">Impact per dollar</div>
        </div>
      </div>

      <!-- Grant Portfolio -->
      <div class="card">
        <div class="card-header">
          <h2>Grant Portfolio</h2>
          <div class="card-header-actions">
            <button class="btn btn-sm btn-primary" onclick="showToast('Export initiated', 'success')">Export</button>
          </div>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Initiative</th>
                <th>Organization</th>
                <th>Amount</th>
                <th>Disbursed</th>
                <th>Outcomes</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Community Health Platform</strong></td>
                <td>Healthcare Access Initiative</td>
                <td>$250,000</td>
                <td>$180,000</td>
                <td><strong style="color: #22c55e;">✓ 95%</strong></td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Workforce Development</strong></td>
                <td>Youth Workforce Alliance</td>
                <td>$180,000</td>
                <td>$125,000</td>
                <td><strong style="color: #22c55e;">✓ 87%</strong></td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Housing Stability Program</strong></td>
                <td>Housing First DFW</td>
                <td>$400,000</td>
                <td>$320,000</td>
                <td><strong style="color: #22c55e;">✓ 92%</strong></td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Education Innovation</strong></td>
                <td>DFW Education Collective</td>
                <td>$220,000</td>
                <td>$165,000</td>
                <td><strong style="color: #22c55e;">✓ 88%</strong></td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Tech Skills Training</strong></td>
                <td>Tech for Social Good</td>
                <td>$150,000</td>
                <td>$120,000</td>
                <td><strong style="color: #22c55e;">✓ 85%</strong></td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Sustainability Initiative</strong></td>
                <td>Urban Agriculture Initiative</td>
                <td>$190,000</td>
                <td>$145,000</td>
                <td><strong style="color: #22c55e;">✓ 91%</strong></td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Mental Health Services</strong></td>
                <td>Mental Health Services Coalition</td>
                <td>$280,000</td>
                <td>$210,000</td>
                <td><strong style="color: #22c55e;">✓ 86%</strong></td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Community Garden Network</strong></td>
                <td>Community Garden Initiative</td>
                <td>$140,000</td>
                <td>$105,000</td>
                <td><strong style="color: #22c55e;">✓ 89%</strong></td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Sector Allocation -->
      <div class="grid-2" style="margin-top: 2rem;">
        <div class="card">
          <div class="card-header">
            <h2>Sector Allocation</h2>
          </div>
          <div style="padding: 1.5rem;">
            <div style="display: grid; gap: 1rem;">
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Healthcare</span>
                  <strong>$450K (19%)</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 19%; background: #ec4899;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Housing</span>
                  <strong>$520K (22%)</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 22%; background: #22c55e;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Education</span>
                  <strong>$430K (18%)</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 18%; background: #f59e0b;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Technology</span>
                  <strong>$420K (18%)</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 18%; background: #8b5cf6;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Environment</span>
                  <strong>$330K (14%)</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 14%; background: #06b6d4;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Mental Health</span>
                  <strong>$290K (12%)</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 12%; background: #a855f7;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>Performance Matrix</h2>
          </div>
          <div class="table-responsive">
            <table>
              <thead>
                <tr>
                  <th>Organization</th>
                  <th>Performance</th>
                  <th>Score</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Healthcare Access Initiative</strong></td>
                  <td><div class="progress-bar" style="width: 100px; height: 8px;"><div class="progress-fill" style="width: 95%; background: #22c55e;"></div></div></td>
                  <td><strong>95/100</strong></td>
                </tr>
                <tr>
                  <td><strong>Youth Workforce Alliance</strong></td>
                  <td><div class="progress-bar" style="width: 100px; height: 8px;"><div class="progress-fill" style="width: 87%; background: #22c55e;"></div></div></td>
                  <td><strong>87/100</strong></td>
                </tr>
                <tr>
                  <td><strong>Housing First DFW</strong></td>
                  <td><div class="progress-bar" style="width: 100px; height: 8px;"><div class="progress-fill" style="width: 92%; background: #22c55e;"></div></div></td>
                  <td><strong>92/100</strong></td>
                </tr>
                <tr>
                  <td><strong>DFW Education Collective</strong></td>
                  <td><div class="progress-bar" style="width: 100px; height: 8px;"><div class="progress-fill" style="width: 88%; background: #22c55e;"></div></div></td>
                  <td><strong>88/100</strong></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Upcoming Disbursements -->
      <div class="card" style="margin-top: 2rem;">
        <div class="card-header">
          <h2>Upcoming Disbursements</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; gap: 1rem;">
            <div style="border-left: 4px solid #3b82f6; padding-left: 1rem;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                <strong>Healthcare Access Initiative</strong>
                <span style="color: #3b82f6; font-weight: 500;">$60,000</span>
              </div>
              <div class="text-sm text-muted">Scheduled: Feb 25, 2026</div>
            </div>
            <div style="border-left: 4px solid #f59e0b; padding-left: 1rem;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                <strong>DFW Education Collective</strong>
                <span style="color: #f59e0b; font-weight: 500;">$55,000</span>
              </div>
              <div class="text-sm text-muted">Scheduled: Mar 2, 2026</div>
            </div>
            <div style="border-left: 4px solid #22c55e; padding-left: 1rem;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                <strong>Housing First DFW</strong>
                <span style="color: #22c55e; font-weight: 500;">$80,000</span>
              </div>
              <div class="text-sm text-muted">Scheduled: Mar 10, 2026</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * 9. OUTCOME VERIFICATION
 * Funder's attestation review and verification queue
 */
function renderOutcomeVerification(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Outcome Verification</h1>
        <p class="text-muted">Review and verify attestations before on-chain registration</p>
      </div>

      <!-- Pending Verifications -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Pending Verifications Queue</h2>
          <div class="card-header-actions">
            <span style="font-size: 0.875rem; color: #6b7280;">4 items</span>
          </div>
        </div>
        <div style="padding: 1.5rem; display: grid; gap: 1.5rem;">
          <!-- Pending Item 1 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem; background: #fffbeb;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Initiative</div>
                <strong>Community Health Platform</strong>
              </div>
              <div>
                <div class="text-muted">Organization</div>
                <strong>Healthcare Access Initiative</strong>
              </div>
              <div>
                <div class="text-muted">Milestone</div>
                <strong>Phase 2 Completion</strong>
              </div>
              <div>
                <div class="text-muted">Submitted</div>
                <strong>Feb 18, 2026</strong>
              </div>
            </div>
            <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <strong style="color: #d97706;">Evidence Summary:</strong> System deployed to 3 health centers, serving 250+ patients. Data shows 87% medication adherence improvement.
            </div>
            <div style="display: flex; gap: 0.75rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <span class="badge" style="background: #f0f9ff;">Completion Attestation</span>
              <span class="badge" style="background: #f0fdf4;">Impact Measurement</span>
            </div>
            <div style="display: flex; gap: 0.75rem;">
              <button class="btn btn-sm btn-success" onclick="showVerificationModal('Phase 2', 'Healthcare Access Initiative')">Verify & Attest</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('More info requested', 'info')">Request More Info</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Verification deferred', 'warning')">Defer</button>
            </div>
          </div>

          <!-- Pending Item 2 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem; background: #fffbeb;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Initiative</div>
                <strong>Workforce Development Program</strong>
              </div>
              <div>
                <div class="text-muted">Organization</div>
                <strong>Youth Workforce Alliance</strong>
              </div>
              <div>
                <div class="text-muted">Milestone</div>
                <strong>100 Trainees Completed</strong>
              </div>
              <div>
                <div class="text-muted">Submitted</div>
                <strong>Feb 17, 2026</strong>
              </div>
            </div>
            <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <strong style="color: #d97706;">Evidence Summary:</strong> 105 youth completed intensive 12-week tech training. 92% job placement rate, avg starting salary $45K.
            </div>
            <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <span class="badge" style="background: #f0f9ff;">Completion Attestation</span>
              <span class="badge" style="background: #f0fdf4;">Outcome Verification</span>
              <span class="badge" style="background: #f0fdf4;">Skills Transfer</span>
            </div>
            <div style="display: flex; gap: 0.75rem;">
              <button class="btn btn-sm btn-success" onclick="showVerificationModal('100 Trainees', 'Youth Workforce Alliance')">Verify & Attest</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('More info requested', 'info')">Request More Info</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Verification deferred', 'warning')">Defer</button>
            </div>
          </div>

          <!-- Pending Item 3 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem; background: #fffbeb;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Initiative</div>
                <strong>Housing Stability Program</strong>
              </div>
              <div>
                <div class="text-muted">Organization</div>
                <strong>Housing First DFW</strong>
              </div>
              <div>
                <div class="text-muted">Milestone</div>
                <strong>500 Households Housed</strong>
              </div>
              <div>
                <div class="text-muted">Submitted</div>
                <strong>Feb 16, 2026</strong>
              </div>
            </div>
            <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <strong style="color: #d97706;">Evidence Summary:</strong> 512 households placed in permanent housing. 1-year retention rate 96%. Average cost per household $12,500.
            </div>
            <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <span class="badge" style="background: #f0f9ff;">Impact Verification</span>
              <span class="badge" style="background: #f0fdf4;">Outcome Measurement</span>
            </div>
            <div style="display: flex; gap: 0.75rem;">
              <button class="btn btn-sm btn-success" onclick="showVerificationModal('500 Households', 'Housing First DFW')">Verify & Attest</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('More info requested', 'info')">Request More Info</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Verification deferred', 'warning')">Defer</button>
            </div>
          </div>

          <!-- Pending Item 4 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem; background: #fffbeb;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Initiative</div>
                <strong>Education Innovation Program</strong>
              </div>
              <div>
                <div class="text-muted">Organization</div>
                <strong>DFW Education Collective</strong>
              </div>
              <div>
                <div class="text-muted">Milestone</div>
                <strong>Curriculum Deployed</strong>
              </div>
              <div>
                <div class="text-muted">Submitted</div>
                <strong>Feb 15, 2026</strong>
              </div>
            </div>
            <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <strong style="color: #d97706;">Evidence Summary:</strong> New STEM curriculum deployed across 12 schools. 800+ students enrolled, baseline assessment completed.
            </div>
            <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <span class="badge" style="background: #f0f9ff;">Completion Attestation</span>
              <span class="badge" style="background: #f0fdf4;">Implementation Verification</span>
            </div>
            <div style="display: flex; gap: 0.75rem;">
              <button class="btn btn-sm btn-success" onclick="showVerificationModal('Curriculum', 'DFW Education Collective')">Verify & Attest</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('More info requested', 'info')">Request More Info</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Verification deferred', 'warning')">Defer</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Verified Outcomes -->
      <div class="card">
        <div class="card-header">
          <h2>Verified Outcomes</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Initiative</th>
                <th>Organization</th>
                <th>Outcome</th>
                <th>Chain</th>
                <th>Tx Hash</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Feb 10, 2026</td>
                <td><strong>Mental Health Services</strong></td>
                <td>Mental Health Services Coalition</td>
                <td>2,400 Counseling Sessions</td>
                <td><span class="badge badge-base">BASE</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x3f7a...2c81</a></td>
              </tr>
              <tr>
                <td>Feb 8, 2026</td>
                <td><strong>Sustainability Initiative</strong></td>
                <td>Urban Agriculture Initiative</td>
                <td>15 New Community Gardens</td>
                <td><span class="badge badge-eth">ETH</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x8c5d...9f14</a></td>
              </tr>
              <tr>
                <td>Feb 5, 2026</td>
                <td><strong>Community Garden Network</strong></td>
                <td>Community Garden Initiative</td>
                <td>420 Families Fed</td>
                <td><span class="badge badge-base">BASE</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x4b2e...6f92</a></td>
              </tr>
              <tr>
                <td>Feb 1, 2026</td>
                <td><strong>Tech Skills Training</strong></td>
                <td>Tech for Social Good</td>
                <td>75 Developers Trained</td>
                <td><span class="badge badge-linea">LINEA</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x7a3d...1e47</a></td>
              </tr>
              <tr>
                <td>Jan 28, 2026</td>
                <td><strong>Healthcare Access Initiative</strong></td>
                <td>Healthcare Access Initiative</td>
                <td>Phase 1 Completed</td>
                <td><span class="badge badge-eth">ETH</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x5c1a...8d25</a></td>
              </tr>
              <tr>
                <td>Jan 25, 2026</td>
                <td><strong>Youth Workforce Alliance</strong></td>
                <td>Youth Workforce Alliance</td>
                <td>50 Youth Placed</td>
                <td><span class="badge badge-base">BASE</span></td>
                <td style="font-family: monospace; font-size: 0.75rem;"><a href="#" style="color: #0284c7;">0x9e4f...3b58</a></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Discrepancy Flags -->
      <div class="card" style="margin-top: 2rem;">
        <div class="card-header">
          <h2>Discrepancy Flags</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="border-left: 4px solid #ef4444; padding-left: 1rem; margin-bottom: 1rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <div>
                <div style="font-weight: 500;">Housing First DFW - Budget Variance</div>
                <div class="text-sm text-muted">Actual spending 12% over projected budget in Jan</div>
              </div>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Flagged for review', 'info')">Review</button>
            </div>
          </div>
          <div style="border-left: 4px solid #f59e0b; padding-left: 1rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <div>
                <div style="font-weight: 500;">DFW Education Collective - Delayed Reporting</div>
                <div class="text-sm text-muted">Monthly report 5 days overdue</div>
              </div>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Follow-up sent', 'info')">Follow Up</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * Modal for attestation verification
 */
function showVerificationModal(milestone, org) {
  const content = `
    <div style="line-height: 1.6;">
      <div style="background: #f0fdf4; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem; border-left: 4px solid #22c55e;">
        <div style="font-weight: 500; color: #047857; margin-bottom: 0.5rem;">Attestation Preview</div>
        <div style="font-family: monospace; font-size: 0.75rem; color: #047857; word-break: break-all;">
          {<br/>
          &nbsp;&nbsp;"attester": "0x7a3c2b9f...",<br/>
          &nbsp;&nbsp;"attestationType": "outcome_verification",<br/>
          &nbsp;&nbsp;"milestone": "${milestone}",<br/>
          &nbsp;&nbsp;"organization": "${org}",<br/>
          &nbsp;&nbsp;"timestamp": ${Date.now()},<br/>
          &nbsp;&nbsp;"chain": "base",<br/>
          &nbsp;&nbsp;"schema": "0x1a2b3c4d..."<br/>
          }
        </div>
      </div>
      <div style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
        <div style="font-weight: 500; margin-bottom: 0.75rem;">Attestation Details</div>
        <div style="display: grid; gap: 0.75rem; font-size: 0.875rem;">
          <div>
            <span class="text-muted">Chain:</span> <strong>BASE (Primary)</strong>
          </div>
          <div>
            <span class="text-muted">Cost:</span> <strong>~0.002 ETH (gas)</strong>
          </div>
          <div>
            <span class="text-muted">Attestation Type:</span> <strong>Outcome Verification</strong>
          </div>
          <div>
            <span class="text-muted">Schema UID:</span> <span style="font-family: monospace; font-size: 0.75rem;">0x1a2b3c...</span>
          </div>
        </div>
      </div>
      <div style="background: #f3f0ff; padding: 1rem; border-radius: 0.5rem;">
        <div style="font-weight: 500; color: #6d28d9; margin-bottom: 0.5rem;">⚠️ Confirmation Required</div>
        <p style="margin: 0; font-size: 0.875rem; color: #6d28d9;">This action will register the outcome attestation on-chain. This is permanent and cannot be undone.</p>
      </div>
    </div>
  `;
  const footer = `
    <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
    <button class="btn btn-success" onclick="closeModal(); showToast('Attestation registered on-chain!', 'success')">Confirm & Register</button>
  `;
  showModal(`Verify Outcome - ${milestone}`, content, footer);
}

/**
 * 10. COMPLIANCE DASHBOARD
 * Funder compliance and reporting tracking
 */
function renderCompliance(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Compliance Dashboard</h1>
        <p class="text-muted">Grant compliance, reporting requirements, and audit trail</p>
      </div>

      <!-- Overall Compliance Score -->
      <div class="card" style="margin-bottom: 2rem;">
        <div style="padding: 2rem; text-align: center;">
          <div style="font-size: 0.875rem; color: #6b7280; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 1rem;">Overall Compliance Score</div>
          <div style="font-size: 3rem; font-weight: bold; color: #22c55e; margin-bottom: 0.5rem;">93%</div>
          <div class="text-muted">All organizations meeting requirements</div>
        </div>
      </div>

      <!-- Reporting Status -->
      <div class="card">
        <div class="card-header">
          <h2>Reporting Status</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Organization</th>
                <th>Due Date</th>
                <th>Status</th>
                <th>Last Report</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Healthcare Access Initiative</strong></td>
                <td>Feb 28, 2026</td>
                <td><span class="badge badge-success">On Time</span></td>
                <td>Jan 31, 2026</td>
                <td><button class="btn btn-sm btn-secondary" onclick="showToast('Report viewed', 'info')">View</button></td>
              </tr>
              <tr>
                <td><strong>Youth Workforce Alliance</strong></td>
                <td>Feb 28, 2026</td>
                <td><span class="badge badge-success">On Time</span></td>
                <td>Jan 31, 2026</td>
                <td><button class="btn btn-sm btn-secondary" onclick="showToast('Report viewed', 'info')">View</button></td>
              </tr>
              <tr>
                <td><strong>Housing First DFW</strong></td>
                <td>Feb 25, 2026</td>
                <td><span class="badge" style="background: #fef3c7; color: #92400e;">Due Soon</span></td>
                <td>Jan 25, 2026</td>
                <td><button class="btn btn-sm btn-secondary" onclick="showToast('Report viewed', 'info')">View</button></td>
              </tr>
              <tr>
                <td><strong>DFW Education Collective</strong></td>
                <td>Feb 20, 2026</td>
                <td><span class="badge" style="background: #fee2e2; color: #991b1b;">Overdue</span></td>
                <td>Dec 20, 2025</td>
                <td><button class="btn btn-sm btn-danger" onclick="showToast('Reminder sent', 'warning')">Send Reminder</button></td>
              </tr>
              <tr>
                <td><strong>Tech for Social Good</strong></td>
                <td>Feb 28, 2026</td>
                <td><span class="badge badge-success">On Time</span></td>
                <td>Jan 31, 2026</td>
                <td><button class="btn btn-sm btn-secondary" onclick="showToast('Report viewed', 'info')">View</button></td>
              </tr>
              <tr>
                <td><strong>Urban Agriculture Initiative</strong></td>
                <td>Mar 5, 2026</td>
                <td><span class="badge badge-pending">Pending</span></td>
                <td>Feb 5, 2026</td>
                <td><button class="btn btn-sm btn-secondary" onclick="showToast('Report viewed', 'info')">View</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Grant Conditions -->
      <div class="grid-2" style="margin-top: 2rem;">
        <div class="card">
          <div class="card-header">
            <h2>Grant Conditions</h2>
          </div>
          <div style="padding: 1.5rem; display: grid; gap: 1rem;">
            <div style="border-left: 4px solid #22c55e; padding-left: 1rem;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                <strong>Financial Reporting</strong>
                <span class="badge badge-success">✓ Met</span>
              </div>
              <div class="text-sm text-muted">Monthly financial statements required</div>
            </div>
            <div style="border-left: 4px solid #22c55e; padding-left: 1rem;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                <strong>Impact Measurement</strong>
                <span class="badge badge-success">✓ Met</span>
              </div>
              <div class="text-sm text-muted">Quarterly outcome reports required</div>
            </div>
            <div style="border-left: 4px solid #22c55e; padding-left: 1rem;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                <strong>Audit Compliance</strong>
                <span class="badge badge-success">✓ Met</span>
              </div>
              <div class="text-sm text-muted">Annual independent audit required</div>
            </div>
            <div style="border-left: 4px solid #f59e0b; padding-left: 1rem;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                <strong>Data Sharing</strong>
                <span class="badge badge-pending">⚠ Review</span>
              </div>
              <div class="text-sm text-muted">Data privacy framework alignment</div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>Audit Trail</h2>
          </div>
          <div class="timeline" style="padding: 1.5rem;">
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #22c55e;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">Compliance Verified</div>
                <div class="text-sm text-muted">All 2026 Q1 requirements met</div>
                <div class="text-sm text-muted">Feb 15, 2026</div>
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #3b82f6;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">Audit Completed</div>
                <div class="text-sm text-muted">2025 Independent Audit - No findings</div>
                <div class="text-sm text-muted">Feb 10, 2026</div>
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #22c55e;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">Report Submitted</div>
                <div class="text-sm text-muted">2025 Annual Compliance Report</div>
                <div class="text-sm text-muted">Jan 31, 2026</div>
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #f59e0b;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">Issue Flagged</div>
                <div class="text-sm text-muted">DFW Education - Delayed reporting</div>
                <div class="text-sm text-muted">Jan 25, 2026</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Export & Actions -->
      <div class="card" style="margin-top: 2rem;">
        <div style="padding: 1.5rem; display: flex; gap: 1rem;">
          <button class="btn btn-primary" onclick="showToast('Compliance report generated', 'success')">Export Compliance Report</button>
          <button class="btn btn-secondary" onclick="showToast('Email sent to all grantees', 'success')">Email Summary to Grantees</button>
          <button class="btn btn-secondary" onclick="showToast('Schedule updated', 'info')">View Full Audit Log</button>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * 11. SYSTEM SETTINGS
 * Admin system configuration and protocol parameters
 */
function renderSystemSettings(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>System Settings</h1>
        <p class="text-muted">Protocol parameters, features, and network configuration</p>
      </div>

      <!-- Protocol Parameters -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Protocol Parameters</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div class="form-group" style="margin-bottom: 1.5rem;">
            <label style="margin-bottom: 1rem;">Trust Threshold for Tier Upgrade</label>
            <input type="range" min="0" max="100" value="75" style="width: 100%; margin-bottom: 0.5rem;">
            <div style="display: flex; justify-content: space-between;">
              <span class="text-sm text-muted">0</span>
              <span style="font-weight: 500;">75%</span>
              <span class="text-sm text-muted">100</span>
            </div>
          </div>

          <div class="form-group" style="margin-bottom: 1.5rem;">
            <label>Session Key Duration</label>
            <select style="width: 100%;">
              <option>7 days</option>
              <option selected>30 days</option>
              <option>90 days</option>
              <option>Custom</option>
            </select>
          </div>

          <div class="form-group" style="margin-bottom: 1.5rem;">
            <label>Max Agent Spending per Month (USDC)</label>
            <input type="number" value="50000" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>

          <div style="border-top: 1px solid #e5e7eb; padding-top: 1.5rem;">
            <label style="display: block; margin-bottom: 1rem; font-weight: 500;">Supported Networks</label>
            <div style="display: grid; gap: 0.75rem;">
              <div style="display: flex; align-items: center;">
                <input type="checkbox" id="base" checked>
                <label for="base" style="margin-left: 0.75rem; margin-bottom: 0;">
                  <strong>BASE</strong> <span class="text-muted">(Primary)</span>
                </label>
              </div>
              <div style="display: flex; align-items: center;">
                <input type="checkbox" id="eth" checked>
                <label for="eth" style="margin-left: 0.75rem; margin-bottom: 0;">
                  <strong>Ethereum</strong> <span class="text-muted">(Secondary)</span>
                </label>
              </div>
              <div style="display: flex; align-items: center;">
                <input type="checkbox" id="linea" checked>
                <label for="linea" style="margin-left: 0.75rem; margin-bottom: 0;">
                  <strong>Linea</strong> <span class="text-muted">(Secondary)</span>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Feature Flags -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Feature Flags</h2>
        </div>
        <div style="padding: 1.5rem; display: grid; gap: 1rem;">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div style="font-weight: 500;">Agent Auto-Approval</div>
              <div class="text-sm text-muted">Automatically approve agents below spending limit</div>
            </div>
            <input type="checkbox" checked style="width: 20px; height: 20px;">
          </div>
          <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem; display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div style="font-weight: 500;">Cross-Chain Sync</div>
              <div class="text-sm text-muted">Synchronize attestations across BASE, ETH, Linea</div>
            </div>
            <input type="checkbox" checked style="width: 20px; height: 20px;">
          </div>
          <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem; display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div style="font-weight: 500;">Escrow Auto-Release</div>
              <div class="text-sm text-muted">Automatically release escrow on milestone verification</div>
            </div>
            <input type="checkbox" style="width: 20px; height: 20px;">
          </div>
        </div>
      </div>

      <!-- System Information -->
      <div class="card">
        <div class="card-header">
          <h2>System Information</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
            <div>
              <div class="text-sm text-muted">Version</div>
              <strong>v3.0.0</strong>
            </div>
            <div>
              <div class="text-sm text-muted">Environment</div>
              <strong>Production</strong>
            </div>
            <div>
              <div class="text-sm text-muted">Uptime</div>
              <strong>99.87%</strong>
            </div>
            <div>
              <div class="text-sm text-muted">Last Backup</div>
              <strong>Feb 20, 2026 14:32 UTC</strong>
            </div>
          </div>

          <div style="border-top: 1px solid #e5e7eb; margin-top: 1.5rem; padding-top: 1.5rem;">
            <div style="font-weight: 500; margin-bottom: 1rem;">Contract Addresses</div>
            <div style="display: grid; gap: 0.75rem; font-size: 0.875rem;">
              <div>
                <div class="text-muted">ERC-8004 Identity Registry</div>
                <div style="font-family: monospace; word-break: break-all;">0x1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b</div>
              </div>
              <div>
                <div class="text-muted">ERC-4337 Account Factory</div>
                <div style="font-family: monospace; word-break: break-all;">0x2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c</div>
              </div>
              <div>
                <div class="text-muted">EAS Attestation Service</div>
                <div style="font-family: monospace; word-break: break-all;">0x3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div style="display: flex; gap: 1rem; margin-top: 2rem;">
        <button class="btn btn-primary" onclick="showToast('Settings saved', 'success')">Save Changes</button>
        <button class="btn btn-secondary" onclick="showToast('Settings reset', 'warning')">Reset to Defaults</button>
      </div>
    </div>
  `;
  return html;
}

/**
 * 12. USER MANAGEMENT
 * Admin user directory and account management
 */
function renderUserManagement(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>User Management</h1>
        <p class="text-muted">Directory, roles, and account administration</p>
      </div>

      <!-- Stats -->
      <div class="stat-grid">
        <div class="stat-card">
          <div class="stat-label">Total Users</div>
          <div class="stat-value">10</div>
          <div class="stat-subtext">Active & pending</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Active Users</div>
          <div class="stat-value">9</div>
          <div class="stat-subtext">In last 30 days</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Pending Invites</div>
          <div class="stat-value">1</div>
          <div class="stat-subtext">Awaiting acceptance</div>
        </div>
      </div>

      <!-- Search & Filter -->
      <div class="card" style="margin-bottom: 2rem;">
        <div style="padding: 1.5rem; display: grid; grid-template-columns: 1fr auto; gap: 1rem;">
          <input type="text" placeholder="Search by name or email..." style="padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          <button class="btn btn-primary" onclick="showToast('User search results', 'info')">+ Add User</button>
        </div>
      </div>

      <!-- User Directory -->
      <div class="card">
        <div class="card-header">
          <h2>User Directory</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Role</th>
                <th>Status</th>
                <th>Last Login</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>John Kim</strong></td>
                <td>john@dfw.local</td>
                <td><span class="badge badge-coordinator">Admin</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Today 10:45 AM</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showUserModal('John Kim', 'john@dfw.local', 'Admin')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>Sarah Chen</strong></td>
                <td>sarah@dfw.local</td>
                <td><span class="badge badge-coordinator">Coordinator</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 20, 2 PM</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showUserModal('Sarah Chen', 'sarah@dfw.local', 'Coordinator')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>Marcus Rodriguez</strong></td>
                <td>marcus@dfw.local</td>
                <td><span class="badge badge-coordinator">Coordinator</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 19, 4 PM</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showUserModal('Marcus Rodriguez', 'marcus@dfw.local', 'Coordinator')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>Alex Martinez</strong></td>
                <td>alex@dfw.local</td>
                <td><span class="badge badge-advisor">Contributor</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 20, 9 AM</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showUserModal('Alex Martinez', 'alex@dfw.local', 'Contributor')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>Jordan Lee</strong></td>
                <td>jordan@dfw.local</td>
                <td><span class="badge badge-advisor">Contributor</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 20, 8 AM</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showUserModal('Jordan Lee', 'jordan@dfw.local', 'Contributor')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>Casey Williams</strong></td>
                <td>casey@dfw.local</td>
                <td><span class="badge badge-observer">Viewer</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 18, 3 PM</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showUserModal('Casey Williams', 'casey@dfw.local', 'Viewer')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>Morgan Chen</strong></td>
                <td>morgan@dfw.local</td>
                <td><span class="badge badge-observer">Viewer</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 17, 6 PM</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showUserModal('Morgan Chen', 'morgan@dfw.local', 'Viewer')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>Riley Thompson</strong></td>
                <td>riley@dfw.local</td>
                <td><span class="badge badge-observer">Viewer</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 16, 2 PM</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showUserModal('Riley Thompson', 'riley@dfw.local', 'Viewer')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>Andrea Wilson</strong></td>
                <td>andrea@dfw.local</td>
                <td><span class="badge badge-advisor">Contributor</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 15, 11 AM</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showUserModal('Andrea Wilson', 'andrea@dfw.local', 'Contributor')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>David Kim</strong></td>
                <td>david@dfw.local</td>
                <td><span class="badge badge-pending">Invited</span></td>
                <td><span class="badge badge-pending">Pending</span></td>
                <td>Never</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showToast('Invite resent', 'success')">Resend</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * Modal for user edit
 */
function showUserModal(name, email, role) {
  const content = `
    <div style="line-height: 1.6;">
      <div class="form-group">
        <label>Full Name</label>
        <input type="text" value="${name}" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
      </div>
      <div class="form-group">
        <label>Email</label>
        <input type="email" value="${email}" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
      </div>
      <div class="form-group">
        <label>Role</label>
        <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          <option>${role}</option>
          <option>Admin</option>
          <option>Coordinator</option>
          <option>Contributor</option>
          <option>Viewer</option>
        </select>
      </div>
      <div style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-top: 1.5rem;">
        <div style="font-weight: 500; color: #ef4444; margin-bottom: 1rem;">Danger Zone</div>
        <button class="btn btn-sm btn-danger" onclick="showToast('User suspended', 'warning')">Suspend User</button>
      </div>
    </div>
  `;
  const footer = `
    <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
    <button class="btn btn-primary" onclick="closeModal(); showToast('User updated', 'success')">Save Changes</button>
  `;
  showModal(`Edit User - ${name}`, content, footer);
}

/**
 * 13. PROTOCOL CONFIGURATION
 * Admin protocol and smart contract settings
 */
function renderProtocolConfig(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Protocol Configuration</h1>
        <p class="text-muted">ERC-8004, ERC-4337, EAS schemas, and network settings</p>
      </div>

      <!-- ERC-8004 Identity Registry -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>ERC-8004 Identity Registry</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem; font-size: 0.875rem;">
            <div>
              <div class="text-muted">Contract Address</div>
              <div style="font-family: monospace; word-break: break-all; font-size: 0.75rem;">0x1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b</div>
            </div>
            <div>
              <div class="text-muted">Network</div>
              <strong><span class="badge badge-base">BASE</span></strong>
            </div>
            <div>
              <div class="text-muted">Registration Count</div>
              <strong>847</strong>
            </div>
            <div>
              <div class="text-muted">Status</div>
              <span class="badge badge-active">Active</span>
            </div>
          </div>
          <div style="background: #f0fdf4; padding: 1rem; border-radius: 0.5rem;">
            <div style="font-weight: 500; color: #047857; margin-bottom: 0.5rem;">✓ Registry Healthy</div>
            <div class="text-sm" style="color: #047857;">All registrations synced and verified</div>
          </div>
        </div>
      </div>

      <!-- ERC-4337 Account Factory -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>ERC-4337 Account Factory</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem; font-size: 0.875rem;">
            <div>
              <div class="text-muted">Factory Address</div>
              <div style="font-family: monospace; word-break: break-all; font-size: 0.75rem;">0x2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c</div>
            </div>
            <div>
              <div class="text-muted">Network</div>
              <strong><span class="badge badge-base">BASE</span></strong>
            </div>
            <div>
              <div class="text-muted">Accounts Created</div>
              <strong>231</strong>
            </div>
            <div>
              <div class="text-muted">Status</div>
              <span class="badge badge-active">Active</span>
            </div>
          </div>
          <div style="background: #f0fdf4; padding: 1rem; border-radius: 0.5rem;">
            <div style="font-weight: 500; color: #047857; margin-bottom: 0.5rem;">✓ Factory Operational</div>
            <div class="text-sm" style="color: #047857;">All account abstractions working correctly</div>
          </div>
        </div>
      </div>

      <!-- EAS Schema Registry -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>EAS Schema Registry</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; gap: 1rem;">
            <div style="border-left: 4px solid #0284c7; padding-left: 1rem;">
              <div style="font-weight: 500; color: #0284c7;">Engagement Completion</div>
              <div style="font-family: monospace; font-size: 0.75rem; word-break: break-all; color: #0284c7; margin-top: 0.25rem;">0xc4a4b1a0c8f3e2b5d9a1c7f4e8b2d6a9c3f1e5b8</div>
            </div>
            <div style="border-left: 4px solid #22c55e; padding-left: 1rem;">
              <div style="font-weight: 500; color: #047857;">Skill Verification</div>
              <div style="font-family: monospace; font-size: 0.75rem; word-break: break-all; color: #047857; margin-top: 0.25rem;">0xd5b5c2b1d9g4f3c6e0b2d8g5f9c3e7b0d4g2f6c9</div>
            </div>
            <div style="border-left: 4px solid #8b5cf6; padding-left: 1rem;">
              <div style="font-weight: 500; color: #6d28d9;">Trust Tier Upgrade</div>
              <div style="font-family: monospace; font-size: 0.75rem; word-break: break-all; color: #6d28d9; margin-top: 0.25rem;">0xe6c6d3c2e0h5g4d7f1c3e9h6g0d4f8c1h5g7d0</div>
            </div>
            <div style="border-left: 4px solid #f59e0b; padding-left: 1rem;">
              <div style="font-weight: 500; color: #b45309;">Outcome Verification</div>
              <div style="font-family: monospace; font-size: 0.75rem; word-break: break-all; color: #b45309; margin-top: 0.25rem;">0xf7d7e4d3f1i6h5e8g2d4f0i7h1e5g9d2i6h8e1</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Session Key Policies -->
      <div class="card">
        <div class="card-header">
          <h2>Session Key Policies</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Policy Name</th>
                <th>Max Duration</th>
                <th>Spending Limit</th>
                <th>Scope</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Apply Opportunities</strong></td>
                <td>30 days</td>
                <td>2,000 USDC</td>
                <td>Opportunity submissions</td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Pay Fees</strong></td>
                <td>90 days</td>
                <td>500 USDC</td>
                <td>Platform fees only</td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Escrow Operations</strong></td>
                <td>180 days</td>
                <td>10,000 USDC</td>
                <td>Escrow deposits & releases</td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>View Only</strong></td>
                <td>365 days</td>
                <td>0 USDC</td>
                <td>Read-only access</td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Network Configuration -->
      <div class="card" style="margin-top: 2rem;">
        <div class="card-header">
          <h2>Network Configuration</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; gap: 1.5rem;">
            <!-- BASE Chain -->
            <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <div>
                  <div style="font-weight: 500; display: flex; align-items: center; gap: 0.5rem;">
                    <div style="width: 12px; height: 12px; border-radius: 50%; background: #0284c7;"></div>
                    BASE Chain (Primary)
                  </div>
                </div>
                <span class="badge badge-active">Connected</span>
              </div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem;">
                <div>
                  <div class="text-muted">RPC Endpoint</div>
                  <div style="font-family: monospace; font-size: 0.75rem; word-break: break-all;">https://mainnet.base.org</div>
                </div>
                <div>
                  <div class="text-muted">Explorer</div>
                  <a href="#" style="color: #0284c7; font-size: 0.75rem;">basescan.org</a>
                </div>
              </div>
            </div>

            <!-- Ethereum -->
            <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <div>
                  <div style="font-weight: 500; display: flex; align-items: center; gap: 0.5rem;">
                    <div style="width: 12px; height: 12px; border-radius: 50%; background: #7c3aed;"></div>
                    Ethereum (Secondary)
                  </div>
                </div>
                <span class="badge badge-active">Connected</span>
              </div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem;">
                <div>
                  <div class="text-muted">RPC Endpoint</div>
                  <div style="font-family: monospace; font-size: 0.75rem; word-break: break-all;">https://eth-mainnet.g.alchemy.com</div>
                </div>
                <div>
                  <div class="text-muted">Explorer</div>
                  <a href="#" style="color: #0284c7; font-size: 0.75rem;">etherscan.io</a>
                </div>
              </div>
            </div>

            <!-- Linea -->
            <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <div>
                  <div style="font-weight: 500; display: flex; align-items: center; gap: 0.5rem;">
                    <div style="width: 12px; height: 12px; border-radius: 50%; background: #f59e0b;"></div>
                    Linea (Secondary)
                  </div>
                </div>
                <span class="badge badge-active">Connected</span>
              </div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem;">
                <div>
                  <div class="text-muted">RPC Endpoint</div>
                  <div style="font-family: monospace; font-size: 0.75rem; word-break: break-all;">https://rpc.linea.build</div>
                </div>
                <div>
                  <div class="text-muted">Explorer</div>
                  <a href="#" style="color: #0284c7; font-size: 0.75rem;">lineascan.build</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * 14. AGENT APPROVALS
 * Approve or reject agent registrations
 */
function renderAgentApprovals(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Agent Approvals</h1>
        <p class="text-muted">Review and approve agent registrations</p>
      </div>

      <!-- Pending Approvals -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Pending Approvals</h2>
          <div class="card-header-actions">
            <span style="font-size: 0.875rem; color: #6b7280;">4 agents</span>
          </div>
        </div>
        <div style="padding: 1.5rem; display: grid; gap: 1.5rem;">
          <!-- Agent 1 -->
          <div style="border: 1px solid #fbbf24; border-radius: 0.5rem; padding: 1rem; background: #fffbeb;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Agent Name</div>
                <strong>Alex Automation</strong>
              </div>
              <div>
                <div class="text-muted">Type</div>
                <strong>Data Processing Agent</strong>
              </div>
              <div>
                <div class="text-muted">Organization</div>
                <strong>Healthcare Access Initiative</strong>
              </div>
              <div>
                <div class="text-muted">Requested Tier</div>
                <span class="badge badge-advisor">Advisor</span>
              </div>
            </div>
            <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <strong style="color: #d97706;">Capabilities:</strong> Data aggregation, Report generation, Outcome calculation
            </div>
            <div style="margin-bottom: 1rem; font-size: 0.875rem;">
              <strong>Requested Chain:</strong> <span class="badge badge-base">BASE</span>
            </div>
            <div style="display: flex; gap: 0.75rem;">
              <button class="btn btn-sm btn-success" onclick="showAgentApprovalModal('Alex Automation', 'Data Processing Agent', 'Healthcare Access Initiative')">Approve</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Changes requested from org', 'warning')">Request Changes</button>
              <button class="btn btn-sm btn-danger" onclick="showToast('Application rejected', 'error')">Reject</button>
            </div>
          </div>

          <!-- Agent 2 -->
          <div style="border: 1px solid #fbbf24; border-radius: 0.5rem; padding: 1rem; background: #fffbeb;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Agent Name</div>
                <strong>Coordinator Bot</strong>
              </div>
              <div>
                <div class="text-muted">Type</div>
                <strong>Matching & Coordination</strong>
              </div>
              <div>
                <div class="text-muted">Organization</div>
                <strong>Youth Workforce Alliance</strong>
              </div>
              <div>
                <div class="text-muted">Requested Tier</div>
                <span class="badge badge-coordinator">Coordinator</span>
              </div>
            </div>
            <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <strong style="color: #d97706;">Capabilities:</strong> Candidate matching, Need assessment, Engagement creation
            </div>
            <div style="margin-bottom: 1rem; font-size: 0.875rem;">
              <strong>Requested Chain:</strong> <span class="badge badge-base">BASE</span> <span class="badge badge-eth">ETH</span>
            </div>
            <div style="display: flex; gap: 0.75rem;">
              <button class="btn btn-sm btn-success" onclick="showAgentApprovalModal('Coordinator Bot', 'Matching & Coordination', 'Youth Workforce Alliance')">Approve</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Changes requested from org', 'warning')">Request Changes</button>
              <button class="btn btn-sm btn-danger" onclick="showToast('Application rejected', 'error')">Reject</button>
            </div>
          </div>

          <!-- Agent 3 -->
          <div style="border: 1px solid #fbbf24; border-radius: 0.5rem; padding: 1rem; background: #fffbeb;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Agent Name</div>
                <strong>Impact Verifier</strong>
              </div>
              <div>
                <div class="text-muted">Type</div>
                <strong>Attestation & Verification</strong>
              </div>
              <div>
                <div class="text-muted">Organization</div>
                <strong>Housing First DFW</strong>
              </div>
              <div>
                <div class="text-muted">Requested Tier</div>
                <span class="badge badge-coordinator">Coordinator</span>
              </div>
            </div>
            <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <strong style="color: #d97706;">Capabilities:</strong> Outcome verification, Evidence collection, Attestation creation
            </div>
            <div style="margin-bottom: 1rem; font-size: 0.875rem;">
              <strong>Requested Chain:</strong> <span class="badge badge-base">BASE</span>
            </div>
            <div style="display: flex; gap: 0.75rem;">
              <button class="btn btn-sm btn-success" onclick="showAgentApprovalModal('Impact Verifier', 'Attestation & Verification', 'Housing First DFW')">Approve</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Changes requested from org', 'warning')">Request Changes</button>
              <button class="btn btn-sm btn-danger" onclick="showToast('Application rejected', 'error')">Reject</button>
            </div>
          </div>

          <!-- Agent 4 -->
          <div style="border: 1px solid #fbbf24; border-radius: 0.5rem; padding: 1rem; background: #fffbeb;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Agent Name</div>
                <strong>Report Generator</strong>
              </div>
              <div>
                <div class="text-muted">Type</div>
                <strong>Reporting & Analytics</strong>
              </div>
              <div>
                <div class="text-muted">Organization</div>
                <strong>DFW Education Collective</strong>
              </div>
              <div>
                <div class="text-muted">Requested Tier</div>
                <span class="badge badge-advisor">Advisor</span>
              </div>
            </div>
            <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <strong style="color: #d97706;">Capabilities:</strong> Report generation, Data analysis, Dashboard creation
            </div>
            <div style="margin-bottom: 1rem; font-size: 0.875rem;">
              <strong>Requested Chain:</strong> <span class="badge badge-base">BASE</span> <span class="badge badge-eth">ETH</span> <span class="badge badge-linea">LINEA</span>
            </div>
            <div style="display: flex; gap: 0.75rem;">
              <button class="btn btn-sm btn-success" onclick="showAgentApprovalModal('Report Generator', 'Reporting & Analytics', 'DFW Education Collective')">Approve</button>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Changes requested from org', 'warning')">Request Changes</button>
              <button class="btn btn-sm btn-danger" onclick="showToast('Application rejected', 'error')">Reject</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Recently Processed -->
      <div class="card">
        <div class="card-header">
          <h2>Recently Processed</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Agent</th>
                <th>Decision</th>
                <th>Reviewer</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Healthcare Monitor</strong></td>
                <td><span class="badge badge-success">Approved</span></td>
                <td>John Kim</td>
                <td>Feb 15, 2026</td>
              </tr>
              <tr>
                <td><strong>Payment Processor</strong></td>
                <td><span class="badge badge-success">Approved</span></td>
                <td>Sarah Chen</td>
                <td>Feb 12, 2026</td>
              </tr>
              <tr>
                <td><strong>Scout Bot</strong></td>
                <td><span class="badge badge-success">Approved</span></td>
                <td>Marcus Rodriguez</td>
                <td>Feb 10, 2026</td>
              </tr>
              <tr>
                <td><strong>Community Crawler</strong></td>
                <td><span class="badge" style="background: #fee2e2; color: #991b1b;">Rejected</span></td>
                <td>John Kim</td>
                <td>Feb 8, 2026</td>
              </tr>
              <tr>
                <td><strong>Scheduler Agent</strong></td>
                <td><span class="badge badge-success">Approved</span></td>
                <td>Sarah Chen</td>
                <td>Feb 5, 2026</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Auto-Approval Rules -->
      <div class="card" style="margin-top: 2rem;">
        <div class="card-header">
          <h2>Auto-Approval Rules</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div style="font-weight: 500;">Auto-approve Advisor-tier agents</div>
              <div class="text-sm text-muted">For trusted organizations only</div>
            </div>
            <input type="checkbox" style="width: 20px; height: 20px;">
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * Modal for agent approval confirmation
 */
function showAgentApprovalModal(agentName, agentType, org) {
  const content = `
    <div style="line-height: 1.6;">
      <div style="background: #f0fdf4; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem; border-left: 4px solid #22c55e;">
        <div style="font-weight: 500; color: #047857; margin-bottom: 0.5rem;">ERC-8004 Registration Preview</div>
        <div style="font-family: monospace; font-size: 0.75rem; color: #047857; word-break: break-all;">
          {<br/>
          &nbsp;&nbsp;"agentId": "0xagent_${Math.random().toString(36).substr(2, 9)}",<br/>
          &nbsp;&nbsp;"name": "${agentName}",<br/>
          &nbsp;&nbsp;"type": "${agentType}",<br/>
          &nbsp;&nbsp;"organization": "${org}",<br/>
          &nbsp;&nbsp;"tier": "Advisor",<br/>
          &nbsp;&nbsp;"chains": ["base", "eth", "linea"],<br/>
          &nbsp;&nbsp;"timestamp": ${Date.now()}<br/>
          }
        </div>
      </div>
      <div style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem; font-size: 0.875rem;">
        <div style="font-weight: 500; margin-bottom: 0.75rem;">Approval Details</div>
        <div style="display: grid; gap: 0.75rem;">
          <div>
            <span class="text-muted">Agent:</span> <strong>${agentName}</strong>
          </div>
          <div>
            <span class="text-muted">Organization:</span> <strong>${org}</strong>
          </div>
          <div>
            <span class="text-muted">Registration Cost:</span> <strong>~0.003 ETH (gas)</strong>
          </div>
        </div>
      </div>
      <div style="background: #f3f0ff; padding: 1rem; border-radius: 0.5rem;">
        <div style="font-weight: 500; color: #6d28d9; margin-bottom: 0.5rem;">⚠️ Confirmation Required</div>
        <p style="margin: 0; font-size: 0.875rem; color: #6d28d9;">This action will register the agent on-chain and grant it access to the protocol.</p>
      </div>
    </div>
  `;
  const footer = `
    <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
    <button class="btn btn-success" onclick="closeModal(); showToast('Agent approved and registered!', 'success')">Confirm Approval</button>
  `;
  showModal(`Approve Agent - ${agentName}`, content, footer);
}

/**
 * 15. AUDIT LOG
 * System audit and compliance log
 */
function renderAuditLog(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Audit Log</h1>
        <p class="text-muted">System events, compliance records, and action history</p>
      </div>

      <!-- Filters -->
      <div class="card" style="margin-bottom: 2rem;">
        <div style="padding: 1.5rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
          <div class="form-group">
            <label>Event Type</label>
            <select>
              <option>All Events</option>
              <option>Agent Registration</option>
              <option>Attestation</option>
              <option>Fund Transfer</option>
              <option>Access Control</option>
              <option>Configuration Change</option>
            </select>
          </div>
          <div class="form-group">
            <label>Severity</label>
            <select>
              <option>All Levels</option>
              <option>Critical</option>
              <option>High</option>
              <option>Medium</option>
              <option>Low</option>
              <option>Info</option>
            </select>
          </div>
          <div class="form-group">
            <label>Date Range</label>
            <input type="date" style="width: 100%;">
          </div>
          <div class="form-group">
            <label>Search</label>
            <input type="text" placeholder="Search audit log..." style="width: 100%;">
          </div>
        </div>
      </div>

      <!-- Audit Log Table -->
      <div class="card">
        <div class="card-header">
          <h2>Audit Log</h2>
          <div class="card-header-actions">
            <button class="btn btn-sm btn-secondary" onclick="showToast('Log exported to CSV', 'success')">Export</button>
          </div>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Timestamp</th>
                <th>Event</th>
                <th>Actor</th>
                <th>Detail</th>
                <th>Severity</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Feb 20, 14:32</td>
                <td><strong>Attestation Created</strong></td>
                <td>Alex Martinez</td>
                <td>Engagement completion for Community Health Plus</td>
                <td><span class="badge badge-success">Info</span></td>
              </tr>
              <tr>
                <td>Feb 20, 13:15</td>
                <td><strong>User Role Updated</strong></td>
                <td>John Kim (Admin)</td>
                <td>Sarah Chen promoted from Advisor to Coordinator</td>
                <td><span class="badge badge-pending">Medium</span></td>
              </tr>
              <tr>
                <td>Feb 20, 12:47</td>
                <td><strong>Escrow Released</strong></td>
                <td>System (Automated)</td>
                <td>$2,500 USDC released for verified milestone</td>
                <td><span class="badge badge-success">Info</span></td>
              </tr>
              <tr>
                <td>Feb 20, 11:28</td>
                <td><strong>Agent Registered</strong></td>
                <td>Healthcare Access Initiative</td>
                <td>Healthcare Monitor agent registered on BASE</td>
                <td><span class="badge badge-pending">Medium</span></td>
              </tr>
              <tr>
                <td>Feb 20, 10:15</td>
                <td><strong>Configuration Changed</strong></td>
                <td>John Kim (Admin)</td>
                <td>Session key duration changed from 30 to 60 days</td>
                <td><span class="badge" style="background: #fca5a5; color: #7f1d1d;">High</span></td>
              </tr>
              <tr>
                <td>Feb 20, 09:32</td>
                <td><strong>Access Granted</strong></td>
                <td>John Kim (Admin)</td>
                <td>David Kim invited to platform as Viewer</td>
                <td><span class="badge badge-success">Info</span></td>
              </tr>
              <tr>
                <td>Feb 19, 16:45</td>
                <td><strong>Fund Transfer</strong></td>
                <td>System (Automated)</td>
                <td>$1,500 USDC disbursed to Youth Workforce Alliance</td>
                <td><span class="badge badge-success">Info</span></td>
              </tr>
              <tr>
                <td>Feb 19, 15:22</td>
                <td><strong>Engagement Created</strong></td>
                <td>Sarah Chen (Coordinator)</td>
                <td>Match confirmed between Alex Martinez and Community Health Plus</td>
                <td><span class="badge badge-success">Info</span></td>
              </tr>
              <tr>
                <td>Feb 19, 14:08</td>
                <td><strong>Compliance Report</strong></td>
                <td>System (Automated)</td>
                <td>Monthly compliance report generated and sent</td>
                <td><span class="badge badge-success">Info</span></td>
              </tr>
              <tr>
                <td>Feb 19, 12:33</td>
                <td><strong>Access Denied</strong></td>
                <td>Unknown User</td>
                <td>Failed login attempt from 192.168.1.100</td>
                <td><span class="badge badge-pending">Medium</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Pagination -->
      <div style="display: flex; justify-content: center; align-items: center; gap: 1rem; margin-top: 2rem;">
        <button class="btn btn-secondary btn-sm" onclick="showToast('Previous page', 'info')">← Previous</button>
        <span class="text-sm text-muted">Page 1 of 8</span>
        <button class="btn btn-secondary btn-sm" onclick="showToast('Next page', 'info')">Next →</button>
      </div>
    </div>
  `;
  return html;
}

/**
 * 16. COALITION SETTINGS
 * Coordinator coalition configuration and policies
 */
function renderCoalitionSettings(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Coalition Settings</h1>
        <p class="text-muted">Unite DFW configuration and coordination policies</p>
      </div>

      <!-- Coalition Profile -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Coalition Profile</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div class="form-group">
            <label>Coalition Name</label>
            <input type="text" value="Unite DFW" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>
          <div class="form-group">
            <label>Description</label>
            <textarea style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; min-height: 100px;">A collaborative network of organizations working to strengthen the Dallas-Fort Worth community through coordinated impact initiatives, trusted partnerships, and data-driven outcomes.</textarea>
          </div>
          <div class="form-group">
            <label>Founded</label>
            <input type="date" value="2025-05-01" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>
          <div class="form-group">
            <label>Region</label>
            <input type="text" value="Dallas-Fort Worth, Texas" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>
        </div>
      </div>

      <!-- Trust Policies -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Trust Policies</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div class="form-group">
            <label>Minimum Trust Tier for Coordination</label>
            <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
              <option>Observer</option>
              <option selected>Advisor</option>
              <option>Coordinator</option>
            </select>
          </div>
          <div class="form-group">
            <label>Auto-Approval Threshold (%)</label>
            <input type="number" value="75" min="0" max="100" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>
          <div class="form-group">
            <label>Escalation Rule</label>
            <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
              <option selected>Coordinator Review</option>
              <option>Steward Vote</option>
              <option>Coalition Council Vote</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Onboarding Settings -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Onboarding Settings</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div class="form-group">
            <label>Default Role for New Members</label>
            <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
              <option selected>Observer</option>
              <option>Advisor</option>
            </select>
          </div>
          <div class="form-group">
            <label>Required Verifications (comma-separated)</label>
            <input type="text" value="Email, Identity, Background" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>
          <div class="form-group">
            <label>Probation Period (days)</label>
            <input type="number" value="30" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>
        </div>
      </div>

      <!-- Communication Preferences -->
      <div class="card">
        <div class="card-header">
          <h2>Communication Preferences</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; gap: 1rem;">
            <div>
              <label style="font-weight: 500;">Notification Channels</label>
              <div style="display: grid; gap: 0.75rem; margin-top: 0.75rem;">
                <div style="display: flex; align-items: center;">
                  <input type="checkbox" id="email" checked>
                  <label for="email" style="margin-left: 0.75rem; margin-bottom: 0;">Email</label>
                </div>
                <div style="display: flex; align-items: center;">
                  <input type="checkbox" id="sms" checked>
                  <label for="sms" style="margin-left: 0.75rem; margin-bottom: 0;">SMS</label>
                </div>
                <div style="display: flex; align-items: center;">
                  <input type="checkbox" id="slack" checked>
                  <label for="slack" style="margin-left: 0.75rem; margin-bottom: 0;">Slack</label>
                </div>
                <div style="display: flex; align-items: center;">
                  <input type="checkbox" id="inapp" checked>
                  <label for="inapp" style="margin-left: 0.75rem; margin-bottom: 0;">In-App</label>
                </div>
              </div>
            </div>
            <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem;">
              <label>Digest Frequency</label>
              <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; margin-top: 0.75rem;">
                <option>Immediate</option>
                <option selected>Daily</option>
                <option>Weekly</option>
                <option>Monthly</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div style="display: flex; gap: 1rem; margin-top: 2rem;">
        <button class="btn btn-primary" onclick="showToast('Coalition settings saved', 'success')">Save Changes</button>
        <button class="btn btn-secondary" onclick="showToast('Settings reset', 'warning')">Reset to Defaults</button>
      </div>
    </div>
  `;
  return html;
}

/**
 * 17. MEMBER ORGANIZATIONS
 * Coordinator member org management and onboarding
 */
function renderMemberOrganizations(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Member Organizations</h1>
        <p class="text-muted">Unite DFW member directory and onboarding management</p>
      </div>

      <!-- Stats -->
      <div class="stat-grid">
        <div class="stat-card">
          <div class="stat-label">Total Members</div>
          <div class="stat-value">10</div>
          <div class="stat-subtext">Active organizations</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Active Contributors</div>
          <div class="stat-value">8</div>
          <div class="stat-subtext">In good standing</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Onboarding</div>
          <div class="stat-value">2</div>
          <div class="stat-subtext">In progress</div>
        </div>
      </div>

      <!-- Member Organizations Table -->
      <div class="card">
        <div class="card-header">
          <h2>Member Organizations</h2>
          <div class="card-header-actions">
            <button class="btn btn-sm btn-primary" onclick="showToast('Invite form opened', 'info')">+ Invite Organization</button>
          </div>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Organization</th>
                <th>Sector</th>
                <th>Agents</th>
                <th>Engagements</th>
                <th>Trust Tier</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Healthcare Access Initiative</strong></td>
                <td>Healthcare</td>
                <td>2</td>
                <td>7</td>
                <td><span class="badge badge-coordinator">Coordinator</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showOrgDetailModal('Healthcare Access Initiative')">Details</button></td>
              </tr>
              <tr>
                <td><strong>Youth Workforce Alliance</strong></td>
                <td>Education</td>
                <td>1</td>
                <td>5</td>
                <td><span class="badge badge-advisor">Advisor</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showOrgDetailModal('Youth Workforce Alliance')">Details</button></td>
              </tr>
              <tr>
                <td><strong>Housing First DFW</strong></td>
                <td>Housing</td>
                <td>1</td>
                <td>4</td>
                <td><span class="badge badge-coordinator">Coordinator</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showOrgDetailModal('Housing First DFW')">Details</button></td>
              </tr>
              <tr>
                <td><strong>DFW Education Collective</strong></td>
                <td>Education</td>
                <td>1</td>
                <td>3</td>
                <td><span class="badge badge-advisor">Advisor</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showOrgDetailModal('DFW Education Collective')">Details</button></td>
              </tr>
              <tr>
                <td><strong>Tech for Social Good</strong></td>
                <td>Technology</td>
                <td>1</td>
                <td>4</td>
                <td><span class="badge badge-observer">Observer</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showOrgDetailModal('Tech for Social Good')">Details</button></td>
              </tr>
              <tr>
                <td><strong>Urban Agriculture Initiative</strong></td>
                <td>Environment</td>
                <td>0</td>
                <td>3</td>
                <td><span class="badge badge-observer">Observer</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showOrgDetailModal('Urban Agriculture Initiative')">Details</button></td>
              </tr>
              <tr>
                <td><strong>Mental Health Services Coalition</strong></td>
                <td>Healthcare</td>
                <td>0</td>
                <td>2</td>
                <td><span class="badge badge-observer">Observer</span></td>
                <td><span class="badge badge-pending">Onboarding</span></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showOrgDetailModal('Mental Health Services Coalition')">Details</button></td>
              </tr>
              <tr>
                <td><strong>Community Garden Initiative</strong></td>
                <td>Environment</td>
                <td>0</td>
                <td>2</td>
                <td><span class="badge badge-observer">Observer</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showOrgDetailModal('Community Garden Initiative')">Details</button></td>
              </tr>
              <tr>
                <td><strong>Community Health Plus</strong></td>
                <td>Healthcare</td>
                <td>1</td>
                <td>2</td>
                <td><span class="badge badge-advisor">Advisor</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showOrgDetailModal('Community Health Plus')">Details</button></td>
              </tr>
              <tr>
                <td><strong>Healthcare Access Coalition</strong></td>
                <td>Healthcare</td>
                <td>1</td>
                <td>1</td>
                <td><span class="badge badge-observer">Observer</span></td>
                <td><span class="badge badge-pending">Onboarding</span></td>
                <td><button class="btn btn-sm btn-secondary" onclick="showOrgDetailModal('Healthcare Access Coalition')">Details</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Onboarding Queue -->
      <div class="card" style="margin-top: 2rem;">
        <div class="card-header">
          <h2>Onboarding Queue</h2>
        </div>
        <div style="padding: 1.5rem; display: grid; gap: 1rem;">
          <div style="border-left: 4px solid #3b82f6; padding-left: 1rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <strong>Mental Health Services Coalition</strong>
              <span class="badge badge-pending">Step 2 of 4</span>
            </div>
            <div class="text-sm text-muted">Awaiting verification documents</div>
            <div style="margin-top: 0.75rem;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                <span class="text-sm">Progress</span>
                <strong>50%</strong>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 50%;"></div>
              </div>
            </div>
          </div>
          <div style="border-left: 4px solid #3b82f6; padding-left: 1rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <strong>Healthcare Access Coalition</strong>
              <span class="badge badge-pending">Step 1 of 4</span>
            </div>
            <div class="text-sm text-muted">Initial verification in progress</div>
            <div style="margin-top: 0.75rem;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                <span class="text-sm">Progress</span>
                <strong>25%</strong>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 25%;"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * Modal for org details
 */
function showOrgDetailModal(orgName) {
  const content = `
    <div style="line-height: 1.6;">
      <div style="margin-bottom: 1.5rem;">
        <div style="font-weight: 500; margin-bottom: 0.5rem;">Full Profile</div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem;">
          <div>
            <div class="text-muted">Organization</div>
            <strong>${orgName}</strong>
          </div>
          <div>
            <div class="text-muted">Status</div>
            <span class="badge badge-active">Active</span>
          </div>
          <div>
            <div class="text-muted">Joined</div>
            <strong>May 15, 2025</strong>
          </div>
          <div>
            <div class="text-muted">Trust Tier</div>
            <span class="badge badge-coordinator">Coordinator</span>
          </div>
        </div>
      </div>
      <div style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
        <div style="font-weight: 500; margin-bottom: 0.75rem;">Quick Stats</div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem;">
          <div>
            <span class="text-muted">Active Agents:</span> <strong>2</strong>
          </div>
          <div>
            <span class="text-muted">Engagements:</span> <strong>7</strong>
          </div>
          <div>
            <span class="text-muted">Budget:</span> <strong>$250K</strong>
          </div>
          <div>
            <span class="text-muted">Compliance:</span> <strong>100%</strong>
          </div>
        </div>
      </div>
    </div>
  `;
  const footer = `
    <button class="btn btn-secondary" onclick="closeModal()">Close</button>
  `;
  showModal(`Organization Details - ${orgName}`, content, footer);
}

/**
 * 18. COORDINATOR SYNC
 * Coordinator collaboration and overlap detection
 */
function renderCoordinatorSync(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Coordinator Sync</h1>
        <p class="text-muted">Real-time collaboration and workload coordination</p>
      </div>

      <!-- Active Coordinators -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Active Coordinators</h2>
        </div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; padding: 1.5rem;">
          <!-- Coordinator 1 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 1rem;">
              <div>
                <div style="font-weight: 500;">Sarah Chen</div>
                <div class="text-sm text-muted">Healthcare Sector</div>
              </div>
              <div style="width: 12px; height: 12px; border-radius: 50%; background: #22c55e;"></div>
            </div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem;">
              <div class="text-sm text-muted">Current Activity</div>
              <div style="font-size: 0.875rem; margin-top: 0.25rem;">Reviewing 4 match candidates</div>
            </div>
            <div style="display: flex; justify-content: space-between; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Active Matches</div>
                <strong>6</strong>
              </div>
              <div>
                <div class="text-muted">Capacity</div>
                <strong>78%</strong>
              </div>
            </div>
          </div>

          <!-- Coordinator 2 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 1rem;">
              <div>
                <div style="font-weight: 500;">Marcus Rodriguez</div>
                <div class="text-sm text-muted">Education Sector</div>
              </div>
              <div style="width: 12px; height: 12px; border-radius: 50%; background: #22c55e;"></div>
            </div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem;">
              <div class="text-sm text-muted">Current Activity</div>
              <div style="font-size: 0.875rem; margin-top: 0.25rem;">Finalizing engagement agreement</div>
            </div>
            <div style="display: flex; justify-content: space-between; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Active Matches</div>
                <strong>5</strong>
              </div>
              <div>
                <div class="text-muted">Capacity</div>
                <strong>62%</strong>
              </div>
            </div>
          </div>

          <!-- Coordinator 3 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 1rem;">
              <div>
                <div style="font-weight: 500;">Jennifer Lopez</div>
                <div class="text-sm text-muted">Housing Sector</div>
              </div>
              <div style="width: 12px; height: 12px; border-radius: 50%; background: #a1a5a9;"></div>
            </div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem;">
              <div class="text-sm text-muted">Current Activity</div>
              <div style="font-size: 0.875rem; margin-top: 0.25rem;">Away from desk</div>
            </div>
            <div style="display: flex; justify-content: space-between; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Active Matches</div>
                <strong>3</strong>
              </div>
              <div>
                <div class="text-muted">Capacity</div>
                <strong>41%</strong>
              </div>
            </div>
          </div>

          <!-- Coordinator 4 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 1rem;">
              <div>
                <div style="font-weight: 500;">David Kim</div>
                <div class="text-sm text-muted">Tech Sector</div>
              </div>
              <div style="width: 12px; height: 12px; border-radius: 50%; background: #22c55e;"></div>
            </div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem;">
              <div class="text-sm text-muted">Current Activity</div>
              <div style="font-size: 0.875rem; margin-top: 0.25rem;">Updating organization profiles</div>
            </div>
            <div style="display: flex; justify-content: space-between; font-size: 0.875rem;">
              <div>
                <div class="text-muted">Active Matches</div>
                <strong>4</strong>
              </div>
              <div>
                <div class="text-muted">Capacity</div>
                <strong>55%</strong>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Overlap Detection -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Overlap Detection Alerts</h2>
        </div>
        <div style="padding: 1.5rem; display: grid; gap: 1rem;">
          <div style="border-left: 4px solid #f59e0b; padding-left: 1rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <strong>Potential Duplicate Match</strong>
              <span class="badge" style="background: #fef3c7; color: #92400e;">Alert</span>
            </div>
            <div class="text-sm text-muted">Sarah Chen and Marcus Rodriguez both engaging with Alex Martinez</div>
            <div style="margin-top: 0.75rem;">
              <button class="btn btn-sm btn-secondary" onclick="showToast('Coordination message sent', 'info')">Coordinate</button>
            </div>
          </div>
          <div style="border-left: 4px solid #f59e0b; padding-left: 1rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <strong>Sector Overlap - Education</strong>
              <span class="badge" style="background: #fef3c7; color: #92400e;">Alert</span>
            </div>
            <div class="text-sm text-muted">Marcus Rodriguez and Jennifer Lopez overlapping in education coordinations</div>
            <div style="margin-top: 0.75rem;">
              <button class="btn btn-sm btn-secondary" onclick="showToast('Coordination message sent', 'info')">Coordinate</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Communication Log -->
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <h2>Communication Log</h2>
          </div>
          <div class="timeline" style="padding: 1.5rem;">
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #0284c7;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">Sarah Chen commented</div>
                <div class="text-sm text-muted">"Alex Martinez confirmed for healthcare role"</div>
                <div class="text-sm text-muted">2 hours ago</div>
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #0284c7;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">Marcus Rodriguez shared</div>
                <div class="text-sm text-muted">Education collaboration guidelines doc</div>
                <div class="text-sm text-muted">4 hours ago</div>
              </div>
            </div>
            <div class="timeline-item">
              <div class="timeline-dot" style="background: #0284c7;"></div>
              <div class="timeline-content">
                <div style="font-weight: 500;">David Kim pinged</div>
                <div class="text-sm text-muted">Team sync discussion on cross-sector matching</div>
                <div class="text-sm text-muted">Yesterday</div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>Workload Distribution</h2>
          </div>
          <div style="padding: 1.5rem;">
            <div style="display: grid; gap: 1rem;">
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Sarah Chen</span>
                  <strong>6 engagements</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 60%;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Marcus Rodriguez</span>
                  <strong>5 engagements</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 50%;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">David Kim</span>
                  <strong>4 engagements</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 40%;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <span class="text-sm">Jennifer Lopez</span>
                  <strong>3 engagements</strong>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 30%;"></div>
                </div>
              </div>
              <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem; margin-top: 1rem;">
                <div style="text-align: center; font-size: 0.875rem; color: #6b7280;">Average: 4.5 engagements per coordinator</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * 19. ORG SETTINGS
 * Organization admin settings and profile
 */
function renderOrgSettings(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Organization Settings</h1>
        <p class="text-muted">Profile, verification, and configuration</p>
      </div>

      <!-- Organization Profile -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Organization Profile</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div class="form-group">
            <label>Organization Name</label>
            <input type="text" value="Healthcare Access Initiative" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>
          <div class="form-group">
            <label>Sector</label>
            <input type="text" value="Healthcare" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>
          <div class="form-group">
            <label>Address</label>
            <input type="text" value="1500 Main Street, Dallas, TX 75201" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>
          <div class="form-group">
            <label>Website</label>
            <input type="url" value="https://healthcareaccessdfw.org" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>
          <div class="form-group">
            <label>Description</label>
            <textarea style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; min-height: 100px;">Healthcare Access Initiative works to expand access to quality healthcare services across the Dallas-Fort Worth region through community partnerships and innovative care delivery models.</textarea>
          </div>
        </div>
      </div>

      <!-- Verification Status -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Verification Status</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; gap: 1rem;">
            <div style="display: flex; align-items: center; justify-content: space-between;">
              <div>
                <div style="font-weight: 500;">Email Verification</div>
                <div class="text-sm text-muted">Verified on Jan 10, 2026</div>
              </div>
              <span class="badge badge-success">✓ Verified</span>
            </div>
            <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem; display: flex; align-items: center; justify-content: space-between;">
              <div>
                <div style="font-weight: 500;">Organization Registration</div>
                <div class="text-sm text-muted">On-chain verified on BASE chain</div>
              </div>
              <span class="badge badge-success">✓ Verified</span>
            </div>
            <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem; display: flex; align-items: center; justify-content: space-between;">
              <div>
                <div style="font-weight: 500;">Tax Status (501c3)</div>
                <div class="text-sm text-muted">Awaiting document upload</div>
              </div>
              <span class="badge badge-pending">⏳ Pending</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Privacy Settings -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Privacy Settings</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; gap: 1rem;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div>
                <div style="font-weight: 500;">Data Sharing with Coalition</div>
                <div class="text-sm text-muted">Allow partners to access program data</div>
              </div>
              <input type="checkbox" checked style="width: 20px; height: 20px;">
            </div>
            <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem; display: flex; justify-content: space-between; align-items: center;">
              <div>
                <div style="font-weight: 500;">Public Profile</div>
                <div class="text-sm text-muted">Show organization on community directory</div>
              </div>
              <input type="checkbox" checked style="width: 20px; height: 20px;">
            </div>
            <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem; display: flex; justify-content: space-between; align-items: center;">
              <div>
                <div style="font-weight: 500;">Allow Outcome Attestations</div>
                <div class="text-sm text-muted">Publish verified outcomes on-chain</div>
              </div>
              <input type="checkbox" checked style="width: 20px; height: 20px;">
            </div>
          </div>
        </div>
      </div>

      <!-- API & Integrations -->
      <div class="card">
        <div class="card-header">
          <h2>API & Integrations</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="margin-bottom: 1.5rem;">
            <label>API Key</label>
            <div style="display: flex; gap: 0.75rem; margin-top: 0.75rem;">
              <input type="password" value="sk_live_abc123xyz789..." style="flex: 1; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
              <button class="btn btn-secondary btn-sm" onclick="showToast('API key copied', 'success')">Copy</button>
            </div>
          </div>

          <div style="margin-bottom: 1.5rem;">
            <label>Webhook URL</label>
            <input type="url" value="https://yourdomain.com/webhooks/unite-dfw" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          </div>

          <div style="background: #f0f9ff; padding: 1rem; border-radius: 0.5rem;">
            <div style="font-weight: 500; color: #0284c7; margin-bottom: 0.5rem;">Documentation</div>
            <p style="margin: 0; font-size: 0.875rem; color: #0284c7;">
              <a href="#" style="color: #0284c7; text-decoration: underline;">View API Documentation</a>
            </p>
          </div>
        </div>
      </div>

      <!-- Save Button -->
      <div style="margin-top: 2rem;">
        <button class="btn btn-primary" onclick="showToast('Organization settings saved', 'success')">Save Changes</button>
      </div>
    </div>
  `;
  return html;
}

/**
 * 20. TEAM MANAGEMENT
 * Org admin team member management
 */
function renderTeamManagement(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Team Management</h1>
        <p class="text-muted">Manage team members, roles, and permissions</p>
      </div>

      <!-- Team Members -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Team Members</h2>
          <div class="card-header-actions">
            <button class="btn btn-sm btn-primary" onclick="showTeamInviteModal()">+ Invite Member</button>
          </div>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Role</th>
                <th>Status</th>
                <th>Last Active</th>
                <th>Engagements</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Dr. Sarah Williams</strong></td>
                <td><span class="badge badge-coordinator">Director</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Today</td>
                <td>12</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showTeamMemberModal('Dr. Sarah Williams', 'Director')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>Michael Johnson</strong></td>
                <td><span class="badge badge-advisor">Program Manager</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 20</td>
                <td>8</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showTeamMemberModal('Michael Johnson', 'Program Manager')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>Jennifer Martinez</strong></td>
                <td><span class="badge badge-observer">Coordinator</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 19</td>
                <td>5</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showTeamMemberModal('Jennifer Martinez', 'Coordinator')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>David Chen</strong></td>
                <td><span class="badge badge-observer">Analyst</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 18</td>
                <td>3</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showTeamMemberModal('David Chen', 'Analyst')">Edit</button>
                </td>
              </tr>
              <tr>
                <td><strong>Lisa Anderson</strong></td>
                <td><span class="badge badge-observer">Support</span></td>
                <td><span class="badge badge-active">Active</span></td>
                <td>Feb 17</td>
                <td>2</td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showTeamMemberModal('Lisa Anderson', 'Support')">Edit</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Access Matrix -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Access Matrix</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Permission</th>
                <th>Director</th>
                <th>Program Manager</th>
                <th>Coordinator</th>
                <th>Analyst</th>
                <th>Support</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>View Dashboard</strong></td>
                <td>✓</td>
                <td>✓</td>
                <td>✓</td>
                <td>✓</td>
                <td>✓</td>
              </tr>
              <tr>
                <td><strong>Manage Team</strong></td>
                <td>✓</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td><strong>Create Engagements</strong></td>
                <td>✓</td>
                <td>✓</td>
                <td>✓</td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td><strong>Approve Payments</strong></td>
                <td>✓</td>
                <td>✓</td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td><strong>View Reports</strong></td>
                <td>✓</td>
                <td>✓</td>
                <td>✓</td>
                <td>✓</td>
                <td>✓</td>
              </tr>
              <tr>
                <td><strong>Edit Settings</strong></td>
                <td>✓</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td><strong>Add Agents</strong></td>
                <td>✓</td>
                <td>✓</td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Pending Invitations -->
      <div class="card">
        <div class="card-header">
          <h2>Pending Invitations</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; gap: 1rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #e5e7eb; padding-bottom: 1rem;">
              <div>
                <div style="font-weight: 500;">robert.taylor@healthcareaccessdfw.org</div>
                <div class="text-sm text-muted">Role: Program Manager • Invited 2 days ago</div>
              </div>
              <button class="btn btn-sm btn-secondary" onclick="showToast('Invite resent', 'success')">Resend</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * Modal for team member edit
 */
function showTeamMemberModal(name, role) {
  const content = `
    <div style="line-height: 1.6;">
      <div class="form-group">
        <label>Name</label>
        <input type="text" value="${name}" disabled style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background: #f9fafb;">
      </div>
      <div class="form-group">
        <label>Role</label>
        <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          <option>${role}</option>
          <option>Director</option>
          <option>Program Manager</option>
          <option>Coordinator</option>
          <option>Analyst</option>
          <option>Support</option>
        </select>
      </div>
      <div style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-top: 1.5rem;">
        <div style="font-weight: 500; color: #ef4444; margin-bottom: 1rem;">Danger Zone</div>
        <button class="btn btn-sm btn-danger" onclick="showToast('Team member removed', 'warning')">Remove from Team</button>
      </div>
    </div>
  `;
  const footer = `
    <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
    <button class="btn btn-primary" onclick="closeModal(); showToast('Team member updated', 'success')">Save Changes</button>
  `;
  showModal(`Edit Team Member - ${name}`, content, footer);
}

/**
 * Modal for team invite
 */
function showTeamInviteModal() {
  const content = `
    <div style="line-height: 1.6;">
      <div class="form-group">
        <label>Email Address</label>
        <input type="email" placeholder="name@example.com" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
      </div>
      <div class="form-group">
        <label>Role</label>
        <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          <option>Coordinator</option>
          <option>Program Manager</option>
          <option>Analyst</option>
          <option>Support</option>
        </select>
      </div>
    </div>
  `;
  const footer = `
    <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
    <button class="btn btn-primary" onclick="closeModal(); showToast('Invitation sent', 'success')">Send Invite</button>
  `;
  showModal('Invite Team Member', content, footer);
}

/**
 * 21. BUDGET ALLOCATIONS
 * Org admin budget tracking and allocations
 */
function renderBudgetAllocations(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Budget Allocations</h1>
        <p class="text-muted">Track budget usage and allocations by category</p>
      </div>

      <!-- Budget Stats -->
      <div class="stat-grid">
        <div class="stat-card">
          <div class="stat-label">Total Budget</div>
          <div class="stat-value">$25K</div>
          <div class="stat-subtext">Annual allocation</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Allocated</div>
          <div class="stat-value">$18K</div>
          <div class="stat-subtext">72% of budget</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Spent</div>
          <div class="stat-value">$12K</div>
          <div class="stat-subtext">48% spent</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Remaining</div>
          <div class="stat-value">$7K</div>
          <div class="stat-subtext">28% available</div>
        </div>
      </div>

      <!-- Budget Utilization -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Budget Utilization</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="margin-bottom: 1rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <span class="text-sm">Total Budget Used</span>
              <strong>72%</strong>
            </div>
            <div class="progress-bar" style="height: 24px;">
              <div class="progress-fill" style="width: 72%; background: linear-gradient(90deg, #22c55e 0%, #3b82f6 100%);"></div>
            </div>
          </div>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1.5rem; font-size: 0.875rem;">
            <div>
              <div class="text-muted">Spent</div>
              <strong style="color: #22c55e;">$12K (48%)</strong>
            </div>
            <div>
              <div class="text-muted">Allocated</div>
              <strong style="color: #3b82f6;">$18K (72%)</strong>
            </div>
            <div>
              <div class="text-muted">Reserved</div>
              <strong style="color: #f59e0b;">$7K (28%)</strong>
            </div>
          </div>
        </div>
      </div>

      <!-- Allocations by Category -->
      <div class="card">
        <div class="card-header">
          <h2>Allocations by Category</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Category</th>
                <th>Allocated</th>
                <th>Spent</th>
                <th>Remaining</th>
                <th>% Used</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Personnel</strong></td>
                <td>$10,000</td>
                <td>$8,200</td>
                <td>$1,800</td>
                <td>
                  <div class="progress-bar" style="width: 100px; height: 8px;">
                    <div class="progress-fill" style="width: 82%;"></div>
                  </div>
                </td>
              </tr>
              <tr>
                <td><strong>Services</strong></td>
                <td>$6,000</td>
                <td>$2,100</td>
                <td>$3,900</td>
                <td>
                  <div class="progress-bar" style="width: 100px; height: 8px;">
                    <div class="progress-fill" style="width: 35%;"></div>
                  </div>
                </td>
              </tr>
              <tr>
                <td><strong>Technology</strong></td>
                <td>$4,500</td>
                <td>$1,200</td>
                <td>$3,300</td>
                <td>
                  <div class="progress-bar" style="width: 100px; height: 8px;">
                    <div class="progress-fill" style="width: 27%;"></div>
                  </div>
                </td>
              </tr>
              <tr>
                <td><strong>Training</strong></td>
                <td>$2,500</td>
                <td>$300</td>
                <td>$2,200</td>
                <td>
                  <div class="progress-bar" style="width: 100px; height: 8px;">
                    <div class="progress-fill" style="width: 12%;"></div>
                  </div>
                </td>
              </tr>
              <tr>
                <td><strong>Overhead</strong></td>
                <td>$2,000</td>
                <td>$200</td>
                <td>$1,800</td>
                <td>
                  <div class="progress-bar" style="width: 100px; height: 8px;">
                    <div class="progress-fill" style="width: 10%;"></div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Transaction History -->
      <div class="card" style="margin-top: 2rem;">
        <div class="card-header">
          <h2>Transaction History</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Description</th>
                <th>Amount</th>
                <th>Category</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Feb 18, 2026</td>
                <td>Contractor - Data Analysis Support</td>
                <td>$2,500</td>
                <td>Services</td>
                <td><span class="badge badge-success">Completed</span></td>
              </tr>
              <tr>
                <td>Feb 15, 2026</td>
                <td>Cloud Service Renewal (3 months)</td>
                <td>$1,200</td>
                <td>Technology</td>
                <td><span class="badge badge-success">Completed</span></td>
              </tr>
              <tr>
                <td>Feb 10, 2026</td>
                <td>Staff Salary (Feb)</td>
                <td>$5,000</td>
                <td>Personnel</td>
                <td><span class="badge badge-success">Completed</span></td>
              </tr>
              <tr>
                <td>Feb 5, 2026</td>
                <td>Professional Development Webinar</td>
                <td>$300</td>
                <td>Training</td>
                <td><span class="badge badge-success">Completed</span></td>
              </tr>
              <tr>
                <td>Feb 1, 2026</td>
                <td>Office Supplies & Materials</td>
                <td>$200</td>
                <td>Overhead</td>
                <td><span class="badge badge-success">Completed</span></td>
              </tr>
              <tr>
                <td>Jan 28, 2026</td>
                <td>Staff Salary (Jan)</td>
                <td>$3,200</td>
                <td>Personnel</td>
                <td><span class="badge badge-success">Completed</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Budget Alerts -->
      <div class="card" style="margin-top: 2rem;">
        <div class="card-header">
          <h2>Budget Alerts</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="background: #f0fdf4; padding: 1rem; border-radius: 0.5rem; border-left: 4px solid #22c55e;">
            <div style="font-weight: 500; color: #047857;">Personnel Budget - On Track</div>
            <div class="text-sm" style="color: #047857;">82% used, 3 months remaining</div>
          </div>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * 22. AGENT CONFIGURATION
 * Org admin agent setup and management
 */
function renderAgentConfiguration(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Agent Configuration</h1>
        <p class="text-muted">Deploy, configure, and manage autonomous agents</p>
      </div>

      <!-- Organization Agents -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Organization Agents</h2>
          <div class="card-header-actions">
            <button class="btn btn-sm btn-primary" onclick="showAgentSetupModal()">+ Register New Agent</button>
          </div>
        </div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; padding: 1.5rem;">
          <!-- Agent 1 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="margin-bottom: 1rem;">
              <div style="font-weight: 500; margin-bottom: 0.25rem;">Healthcare Monitor</div>
              <div class="text-sm text-muted">Data Collection & Analysis</div>
            </div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                <div>
                  <div class="text-muted">Tier</div>
                  <span class="badge badge-advisor">Advisor</span>
                </div>
                <div>
                  <div class="text-muted">Status</div>
                  <span class="badge badge-active">Active</span>
                </div>
              </div>
            </div>
            <div style="margin-bottom: 1rem; font-size: 0.875rem;">
              <div style="display: flex; justify-content: space-between;">
                <span class="text-muted">Spending Used</span>
                <strong>$2,340 / $5,000</strong>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 47%;"></div>
              </div>
            </div>
            <button class="btn btn-sm btn-secondary" onclick="showAgentConfigModal('Healthcare Monitor', 'Advisor')">Configure</button>
          </div>

          <!-- Agent 2 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="margin-bottom: 1rem;">
              <div style="font-weight: 500; margin-bottom: 0.25rem;">Coordinator Bot</div>
              <div class="text-sm text-muted">Matching & Facilitation</div>
            </div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                <div>
                  <div class="text-muted">Tier</div>
                  <span class="badge badge-coordinator">Coordinator</span>
                </div>
                <div>
                  <div class="text-muted">Status</div>
                  <span class="badge badge-active">Active</span>
                </div>
              </div>
            </div>
            <div style="margin-bottom: 1rem; font-size: 0.875rem;">
              <div style="display: flex; justify-content: space-between;">
                <span class="text-muted">Spending Used</span>
                <strong>$1,850 / $10,000</strong>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 19%;"></div>
              </div>
            </div>
            <button class="btn btn-sm btn-secondary" onclick="showAgentConfigModal('Coordinator Bot', 'Coordinator')">Configure</button>
          </div>

          <!-- Agent 3 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="margin-bottom: 1rem;">
              <div style="font-weight: 500; margin-bottom: 0.25rem;">Impact Verifier</div>
              <div class="text-sm text-muted">Attestation & Verification</div>
            </div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                <div>
                  <div class="text-muted">Tier</div>
                  <span class="badge badge-coordinator">Coordinator</span>
                </div>
                <div>
                  <div class="text-muted">Status</div>
                  <span class="badge badge-pending">Pending</span>
                </div>
              </div>
            </div>
            <div style="margin-bottom: 1rem; font-size: 0.875rem;">
              <div style="display: flex; justify-content: space-between;">
                <span class="text-muted">Spending Used</span>
                <strong>$0 / $8,000</strong>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 0%;"></div>
              </div>
            </div>
            <button class="btn btn-sm btn-secondary" onclick="showToast('Awaiting administrator approval', 'warning')">Awaiting Approval</button>
          </div>
        </div>
      </div>

      <!-- Agent Activity Log -->
      <div class="card">
        <div class="card-header">
          <h2>Agent Activity Log</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Timestamp</th>
                <th>Agent</th>
                <th>Action</th>
                <th>Cost</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Feb 20, 14:15</td>
                <td><strong>Healthcare Monitor</strong></td>
                <td>Data collection from 5 health centers</td>
                <td>$85</td>
                <td><span class="badge badge-success">Completed</span></td>
              </tr>
              <tr>
                <td>Feb 20, 12:42</td>
                <td><strong>Coordinator Bot</strong></td>
                <td>Created 3 match proposals</td>
                <td>$42</td>
                <td><span class="badge badge-success">Completed</span></td>
              </tr>
              <tr>
                <td>Feb 20, 10:33</td>
                <td><strong>Healthcare Monitor</strong></td>
                <td>Generated impact report</td>
                <td>$65</td>
                <td><span class="badge badge-success">Completed</span></td>
              </tr>
              <tr>
                <td>Feb 19, 16:20</td>
                <td><strong>Coordinator Bot</strong></td>
                <td>Processed engagement agreement</td>
                <td>$28</td>
                <td><span class="badge badge-success">Completed</span></td>
              </tr>
              <tr>
                <td>Feb 19, 14:05</td>
                <td><strong>Healthcare Monitor</strong></td>
                <td>Data aggregation and analysis</td>
                <td>$110</td>
                <td><span class="badge badge-success">Completed</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Spending Policy -->
      <div class="card" style="margin-top: 2rem;">
        <div class="card-header">
          <h2>Spending Policy</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="display: grid; gap: 1.5rem;">
            <div>
              <label>Max Monthly Spend per Agent (USDC)</label>
              <input type="number" value="10000" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; margin-top: 0.75rem;">
            </div>
            <div>
              <label>Max Transaction Size (USDC)</label>
              <input type="number" value="5000" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; margin-top: 0.75rem;">
            </div>
            <div>
              <label>Require Human Approval for Transactions Over (USDC)</label>
              <input type="number" value="2500" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; margin-top: 0.75rem;">
            </div>
          </div>
          <button class="btn btn-primary" style="margin-top: 1.5rem;" onclick="showToast('Spending policy saved', 'success')">Save Policy</button>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * Modal for agent configuration
 */
function showAgentConfigModal(agentName, tier) {
  const content = `
    <div style="line-height: 1.6;">
      <div class="form-group">
        <label>Agent Name</label>
        <input type="text" value="${agentName}" disabled style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background: #f9fafb;">
      </div>
      <div class="form-group">
        <label>Tier</label>
        <input type="text" value="${tier}" disabled style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background: #f9fafb;">
      </div>
      <div class="form-group">
        <label>Monthly Spending Limit (USDC)</label>
        <input type="number" value="5000" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
      </div>
      <div class="form-group">
        <label>Allowed Actions (comma-separated)</label>
        <input type="text" value="data collection, matching, payment" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
      </div>
      <div class="form-group">
        <label>Session Key Duration (days)</label>
        <input type="number" value="30" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
      </div>
    </div>
  `;
  const footer = `
    <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
    <button class="btn btn-primary" onclick="closeModal(); showToast('Agent configuration saved', 'success')">Save Configuration</button>
  `;
  showModal(`Configure Agent - ${agentName}`, content, footer);
}

/**
 * Modal for agent setup
 */
function showAgentSetupModal() {
  const content = `
    <div style="line-height: 1.6;">
      <div class="form-group">
        <label>Agent Name</label>
        <input type="text" placeholder="e.g., Data Analyzer" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
      </div>
      <div class="form-group">
        <label>Agent Type</label>
        <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          <option>Data Collection</option>
          <option>Matching & Coordination</option>
          <option>Attestation & Verification</option>
          <option>Reporting & Analytics</option>
          <option>Payment Processing</option>
        </select>
      </div>
      <div class="form-group">
        <label>Requested Tier</label>
        <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          <option>Observer</option>
          <option selected>Advisor</option>
          <option>Coordinator</option>
        </select>
      </div>
      <div class="form-group">
        <label>Monthly Spending Limit (USDC)</label>
        <input type="number" value="5000" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
      </div>
    </div>
  `;
  const footer = `
    <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
    <button class="btn btn-primary" onclick="closeModal(); showToast('Agent registration submitted for review', 'success')">Submit for Review</button>
  `;
  showModal('Register New Agent', content, footer);
}

/**
 * 23. GRANT CONFIGURATION
 * Funder grant setup and terms
 */
function renderGrantConfiguration(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Grant Configuration</h1>
        <p class="text-muted">Set up grants, templates, and reporting requirements</p>
      </div>

      <!-- Active Grants -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Active Grants</h2>
          <div class="card-header-actions">
            <button class="btn btn-sm btn-primary" onclick="showGrantWizardModal()">+ Create New Grant</button>
          </div>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Grant Name</th>
                <th>Organization</th>
                <th>Amount</th>
                <th>Start</th>
                <th>End</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Community Health Platform</strong></td>
                <td>Healthcare Access Initiative</td>
                <td>$250,000</td>
                <td>Jan 2026</td>
                <td>Dec 2026</td>
                <td><span class="badge badge-active">Active</span></td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showToast('Grant details viewed', 'info')">Details</button>
                </td>
              </tr>
              <tr>
                <td><strong>Workforce Development</strong></td>
                <td>Youth Workforce Alliance</td>
                <td>$180,000</td>
                <td>Feb 2026</td>
                <td>Jan 2027</td>
                <td><span class="badge badge-active">Active</span></td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showToast('Grant details viewed', 'info')">Details</button>
                </td>
              </tr>
              <tr>
                <td><strong>Housing Stability Program</strong></td>
                <td>Housing First DFW</td>
                <td>$400,000</td>
                <td>Mar 2026</td>
                <td>Feb 2027</td>
                <td><span class="badge badge-active">Active</span></td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showToast('Grant details viewed', 'info')">Details</button>
                </td>
              </tr>
              <tr>
                <td><strong>Education Innovation</strong></td>
                <td>DFW Education Collective</td>
                <td>$220,000</td>
                <td>Apr 2026</td>
                <td>Mar 2027</td>
                <td><span class="badge badge-active">Active</span></td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showToast('Grant details viewed', 'info')">Details</button>
                </td>
              </tr>
              <tr>
                <td><strong>Tech Skills Training</strong></td>
                <td>Tech for Social Good</td>
                <td>$150,000</td>
                <td>May 2026</td>
                <td>Apr 2027</td>
                <td><span class="badge badge-active">Active</span></td>
                <td>
                  <button class="btn btn-sm btn-secondary" onclick="showToast('Grant details viewed', 'info')">Details</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Grant Templates -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Grant Templates</h2>
        </div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; padding: 1.5rem;">
          <!-- Template 1 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="font-weight: 500; margin-bottom: 0.5rem;">General Purpose Grant</div>
            <div class="text-sm text-muted" style="margin-bottom: 1rem;">Flexible funding for a wide range of initiatives</div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div class="text-muted">Duration</div>
              <strong>12 months</strong>
            </div>
            <button class="btn btn-sm btn-secondary" onclick="showToast('Template used', 'success')">Use Template</button>
          </div>

          <!-- Template 2 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="font-weight: 500; margin-bottom: 0.5rem;">Workforce Development</div>
            <div class="text-sm text-muted" style="margin-bottom: 1rem;">Training and employment focused grants</div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div class="text-muted">Duration</div>
              <strong>6-12 months</strong>
            </div>
            <button class="btn btn-sm btn-secondary" onclick="showToast('Template used', 'success')">Use Template</button>
          </div>

          <!-- Template 3 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="font-weight: 500; margin-bottom: 0.5rem;">Housing & Stability</div>
            <div class="text-sm text-muted" style="margin-bottom: 1rem;">Housing access and support programs</div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div class="text-muted">Duration</div>
              <strong>12-24 months</strong>
            </div>
            <button class="btn btn-sm btn-secondary" onclick="showToast('Template used', 'success')">Use Template</button>
          </div>
        </div>
      </div>

      <!-- Reporting Requirements -->
      <div class="card">
        <div class="card-header">
          <h2>Reporting Requirements</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div class="form-group">
            <label>Report Frequency</label>
            <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
              <option>Monthly</option>
              <option selected>Quarterly</option>
              <option>Semi-Annual</option>
              <option>Annual</option>
            </select>
          </div>
          <div class="form-group">
            <label>Required Metrics (one per line)</label>
            <textarea style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; min-height: 120px;">Beneficiaries served
Programs delivered
Budget utilization
Staff hours
Outcome measures
Participant satisfaction
Community impact</textarea>
          </div>
          <div class="form-group">
            <label>Report Format</label>
            <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
              <option>PDF</option>
              <option>CSV</option>
              <option selected>Dashboard</option>
              <option>Custom Template</option>
            </select>
          </div>
          <button class="btn btn-primary" onclick="showToast('Reporting requirements saved', 'success')">Save Requirements</button>
        </div>
      </div>
    </div>
  `;
  return html;
}

/**
 * Modal for grant wizard
 */
function showGrantWizardModal() {
  const content = `
    <div style="line-height: 1.6;">
      <div class="form-group">
        <label>Grant Name</label>
        <input type="text" placeholder="e.g., Community Initiative 2026" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
      </div>
      <div class="form-group">
        <label>Organization</label>
        <select style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
          <option>Select organization...</option>
          <option>Healthcare Access Initiative</option>
          <option>Youth Workforce Alliance</option>
          <option>Housing First DFW</option>
          <option>DFW Education Collective</option>
        </select>
      </div>
      <div class="form-group">
        <label>Total Amount (USD)</label>
        <input type="number" placeholder="100000" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
      </div>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div class="form-group">
          <label>Start Date</label>
          <input type="date" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
        </div>
        <div class="form-group">
          <label>End Date</label>
          <input type="date" style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
        </div>
      </div>
    </div>
  `;
  const footer = `
    <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
    <button class="btn btn-primary" onclick="closeModal(); showToast('Grant created successfully', 'success')">Create Grant</button>
  `;
  showModal('Create New Grant', content, footer);
}

/**
 * 24. REPORTING SETTINGS
 * Funder reporting and template configuration
 */
function renderReportingSettings(role) {
  const html = `
    <div class="view-container">
      <div class="view-header">
        <h1>Reporting Settings</h1>
        <p class="text-muted">Configure report templates and distribution</p>
      </div>

      <!-- Report Templates -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Report Templates</h2>
        </div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; padding: 1.5rem;">
          <!-- Template 1 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="font-weight: 500; margin-bottom: 0.5rem;">Impact Summary</div>
            <div class="text-sm text-muted" style="margin-bottom: 1rem;">Key outcomes and metrics overview</div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <span class="text-muted">Frequency:</span> <strong>Quarterly</strong>
              </div>
              <div style="margin-top: 0.25rem;">
                <span class="text-muted">Last Generated:</span> <strong>Feb 15, 2026</strong>
              </div>
            </div>
            <button class="btn btn-sm btn-secondary" onclick="showToast('Report generated', 'success')">Generate Now</button>
          </div>

          <!-- Template 2 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="font-weight: 500; margin-bottom: 0.5rem;">Financial Report</div>
            <div class="text-sm text-muted" style="margin-bottom: 1rem;">Budget tracking and spending analysis</div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <span class="text-muted">Frequency:</span> <strong>Monthly</strong>
              </div>
              <div style="margin-top: 0.25rem;">
                <span class="text-muted">Last Generated:</span> <strong>Feb 20, 2026</strong>
              </div>
            </div>
            <button class="btn btn-sm btn-secondary" onclick="showToast('Report generated', 'success')">Generate Now</button>
          </div>

          <!-- Template 3 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="font-weight: 500; margin-bottom: 0.5rem;">Compliance Report</div>
            <div class="text-sm text-muted" style="margin-bottom: 1rem;">Grant conditions and requirements status</div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <span class="text-muted">Frequency:</span> <strong>Monthly</strong>
              </div>
              <div style="margin-top: 0.25rem;">
                <span class="text-muted">Last Generated:</span> <strong>Feb 19, 2026</strong>
              </div>
            </div>
            <button class="btn btn-sm btn-secondary" onclick="showToast('Report generated', 'success')">Generate Now</button>
          </div>

          <!-- Template 4 -->
          <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem;">
            <div style="font-weight: 500; margin-bottom: 0.5rem;">Outcome Analysis</div>
            <div class="text-sm text-muted" style="margin-bottom: 1rem;">Deep dive into impact and KPI trends</div>
            <div style="background: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 1rem; font-size: 0.875rem;">
              <div>
                <span class="text-muted">Frequency:</span> <strong>Quarterly</strong>
              </div>
              <div style="margin-top: 0.25rem;">
                <span class="text-muted">Last Generated:</span> <strong>Feb 10, 2026</strong>
              </div>
            </div>
            <button class="btn btn-sm btn-secondary" onclick="showToast('Report generated', 'success')">Generate Now</button>
          </div>
        </div>
      </div>

      <!-- Scheduled Reports -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Scheduled Reports</h2>
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Template</th>
                <th>Frequency</th>
                <th>Recipients</th>
                <th>Next Run</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Impact Summary</strong></td>
                <td>Quarterly</td>
                <td>Board Members (3)</td>
                <td>May 15, 2026</td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Financial Report</strong></td>
                <td>Monthly</td>
                <td>Finance Team (2)</td>
                <td>Mar 1, 2026</td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Compliance Report</strong></td>
                <td>Monthly</td>
                <td>Compliance Officer (1)</td>
                <td>Mar 1, 2026</td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
              <tr>
                <td><strong>Outcome Analysis</strong></td>
                <td>Quarterly</td>
                <td>All Leadership (5)</td>
                <td>May 15, 2026</td>
                <td><span class="badge badge-active">Active</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Custom Metrics -->
      <div class="card" style="margin-bottom: 2rem;">
        <div class="card-header">
          <h2>Custom Metrics</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
            <div style="font-weight: 500; margin-bottom: 0.75rem;">Define Custom KPIs</div>
            <p style="margin: 0; font-size: 0.875rem; color: #6b7280;">Create organization-specific metrics to track in automated reports</p>
          </div>
          <button class="btn btn-primary" onclick="showToast('Custom metric editor opened', 'info')">+ Add Custom Metric</button>
        </div>
      </div>

      <!-- Distribution Settings -->
      <div class="card">
        <div class="card-header">
          <h2>Distribution Settings</h2>
        </div>
        <div style="padding: 1.5rem;">
          <div class="form-group">
            <label>Email Recipients (one per line)</label>
            <textarea style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; min-height: 100px;">executive@funders.org
finance@funders.org
board@funders.org</textarea>
          </div>

          <div class="form-group" style="margin-top: 1.5rem;">
            <label>Report Format</label>
            <div style="display: grid; gap: 0.75rem; margin-top: 0.75rem;">
              <div style="display: flex; align-items: center;">
                <input type="checkbox" id="pdf" checked>
                <label for="pdf" style="margin-left: 0.75rem; margin-bottom: 0;">PDF</label>
              </div>
              <div style="display: flex; align-items: center;">
                <input type="checkbox" id="csv" checked>
                <label for="csv" style="margin-left: 0.75rem; margin-bottom: 0;">CSV</label>
              </div>
              <div style="display: flex; align-items: center;">
                <input type="checkbox" id="dashboard" checked>
                <label for="dashboard" style="margin-left: 0.75rem; margin-bottom: 0;">Dashboard Link</label>
              </div>
            </div>
          </div>

          <button class="btn btn-primary" style="margin-top: 1.5rem;" onclick="showToast('Distribution settings saved', 'success')">Save Distribution Settings</button>
        </div>
      </div>
    </div>
  `;
  return html;
}



// Initialize the application
document.addEventListener('DOMContentLoaded', initializeApp);
</script>
</body>
</html>
